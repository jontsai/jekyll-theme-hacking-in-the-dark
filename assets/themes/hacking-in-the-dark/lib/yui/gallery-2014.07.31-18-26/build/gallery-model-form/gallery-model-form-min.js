YUI.add("gallery-model-form",function(e,t){e.ModelForm=e.Base.create("model-form",e.Widget,[],{fieldMap:{INPUT:{text:"_handleTextInput",checkbox:"_handleCheckboxInput",radio:"_handleRadioInput"},SELECT:{"select-one":"_handleSelectInput"},TEXTAREA:{textarea:"_handleTextInput"},BUTTON:{button:"_handleButtonInput"}},initializer:function(t){this._fields=[],this._eventHandles=[],this._formValues={},t.values&&(this._formValues=t.values),this.set("model",new e.Model),this._eventHandles.push(this.get("model").on("change",this._handleModelChange,this))},destructor:function(){(new e.EventHandle(this._eventHandles)).detach(),this.form&&this.form.destroy()},renderUI:function(){this.get("markup")&&this.get("contentBox").setHTML(e.Node.create(this.get("markup"))),this.form=this.get("boundingBox").one("form"),this._parseFields()},getField:function(e){return this._fields[e]},getForm:function(){return this.form},reset:function(t){this.get("model").reset(),t||e.Object.isEmpty(this._formValues)||this.get("model").setAttrs(this._formValues)},_handleModelChange:function(t){if(t.src==="form")return;e.Object.each(t.changed,function(t,n){var r=this.getField(n);e.Lang.isUndefined(r)||(r.get("type")==="checkbox"?r.set("checked",t.newVal):r.get("type")==="radio"?e.all("input[name="+n+"]").each(function(e){e.get("value")===t.newVal&&e.set("checked",!0)},this):r.set("value",t.newVal))},this)},_parseFields:function(){var t=this.get("boundingBox").one("form").all("*"),n=this.get("model");t.each(function(t){var n=t.get("nodeName"),r=t.get("type"),i=t.get("name"),s;e.Object.hasKey(this.fieldMap,n)&&e.Object.hasKey(this.fieldMap[n],r)&&(s=this.fieldMap[n][r],this[s](t,i),this._fields[i]=t)},this),e.Object.each(this._fields,function(e,t){n.get(t)||n.set(t,"",{silent:!0})}),e.Object.isEmpty(this._formValues)||n.setAttrs(this._formValues)},_handleTextInput:function(e,t){var n=this.get("model");this._eventHandles.push(e.after("keyup",function(e){n.set(t,e.target.get("value"),{src:"form"})})),e.get("value")!==""&&(this._formValues[t]=e.get("value"))},_handleCheckboxInput:function(e,t){var n=this.get("model");this._eventHandles.push(e.after("click",function(e){n.set(t,e.target.get("checked"),{src:"form"})},this)),e.get("checked")&&(this._formValues[t]=e.get("checked"))},_handleRadioInput:function(e,t){var n=this.get("model");this._eventHandles.push(e.on("change",function(e){n.set(t,e.target.get("value"),{src:"form"})},this)),e.get("checked")&&(this._formValues[t]=e.get("value"))},_handleSelectInput:function(e,t){var n=this.get("model");this._eventHandles.push(e.after("change",function(e){n.set(t,e.target.get("value"),{src:"form"})},this)),e.get("options").each(function(e){e.get("selected")&&!this._formValues[t]&&(this._formValues[t]=e.get("value"))},this)},_handleButtonInput:function(e,t){var n=this.get("model");this._eventHandles.push(e.on("click",function(e){n.set(t,e.target.get("value"),{src:"form"})})),e.get("value")!==""&&(this._formValues[t]=e.get("value"))}},{ATTRS:{markup:{value:""},model:{value:null}}})},"gallery-2013.11.14-01-08",{requires:["yui-base","node","event","model","widget"]});
