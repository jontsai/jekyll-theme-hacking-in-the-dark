YUI.add("gallery-bt-loader",function(e,t){var n="blo_",r={ERROR:n+"error",LOADING:n+"loading",LOADED:n+"loaded"},i={append:function(e,t,n){t.addClass(r.LOADED),e.append(n)},insert:function(e,t,n){t.addClass(r.LOADED),e.insert(n,0)},refresh:function(e,t,n){t.addClass(r.LOADED),e.insert(n,"replace")},replace:function(e,t,n){t.addClass(r.LOADED).replace(n)}},s={json:function(t){try{return e.JSON.parse(t)}catch(n){return null}},none:function(e){return e}},o={json:function(e,t){var n=t.split(/\./),r;for(r=0;r<n.length;r++){e=e[n[r]];if(e===undefined)return}return e},none:function(t,n){return n==="*"?t:e.Selector.query(n,e.DOM.create(t),!0)}},u=function(e){return i[e]?!0:!1},a=e.Base.create("btloader",e.Widget,[e.Bottle.SyncScroll],{initializer:function(){var t=this.get("contentBox");this._bloEventHandlers=new e.EventHandle([t.delegate("click",this._handleClick,this.get("actionNode"),this)])},destructor:function(){this._bloEventHandlers.detach(),delete this._bloEventHandlers},bindUI:function(){},_handleClick:function(t){var n=t.currentTarget;n.removeClass(r.ERROR).addClass(r.LOADING),t.preventDefault(),e.io(n.getAttribute(this.get("actionAttr")),{on:{success:this._handleIOSuccess,failure:this._handleIOFailure},context:this,arguments:{target:n}})},_handleIOSuccess:function(t,n,s){var o=this.get("parser"),a=o(n.responseText),f=s.target,l=f.getData("action"),c=u(l)?l:this.get("action");f.removeClass(r.LOADING);if(!a)return this._handleIOFailure(t,n,s);e.Bottle.Loader.SUCCESSCB&&e.Bottle.Loader.SUCCESSCB(this,a,f),this._selector&&(a=this._selector(a,this.get("selector"))),i[c](this.get("contentBox"),f,a),this.syncScroll()},_handleIOFailure:function(t,n,i){var s=i.target;s.removeClass(r.LOADING).addClass(r.ERROR),e.Bottle.Loader.FAILURECB&&e.Bottle.Loader.FAILURECB(this,n,i)}},{ATTRS:{actionNode:{writeOnce:!0,validator:e.Lang.isString},actionAttr:{validator:e.Lang.isString},action:{validator:u},parser:{validator:function(t){return e.Lang.isFunction(t)||(s[t]?!0:!1)},setter:function(e){return s[e]&&(this._selector=o[e]),s[e]||e}},selector:{validator:e.Lang.isString}},HTML_PARSER:{actionNode:function(e){return e.getData("action-node")||"a"},actionAttr:function(e){return e.getData("action-attr")||"href"},action:function(e){return e.getData("action")||"append"},parser:function(e){return e.getData("parser")||"none"},selector:function(e){return e.getData("selector")||"*"}}});e.namespace("Bottle").Loader=a},"gallery-2013.04.10-22-48",{requires:["gallery-bt-syncscroll","io-base","json-parse"]});
