YUI.add("gallery-magnifier",function(e,t){var n=function(){this._image={},n.superclass.constructor.apply(this,arguments)},r="Magnifier",i="magnifier",s=e.ClassNameManager.getClassName(i,"display"),o=e.ClassNameManager.getClassName(i,"hidden"),u="<div><img /></div>";n.NAME=r,n.NS=r,n.ATTRS={host:{validator:function(t){return t.test("img")?!0:(e.error(r+" can't be attached to this node."),!1)}},follow:{value:!1,validator:e.Lang.isBoolean},display:{writeOnce:!0,setter:function(t){return t=e.one(t),t}},height:{value:100,validator:e.Lang.isNumber},width:{value:100,validator:e.Lang.isNumber},zoom:{value:2,validator:e.Lang.isNumber},staticX:{validator:e.Lang.isNumber},staticY:{validator:e.Lang.isNumber}},e.extend(n,e.Plugin.Base,{initializer:function(){var e=this.get("host"),t=this._image;t.width=parseInt(e.getStyle("width"),10),t.height=parseInt(e.getStyle("height"),10),t.left=e.getX(),t.top=e.getY(),t.right=t.left+t.width,t.bottom=t.top+t.height,this._renderDisplay(),this._bindEvents()},destructor:function(){this._unbindEvents(),this._destroyDisplay()},_bindEvents:function(){var t=this.get("host"),n=this.get("display"),r=this.get("follow");r?this._ME=t.on("mouseover",function(){n.removeClass(o),this._MM=e.one("body").on("mousemove",this._moveViewport,this)},this):(this._MM=t.on("mousemove",this._moveViewport,this),this._MO=t.on("mouseout",function(){n.addClass(o)},this),this._ME=t.on("mouseover",function(){n.removeClass(o)},this))},_unbindEvents:function(){this._MM&&this._MM.unbind(),this._MO&&this._MO.unbind(),this._ME&&this._ME.unbind()},_destroyDisplay:function(){this.get("display").remove()},_renderDisplay:function(){var t=this.get("display"),n=this.get("height"),r=this.get("width");e.Lang.isValue(t)||(t=e.Node.create("<div></div>"),this.set("display",t),this.get("host").get("parentNode").append(t)),t.setContent(u),t.setStyle("height",n),t.setStyle("width",r),t.setStyle("position","absolute"),this.get("follow")?t.setXY([0,0]):(t.setXY([this.get("staticX"),this.get("staticY")]),t.one("div").setStyle("position","relative")),t.addClass(s),this._configureImage(),t.addClass(o)},_configureImage:function(){var e=this.get("zoom"),t=this.get("display"),n=this.get("host"),r=t.one("img");r.set("src",n.get("src")),r.setStyles({height:this._image.height*e,width:this._image.width*e})},_moveViewport:function(e){var t=this._image,n=this.get("zoom"),r=this.get("display"),i=r.one("div"),s=e.pageX-t.left,u=e.pageY-t.top,a=this.get("height")/2,f=this.get("width")/2,l=-s*n+a,c=-u*n+f;e.pageX>=t.left&&e.pageX<=t.right&&e.pageY>=t.top&&e.pageY<=t.bottom?(this.get("follow")&&r.setXY([e.pageX-f,e.pageY-a]),i.setStyles({left:l,top:c})):(r.addClass(o),this._MM.detach())}}),e.Magnifier=n},"gallery-2012.12.05-21-01",{requires:["plugin","node-pluginhost","node-style","node-screen","classnamemanager"]});
