YUI.add("gallery-rangyinputs",function(e,t){function r(e,t,n){return t<0&&(t+=e.value.length),typeof n=="undefined"&&(n=t),n<0&&(n+=e.value.length),{start:t,end:n}}function i(e,t,n){return{start:t,end:n,length:n-t,text:e.value.slice(t,n)}}function s(){}var n;n=function(e){this._node=e.host._node},n.NS="rangy",n.prototype={getSelection:function(){var e=this._node,t=e.selectionStart,n=e.selectionEnd;return i(e,t,n)},setSelection:function(e,t){var n=this._node,i=r(n,e,t);return n.selectionStart=i.start,n.selectionEnd=i.end,this},collapseSelection:function(e){var t=this._node;return e?t.selectionEnd=t.selectionStart:t.selectionStart=t.selectionEnd,this},deleteText:function(e,t,n){var r,i=this._node;return e!==t&&(r=i.value,i.value=r.slice(0,e)+r.slice(t)),n&&this.setSelection(e,e),this},deleteSelectedText:function(){var e=this.getSelection();return this.deleteText(e.start,e.end,!0),this},extractSelectedText:function(){var e=this._node,t=this.getSelection(),n;return t.start!==t.end&&(n=e.value,e.value=n.slice(0,t.start)+n.slice(t.end)),this.setSelection(t.start,t.start),t.text},_updateSelectionAfterInsert:function(e,t,n){var r=e+t.length;n=typeof n=="string"?n.toLowerCase():"";switch(n){case"collapsetostart":this.setSelection(e,e);break;case"collapsetoend":this.setSelection(r,r);break;case"select":this.setSelection(e,r)}},insertText:function(e,t,n){var r=this._node,i=r.value;return r.value=i.slice(0,t)+e+i.slice(t),typeof n=="boolean"&&(n=n?"collapseToEnd":""),this._updateSelectionAfterInsert(t,e,n),this},replaceSelectedText:function(e,t){var n=this._node,r=this.getSelection(),i=n.value;return n.value=i.slice(0,r.start)+e+i.slice(r.end),this._updateSelectionAfterInsert(r.start,e,t||"collapseToEnd"),this},surroundSelectedText:function(e,t,n){typeof t=="undefined"&&(t=e);var r=this._node,i=this.getSelection(),s=r.value,o;return r.value=s.slice(0,i.start)+e+i.text+t+s.slice(i.end),o=i.start+e.length,this._updateSelectionAfterInsert(o,i.text,n||"select"),this}},s.prototype={getSelection:function(){var t=this._node,n=0,r=0,s,o,u,a,f=e.config.doc.selection.createRange();return f&&f.parentElement()===t&&(u=t.value.length,s=t.value.replace(/\r\n/g,"\n"),o=t.createTextRange(),o.moveToBookmark(f.getBookmark()),a=t.createTextRange(),a.collapse(!1),o.compareEndPoints("StartToEnd",a)>-1?n=r=u:(n=-o.moveStart("character",-u),n+=s.slice(0,n).split("\n").length-1,o.compareEndPoints("EndToEnd",a)>-1?r=u:(r=-o.moveEnd("character",-u),r+=s.slice(0,r).split("\n").length-1))),i(t,n,r)},_offsetToRangeCharacterMove:function(e){var t=this._node;return e-(t.value.slice(0,e).split("\r\n").length-1)},setSelection:function(e,t){var n=this._node,i=r(n,e,t),s=n.createTextRange(),o=this._offsetToRangeCharacterMove(i.start);return s.collapse(!0),i.start===i.end?s.move("character",o):(s.moveEnd("character",this._offsetToRangeCharacterMove(i.end)),s.moveStart("character",o)),s.select(),this},collapseSelection:function(t){var n=e.config.doc.selection.createRange();return n.collapse(t),n.select(),this}},e.config.doc.selection&&!e.config.win.getSelection&&(n=e.augment(n,s,!0)),e.namespace("Plugin").RangyInputs=n},"gallery-2013.09.04-21-56",{use:["node-base","node-pluginhost"],requires:["yui-base"]});
