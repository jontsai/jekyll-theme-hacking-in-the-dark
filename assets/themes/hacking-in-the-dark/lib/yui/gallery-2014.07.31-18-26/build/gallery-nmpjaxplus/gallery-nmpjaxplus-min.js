YUI.add("gallery-nmpjaxplus",function(e,t){e.PjaxPlus=e.Base.create("pjaxplus",e.Widget,[],{initializer:function(t){this.set("history",new e.History),this.set("historyhash",new e.HistoryHash),this.set("html5support",e.HistoryBase.html5),this.ppCache=new e.Cache({max:this.get("cacheNum")}),this.domain=new RegExp("^(http|https)://"+window.location.hostname.replace(".",".")),this.get("omitLinkClass").match(/^\./)&&this.set("omitLinkClass",this.get("omitLinkClass").replace(/^\./,""))},initAjaxLinks:function(){var t,n;if(this.get("html5support")){this.addPjaxClass(!1);var r=new e.Pjax({addPjaxParam:this.get("addPjaxParam"),container:this.get("container"),contentSelector:this.get("contentSelector"),linkSelector:this.get("linkSelector"),navigateOnHash:this.get("navigateOnHash"),scrollToTop:this.get("scrollToTop"),timeout:this.get("timeout"),titleSelector:this.get("titleSelector")});r.on("navigate",function(e){t=e.originEvent.target.get("href");var n=this.get("html5support");this.get("startCallbackFunc")&&this.get("startCallbackFunc").call(null,{clickTarget:e.originEvent.target,path:e.originEvent.target.get("pathname"),url:e.originEvent.target.get("href"),queryString:e.originEvent.target.get("search"),html5support:n},this)},this),r.after("load",function(r){var i=this.get("html5support");this.get("callbackFunc")&&this.get("callbackFunc").call(null,{clickTarget:n,path:n.get("pathname"),url:n.get("href"),queryString:n.get("search"),html5support:i},this),this.addPjaxClass(!0),this.ppCache.add(t,e.one(this.get("contentSelector")).getHTML())},this),e.delegate("click",function(t){n=t.target,this.ppCache.retrieve(t.target.get("href"))&&e.one(this.get("contentSelector")).setHTML(this.ppCache.retrieve(t.target.get("href")).response)},document.body,"a.yui3-pjax",this)}else e.delegate("click",function(t){var n=this.get("html5support");if(typeof t.target.get("pathname")!="undefined"){var r=t.target.get("pathname").replace(/_/g,"-");r=t.target.get("pathname").replace(/\//g,"_");if(this.ppCache.retrieve(t.target.get("href"))){e.one(this.get("contentSelector")).setHTML(this.ppCache.retrieve(t.target.get("href")).response),this.get("history").add({page:r}),this.get("callbackFunc")&&this.get("callbackFunc").call(null,{clickTarget:t.target,path:t.target.get("pathname"),url:t.target.get("href"),queryString:t.target.get("search"),historyhash:r,html5support:n},this);return}}var i=!1;if(typeof t.target.get("pathname")=="undefined")t.preventDefault(),this.startAjaxLoad({clickTarget:t.target,url:"/"});else{var s=t.target.get("pathname").split(/\//),o=s.length-1,u=s[o];u.match(/\./)?i=e.Array.some(this.get("permittedFileExts"),function(e){var t=new RegExp("."+e+"$");if(u.match(t))return!0}):i=!0,i&&!t.target.get("href").match(/^(mailto|javascript):/)&&!t.target.get("href").match(/^#/)&&t.target.get("href").match(this.domain)&&!t.target.hasClass(this.get("omitLinkClass"))&&(t.preventDefault(),this.startAjaxLoad({clickTarget:t.target,path:t.target.get("pathname"),url:t.target.get("href"),queryString:t.target.get("search"),historyhash:r,html5support:n}))}},this.get("findLinksIn"),"a:not(."+this.get("omitLinkClass")+")",this)},addPjaxClass:function(t){var n=!1,r=t?this.get("container")+" a:not(."+this.get("omitLinkClass")+")":"a:not(."+this.get("omitLinkClass")+")";e.all(r).each(function(t){var r=t.get("pathname").split(/\//),i=r.length-1,s=r[i];s.match(/\./)?n=e.Array.some(this.get("permittedFileExts"),function(e){var t=new RegExp("."+e+"$");if(s.match(t))return!0}):n=!0,n&&!t.get("href").match(/^(mailto|javascript):/)&&!t.get("href").match(/^#/)&&t.get("href").match(this.domain)&&!t.hasClass(this.get("omitLinkClass"))&&t.addClass("yui3-pjax")},this)},startAjaxLoad:function(t){this.get("startCallbackFunc")&&this.get("startCallbackFunc").call(null,t,this),t.path.match(/^\//)||(t.path="/"+t.path);var n=t.queryString?t.path+t.queryString:t.path;this.get("nofrags")&&(n+=t.queryString?"&nofrag=1":"?nofrag=1");var r={timeout:this.get("timeout"),on:{complete:e.bind(function(n,r){if(this.get("nofrags")){var i=r.responseText;e.one(this.get("contentSelector")).set("innerHTML",i)}else{var s=e.Node.create(r.responseText);e.one(this.get("contentSelector")).setHTML(s.one(this.get("contentSelector")).getHTML());var i=s.one(this.get("contentSelector")).getHTML()}this.get("history").add({page:t.historyhash}),this.ppCache.add(t.url,i)},this),success:e.bind(function(e,n){t.transport=n,this.get("callbackFunc")&&this.get("callbackFunc").call(null,t,this)},this)}};e.io(n,r)}},{ATTRS:{findLinksIn:{value:document.body},container:{},timeout:{value:3e4},addPjaxParam:{value:!0},linkSelector:{value:"a.yui3-pjax"},scrollToTop:{value:!0},navigateOnHash:{value:!1},titleSelector:{value:"title"},contentSelector:{},omitLinkClass:{},permittedFileExts:{},startCallbackFunc:{},callbackFunc:{},cacheNum:{value:10},nofrags:{value:!1}}})},"gallery-2013.05.10-00-54",{supersedes:[""],skinnable:"false",requires:["base-build","widget","node","io","history","pjax","event-delegate","cache-base","selector-css3"],optional:[""]});
