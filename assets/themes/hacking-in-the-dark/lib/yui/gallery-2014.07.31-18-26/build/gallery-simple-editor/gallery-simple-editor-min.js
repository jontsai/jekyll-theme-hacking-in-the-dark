YUI.add("gallery-simple-editor",function(C){var D=function(){D.superclass.constructor.apply(this,arguments);};D.NAME="ToolbarButton";D.ATTRS={node:{setter:function(J){var K=C.get(J);if(!K){C.error("Invalid Node Given: "+J);}else{K=K.item(0);}return K;}},id:{},value:{},menu:{value:false},type:{value:"push",writeOnce:true},disabled:{value:false,setter:function(J){if(J){this.get("node").addClass("yui-button-disabled");this.get("node").addClass("yui-"+this.get("type")+"-button-disabled");}else{this.get("node").removeClass("yui-button-disabled");this.get("node").removeClass("yui-"+this.get("type")+"-button-disabled");}if(this.get("type")=="select"){this.get("node").set("disabled",J);}}},label:{value:"LABEL",setter:function(J){if(this.get("type")=="push"){this.get("node").query("a").set("innerHTML",J);}}},title:{value:"TITLE",setter:function(J){this.get("node").set("title",J);}},container:{value:null,writeOnce:true,setter:function(J){var K=C.get(J);if(!K){C.error("Invalid Node Given: "+J);}else{K=K.item(0);}return K;}}};C.extend(D,C.Base,{buttonType:"normal",_handleMouseOver:function(){if(!this.get("disabled")){this.get("node").addClass("yui-button-hover");this.get("node").addClass("yui-"+this.get("type")+"-button-hover");}},_handleMouseOut:function(){this.get("node").removeClass("yui-button-hover");this.get("node").removeClass("yui-"+this.get("type")+"-button-hover");},checkValue:function(K){if(this.get("type")=="select"){var J=this.get("node").get("options");J.each(function(M,L){if(M.get("value")==K){this.get("node").set("selectedIndex",L);}},this);}},initializer:function(){var O,L,M,N,K,J;switch(this.get("type")){case"select":case"menu":M=C.Node.create("<select></select>");N=this.get("menu");for(L=0;L<N.length;L++){K=C.Node.create('<option value="'+((N[L].value)?N[L].value:N[L].text)+'">'+N[L].text+"</option>");M.appendChild(K);if(N[L].checked){K.set("selected",true);}}M.on("change",C.bind(this._handleSelect,this));O=C.stamp(M);M.set("id",O);this.set("node",M);break;default:J='<span unselectable="on" class="yui-button yui-'+this.get("type")+'-button"><span class="first-child"><a href="#" tabIndex="-1" title=""></a></span></span>';this.set("node",C.Node.create(J));this.get("node").on("mouseover",C.bind(this._handleMouseOver,this));this.get("node").on("mouseout",C.bind(this._handleMouseOut,this));break;}O=C.stamp(this.get("node"));this.set("id",O);this.get("node").set("id",O);this.set("title",this.get("title"));this.set("label",this.get("label"));this.set("disabled",this.get("disabled"));this.get("container").appendChild(this.get("node"));this.get("node").on("click",C.bind(function(P){P.halt();},this));},_handleSelect:function(J){this.fire("change",{type:"change",value:J.target.get("value"),target:this.get("node")});},getMenu:function(){return this.get("menu");},destructor:function(){},toString:function(){return"Toolbar.Button ("+this.get("node").get("id")+")";}});C.namespace("Toolbar");C.Toolbar.Button=D;var B=function(K){var J=K;if(C.Lang.isString(K)){J=this.getButtonById(K);}if(C.Lang.isNumber(K)){J=this.getButtonByIndex(K);}if(K instanceof C.Toolbar.Button){J=K;}else{J=this.getButtonByValue(K);}return J;};var G=function(){this._configuredButtons=[];G.superclass.constructor.apply(this,arguments);};G.NAME="Toolbar";G.ATTRS={node:{setter:function(J){var K=C.get(J);if(!K){C.error("Invalid Node Given: "+J);}else{K=K.item(0);}return K;}},buttonType:{value:"basic",writeOnce:true,validator:function(J){switch(J){case"advanced":case"basic":return J;}return"basic";},setter:function(J){this.buttonType=C.Toolbar.Button;}},buttons:{value:[]},cont:{value:null},id:{value:null},grouplabels:{value:true,setter:function(J){if(J){this.get("cont").removeClass(this.CLASS_PREFIX+"-nogrouplabels");}else{this.get("cont").addClass(this.CLASS_PREFIX+"-nogrouplabels");}}},titlebar:{value:false},collapse:{value:false}};C.extend(G,C.Base,{fireEvent:function(K,J){if(J.target){delete J.target;}this.fire(K,J);},_handleCollapse:function(){var L=this.get("collapse");if(this._titlebar){var K=null;var J=this._titlebar.query("span.collapse");if(L){if(J){return true;}K=C.Node.create('<span title="'+this.STR_COLLAPSE+'" class="collapse">X</span>');this._titlebar.appendChild(K);K.on("click",C.bind(function(){if(this.get("cont").get("parentNode").hasClass("yui-toolbar-container-collapsed")){this.collapse(false);}else{this.collapse();}},this));}else{K=this._titlebar.query("span.collapse");if(K){if(this.get("cont").get("parentNode").hasClass("yui-toolbar-container-collapsed")){this.collapse(false);}K.get("parentNode").removeChild(K);}}}},_renderTitle:function(){var K=this.get("titlebar");if(K){if(this._titlebar&&this._titlebar.get("parentNode")){this._titlebar.get("parentNode").removeChild(this._titlebar);}this._titlebar=C.Node.create('<div tabIndex="-1" class="'+this.CLASS_PREFIX+'-titlebar"></div>');this._titlebar.on("focus",C.bind(this._handleFocus,this));if(C.Lang.isString(K)){var J=C.Node.create('<h2 tabIndex="-1"><a href="#" tabIndex="0">'+K+"</a></h2>");this._titlebar.appendChild(J);J.get("firstChild").on("click",function(L){L.halt();});}if(this.get("node").get("firstChild")){this.get("node").insertBefore(this._titlebar,this.get("node").get("firstChild"));}else{this.get("node").appendChild(this._titlebar);}if(this.get("collapse")){this.set("collapse",true);}}else{if(this._titlebar){if(this._titlebar&&this._titlebar.get("parentNode")){this._titlebar.get("parentNode").removeChild(this._titlebar);}}}},_configuredButtons:null,_addMenuClasses:function(M,J,N){F.addClass(this.element,"yui-toolbar-"+N.get("value")+"-menu");if(F.hasClass(N._button.parentNode.parentNode,"yui-toolbar-select")){F.addClass(this.element,"yui-toolbar-select-menu");}var K=this.getItems();for(var L=0;L<K.length;L++){F.addClass(K[L].element,"yui-toolbar-"+N.get("value")+"-"+((K[L].value)?K[L].value.replace(/ /g,"-").toLowerCase():K[L]._oText.nodeValue.replace(/ /g,"-").toLowerCase()));F.addClass(K[L].element,"yui-toolbar-"+N.get("value")+"-"+((K[L].value)?K[L].value.replace(/ /g,"-"):K[L]._oText.nodeValue.replace(/ /g,"-")));
}},buttonType:C.Toolbar.Button,dd:null,_colorData:{"#111111":"Obsidian","#2D2D2D":"Dark Gray","#434343":"Shale","#5B5B5B":"Flint","#737373":"Gray","#8B8B8B":"Concrete","#A2A2A2":"Gray","#B9B9B9":"Titanium","#000000":"Black","#D0D0D0":"Light Gray","#E6E6E6":"Silver","#FFFFFF":"White","#BFBF00":"Pumpkin","#FFFF00":"Yellow","#FFFF40":"Banana","#FFFF80":"Pale Yellow","#FFFFBF":"Butter","#525330":"Raw Siena","#898A49":"Mildew","#AEA945":"Olive","#7F7F00":"Paprika","#C3BE71":"Earth","#E0DCAA":"Khaki","#FCFAE1":"Cream","#60BF00":"Cactus","#80FF00":"Chartreuse","#A0FF40":"Green","#C0FF80":"Pale Lime","#DFFFBF":"Light Mint","#3B5738":"Green","#668F5A":"Lime Gray","#7F9757":"Yellow","#407F00":"Clover","#8A9B55":"Pistachio","#B7C296":"Light Jade","#E6EBD5":"Breakwater","#00BF00":"Spring Frost","#00FF80":"Pastel Green","#40FFA0":"Light Emerald","#80FFC0":"Sea Foam","#BFFFDF":"Sea Mist","#033D21":"Dark Forrest","#438059":"Moss","#7FA37C":"Medium Green","#007F40":"Pine","#8DAE94":"Yellow Gray Green","#ACC6B5":"Aqua Lung","#DDEBE2":"Sea Vapor","#00BFBF":"Fog","#00FFFF":"Cyan","#40FFFF":"Turquoise Blue","#80FFFF":"Light Aqua","#BFFFFF":"Pale Cyan","#033D3D":"Dark Teal","#347D7E":"Gray Turquoise","#609A9F":"Green Blue","#007F7F":"Seaweed","#96BDC4":"Green Gray","#B5D1D7":"Soapstone","#E2F1F4":"Light Turquoise","#0060BF":"Summer Sky","#0080FF":"Sky Blue","#40A0FF":"Electric Blue","#80C0FF":"Light Azure","#BFDFFF":"Ice Blue","#1B2C48":"Navy","#385376":"Biscay","#57708F":"Dusty Blue","#00407F":"Sea Blue","#7792AC":"Sky Blue Gray","#A8BED1":"Morning Sky","#DEEBF6":"Vapor","#0000BF":"Deep Blue","#0000FF":"Blue","#4040FF":"Cerulean Blue","#8080FF":"Evening Blue","#BFBFFF":"Light Blue","#212143":"Deep Indigo","#373E68":"Sea Blue","#444F75":"Night Blue","#00007F":"Indigo Blue","#585E82":"Dockside","#8687A4":"Blue Gray","#D2D1E1":"Light Blue Gray","#6000BF":"Neon Violet","#8000FF":"Blue Violet","#A040FF":"Violet Purple","#C080FF":"Violet Dusk","#DFBFFF":"Pale Lavender","#302449":"Cool Shale","#54466F":"Dark Indigo","#655A7F":"Dark Violet","#40007F":"Violet","#726284":"Smoky Violet","#9E8FA9":"Slate Gray","#DCD1DF":"Violet White","#BF00BF":"Royal Violet","#FF00FF":"Fuchsia","#FF40FF":"Magenta","#FF80FF":"Orchid","#FFBFFF":"Pale Magenta","#4A234A":"Dark Purple","#794A72":"Medium Purple","#936386":"Cool Granite","#7F007F":"Purple","#9D7292":"Purple Moon","#C0A0B6":"Pale Purple","#ECDAE5":"Pink Cloud","#BF005F":"Hot Pink","#FF007F":"Deep Pink","#FF409F":"Grape","#FF80BF":"Electric Pink","#FFBFDF":"Pink","#451528":"Purple Red","#823857":"Purple Dino","#A94A76":"Purple Gray","#7F003F":"Rose","#BC6F95":"Antique Mauve","#D8A5BB":"Cool Marble","#F7DDE9":"Pink Granite","#C00000":"Apple","#FF0000":"Fire Truck","#FF4040":"Pale Red","#FF8080":"Salmon","#FFC0C0":"Warm Pink","#441415":"Sepia","#82393C":"Rust","#AA4D4E":"Brick","#800000":"Brick Red","#BC6E6E":"Mauve","#D8A3A4":"Shrimp Pink","#F8DDDD":"Shell Pink","#BF5F00":"Dark Orange","#FF7F00":"Orange","#FF9F40":"Grapefruit","#FFBF80":"Canteloupe","#FFDFBF":"Wax","#482C1B":"Dark Brick","#855A40":"Dirt","#B27C51":"Tan","#7F3F00":"Nutmeg","#C49B71":"Mustard","#E1C4A8":"Pale Tan","#FDEEE0":"Marble"},_colorPicker:null,STR_COLLAPSE:"Collapse Toolbar",STR_EXPAND:"Expand Toolbar",STR_SPIN_LABEL:"Spin Button with value {VALUE}. Use Control Shift Up Arrow and Control Shift Down arrow keys to increase or decrease the value.",STR_SPIN_UP:"Click to increase the value of this input",STR_SPIN_DOWN:"Click to decrease the value of this input",_titlebar:null,browser:C.UA,_buttonList:null,_buttonGroupList:null,_sep:null,_sepCount:null,_dragHandle:null,_toolbarConfigs:{renderer:true},CLASS_CONTAINER:"yui-toolbar-container",CLASS_DRAGHANDLE:"yui-toolbar-draghandle",CLASS_SEPARATOR:"yui-toolbar-separator",CLASS_DISABLED:"yui-toolbar-disabled",CLASS_PREFIX:"yui-toolbar",initializer:function(){var J=C.Node.create('<fieldset><legend>Toolbar</legend><div class="yui-toolbar-subcont"></div></fieldset>');this.set("id",this.get("node").get("id"));this.get("node").appendChild(J);this.set("cont",J.query("div.yui-toolbar-subcont"));this.get("node").set("tabIndex","-1");this.get("node").addClass(this.CLASS_CONTAINER);this._renderTitle();this._handleCollapse();this.on("titlebarChange",C.bind(this._renderTitle,this));this.on("collapseChange",C.bind(this._handleCollapse,this));this.processButtons();},processButtons:function(){var L,M,K,J,N=this.get("buttons");C.each(N,function(P,O){if(P.type=="separator"){this.addSeparator();}else{if(P.group!==undefined){M=this.addButtonGroup(P);if(M){K=M.length;for(J=0;J<K;J++){if(M[J]){this._configuredButtons[this._configuredButtons.length]=M[J].id;}}}this.set("buttons",N);}else{L=this.addButton(P);if(L){this._configuredButtons[this._configuredButtons.length]=L.id;}}}},this);},initAttributes:function(J){A.widget.Toolbar.superclass.initAttributes.call(this,J);this.setAttributeConfig("disabled",{value:false,method:function(K){if(this.get("disabled")===K){return false;}if(K){this.addClass(this.CLASS_DISABLED);this.set("draggable",false);this.disableAllButtons();}else{this.removeClass(this.CLASS_DISABLED);if(this._configs.draggable._initialConfig.value){this.set("draggable",true);}this.resetAllButtons();}}});this.setAttributeConfig("draggable",{value:(J.draggable||false),method:function(K){if(K&&!this.get("titlebar")){A.log("Dragging enabled","info","Toolbar");if(!this._dragHandle){this._dragHandle=document.createElement("SPAN");this._dragHandle.innerHTML="|";this._dragHandle.setAttribute("title","Click to drag the toolbar");this._dragHandle.id=this.get("id")+"_draghandle";F.addClass(this._dragHandle,this.CLASS_DRAGHANDLE);if(this.get("cont").hasChildNodes()){this.get("cont").insertBefore(this._dragHandle,this.get("cont").firstChild);}else{this.get("cont").appendChild(this._dragHandle);}this.dd=new A.util.DD(this.get("id"));this.dd.setHandleElId(this._dragHandle.id);}}else{A.log("Dragging disabled","info","Toolbar");if(this._dragHandle){this._dragHandle.parentNode.removeChild(this._dragHandle);
this._dragHandle=null;this.dd=null;}}if(this._titlebar){if(K){this.dd=new A.util.DD(this.get("id"));this.dd.setHandleElId(this._titlebar);F.addClass(this._titlebar,"draggable");}else{F.removeClass(this._titlebar,"draggable");if(this.dd){this.dd.unreg();this.dd=null;}}}},validator:function(L){var K=true;if(!A.util.DD){K=false;}return K;}});},addButtonGroup:function(M){if(!this.get("node").hasClass(this.CLASS_PREFIX+"-grouped")){this.get("node").addClass(this.CLASS_PREFIX+"-grouped");}var O=C.Node.create('<div class="'+this.CLASS_PREFIX+"-group "+this.CLASS_PREFIX+"-group-"+M.group+'"></div>');if(M.label){var J=C.Node.create("<h3>"+M.label+"</h3>");O.appendChild(J);}if(!this.get("grouplabels")){this.get("cont").addClass(this.CLASS_PREFIX,"-nogrouplabels");}this.get("cont").appendChild(O);var L=C.Node.create("<ul></ul>");O.appendChild(L);if(!this._buttonGroupList){this._buttonGroupList={};}this._buttonGroupList[M.group]=L;var N=[],K;C.each(M.buttons,function(Q){var P=C.Node.create('<li class="'+this.CLASS_PREFIX+'-groupitem"></a>');L.appendChild(P);if((Q.type!==undefined)&&Q.type=="separator"){this.addSeparator(P);}else{Q.container=P;K=this.addButton(Q);if(K){N[N.length]=K.id;}}},this);return N;},addButtonToGroup:function(L,M,N){var K=this._buttonGroupList[M],J=document.createElement("li");J.className=this.CLASS_PREFIX+"-groupitem";L.container=J;this.addButton(L,N);K.appendChild(J);},addButton:function(O,P){if(!this._buttonList){this._buttonList=[];}if(!O.container){O.container=this.get("cont");}var L={},N=false;C.each(O,function(R,Q){if(!this._toolbarConfigs[Q]){L[Q]=R;}},this);if(O.type=="select"){L.type="menu";}if(O.type=="spin"){L.type="push";}if(L.type=="color"){if(C.Overlay){L=this._makeColorButton(L);}else{N=true;}}if(L.menu){if((C.Overlay)&&(O.menu instanceof C.Overlay)){O.menu.on("visibleChange",function(){this._button=L;});}else{}}if(N){O=false;}else{var K=new this.buttonType(L);K.get("node").set("tabIndex","-1");K.get("node").set("role","button");if(!L.id||!O.id){O.id=K.get("id");L.id=K.get("id");}if(this.get("disabled")){K.set("disabled",true);}K.get("node").addClass(this.CLASS_PREFIX+"-"+K.get("value"));var M=C.Node.create('<span class="'+this.CLASS_PREFIX+'-icon"></span>');K.get("node").insertBefore(M,K.get("node").get("firstChild"));if(O.type=="spin"){if(!C.Lang.isArray(O.range)){O.range=[10,100];}this._makeSpinButton(K,O);}K.get("node").set("title",K.get("label"));if(O.type!="spin"){if((C.Overlay)&&(L.menu instanceof C.Overlay)){var J=function(R){var Q=true;if(R.keyCode&&(R.keyCode==9)){Q=false;}if(Q){if(this._colorPicker){this._colorPicker._button=O.value;}K.getMenu().set("visible",!K.getMenu().get("visible"));}R.halt();};K.get("node").on("mousedown",C.bind(J,this));K.get("node").on("keydown",C.bind(J,this));}else{if((O.type!="menu")&&(O.type!="select")){K.get("node").on("keypress",C.bind(this._buttonClick,this));K.get("node").on("mousedown",C.bind(function(Q){Q.halt();this._buttonClick(Q,O);},this));K.get("node").on("click",function(Q){Q.halt();});}else{K.on("mousedown",function(Q){Q.halt();});K.on("click",function(Q){Q.halt();});K.on("change",function(Q){if(!O.menucmd){O.menucmd=O.value;}O.value=Q.value;this._buttonClick(Q,O);},this,true);}}}else{K.on("mousedown",function(Q){Q.halt();});K.on("click",function(Q){Q.halt();});}if(this.browser.ie){}if(this.browser.webkit){}this._buttonList[this._buttonList.length]=K;}return O;},addSeparator:function(J,M){var K=((J)?J:this.get("cont"));if(this._sepCount===null){this._sepCount=0;}if(!this._sep){this._sep=C.Node.create('<span class="'+this.CLASS_SEPARATOR+'">|</span>');}var L=this._sep.cloneNode(true);this._sepCount++;L.addClass(this.CLASS_SEPARATOR+"-"+this._sepCount);if(M){var N=null;if(M.get){N=M.get("element").nextSibling;}else{if(M.nextSibling){N=M.nextSibling;}else{N=M;}}if(N){if(N==M){N.parentNode.appendChild(L);}else{N.parentNode.insertBefore(L,N);}}}else{K.appendChild(L);}return L;},_createColorPicker:function(M){var L=C.get("#"+M+"_colors");if(L){L.get("parentNode").removeChild(L);}var J=C.Node.create('<div class="yui-toolbar-colors" id="'+M+'_colors" style="display: none;"></div>');C.get("body").appendChild(J);this._colorPicker=J;var K="";C.each(this._colorData,function(O,N){K+='<a style="background-color: '+N+'" href="#">'+N.replace("#","")+"</a>";},this);K+="<span><em>X</em><strong></strong></span>";J.set("innerHTML",K);J.on("mouseover",C.bind(function(R){var P=this._colorPicker;var Q=P.query("em");var O=P.query("strong");var N=R.target;if(N.get("tagName").toLowerCase()=="a"){Q.setStyle("backgroundColor",N.getStyle("backgroundColor"));O.set("innerHTML",this._colorData["#"+N.get("innerHTML")]+"<br>"+N.get("innerHTML"));}},this));J.on("focus",function(N){N.halt();});J.on("click",function(N){N.halt();});J.on("mousedown",C.bind(function(O){O.halt();var N=O.target,P;if(N.get("tagName").toLowerCase()=="a"){P=N.get("innerHTML");var R=this.fire("colorPickerClicked",{type:"colorPickerClicked",button:this._colorPicker._button,color:P,colorName:this._colorData["#"+P]});var Q={color:P,colorName:this._colorData["#"+P],value:this._colorPicker._button};this.fire("buttonClick",{type:"buttonClick",button:Q});this.getButtonByValue(this._colorPicker._button).getMenu().hide();this._colorPicker.setStyle("display","none");}},this));},_resetColorPicker:function(){var K=this._colorPicker.query("em");var J=this._colorPicker.query("strong");K.setStyle("backgroundColor","transparent");J.set("innerHTML","");},_makeColorButton:function(J){if(!this._colorPicker){this._createColorPicker(this.get("id"));}J.type="color";J.menu=new C.Overlay({contentBox:"#"+this.get("id")+"_"+J.value+"_menu",bodyContent:"FOO",visible:false,zIndex:999});J.menu.render(this.get("cont"));J.menu.set("visible",false);J.menu.get("contentBox").addClass("yui-button-menu");J.menu.get("contentBox").addClass("yui-color-button-menu");J.menu.after("visibleChange",C.bind(function(){J.menu.set("align",{node:this.getButtonById(J.id).get("node"),points:["tl","bl"]});this._resetColorPicker();
var K=this._colorPicker;if(K.get("parentNode")){K.get("parentNode").removeChild(K);}J.menu.get("contentBox").query(".yui-widget-bd").set("innerHTML","");J.menu.get("contentBox").query(".yui-widget-bd").appendChild(K);this._colorPicker.setStyle("display","block");},this));return J;},_makeSpinButton:function(W,Q){W.get("node").addClass(this.CLASS_PREFIX+"-spinbutton");var X=this,S=W.get("node"),N=Q.range,M=C.Node.create('<a href="#" tabIndex="-1" class="up" title="'+this.STR_SPIN_UP+'">'+this.STR_SPIN_UP+"</a>"),L=C.Node.create('<a href="#" tabIndex="-1" class="down" title="'+this.STR_SPIN_DOWN+'">'+this.STR_SPIN_DOWN+"</a>");S.appendChild(M);S.appendChild(L);var R=C.Lang.substitute(this.STR_SPIN_LABEL,{VALUE:W.get("label")});W.set("title",R);var V=function(Y){Y=((Y<N[0])?N[0]:Y);Y=((Y>N[1])?N[1]:Y);return Y;};var U=this.browser;var K=false;var P=this.STR_SPIN_LABEL;if(this._titlebar&&this._titlebar.get("firstChild")){K=this._titlebar.get("firstChild");}var J=function(Z){Z.halt();if(!W.get("disabled")&&(Z.keyCode!=9)){var a=parseInt(W.get("label"),10);a++;a=V(a);W.set("label",""+a);var Y=C.Lang.substitute(P,{VALUE:W.get("label")});W.set("title",Y);X._buttonClick(Z,Q);}};var T=function(Z){Z.halt();if(!W.get("disabled")&&(Z.keyCode!=9)){var a=parseInt(W.get("label"),10);a--;a=V(a);W.set("label",""+a);var Y=C.Lang.substitute(P,{VALUE:W.get("label")});W.set("title",Y);X._buttonClick(Z,Q);}};var O=function(Y){if(Y.keyCode==38){J(Y);}else{if(Y.keyCode==40){T(Y);}else{if(Y.keyCode==107&&Y.shiftKey){J(Y);}else{if(Y.keyCode==109&&Y.shiftKey){T(Y);}}}}};W.on("keydown",C.bind(O,this));M.on("mousedown",function(Y){Y.halt();});L.on("mousedown",function(Y){Y.halt();});M.on("click",C.bind(J,this));L.on("click",C.bind(T,this));},_buttonClick:function(Q,K){var J=true;if(Q&&Q.type=="keypress"){if(Q.keyCode==9){J=false;}else{if((Q.keyCode===13)||(Q.keyCode===0)||(Q.keyCode===32)){}else{J=false;}}}if(J){var S=true,M=false;K.isSelected=this.isSelected(K.id);if(K.value){M=this.fire(K.value+"Click",{type:K.value+"Click",target:this.get("element"),button:K});if(M===false){S=false;}}if(K.menucmd&&S){M=this.fire(K.menucmd+"Click",{type:K.menucmd+"Click",target:this.get("element"),button:K});if(M===false){S=false;}}if(S){this.fire("buttonClick",{type:"buttonClick",target:this.get("element"),button:K});}if(K.type=="select"){var P=this.getButtonById(K.id);if(P.buttonType=="rich"){var O=K.value;for(var N=0;N<K.menu.length;N++){if(K.menu[N].value==K.value){O=K.menu[N].text;break;}}P.set("label",'<span class="yui-toolbar-'+K.menucmd+"-"+(K.value).replace(/ /g,"-").toLowerCase()+'">'+O+"</span>");var R=P.getMenu().getItems();for(var L=0;L<R.length;L++){if(R[L].value.toLowerCase()==K.value.toLowerCase()){R[L].cfg.setProperty("checked",true);}else{R[L].cfg.setProperty("checked",false);}}}}if(Q){Q.halt();}}},_keyNav:null,_navCounter:null,_navigateButtons:function(K){switch(K.keyCode){case 37:case 39:if(K.keyCode==37){this._navCounter--;}else{this._navCounter++;}if(this._navCounter>(this._buttonList.length-1)){this._navCounter=0;}if(this._navCounter<0){this._navCounter=(this._buttonList.length-1);}if(this._buttonList[this._navCounter]){var J=this._buttonList[this._navCounter].get("node");if(this.browser.ie){J=this._buttonList[this._navCounter].get("node").query("a");}if(this._buttonList[this._navCounter].get("disabled")){this._navigateButtons(K);}else{J.focus();}}break;}},_handleFocus:function(){if(!this._keyNav){var J="keypress";if(this.browser.ie){J="keydown";}this.get("node").on(J,C.bind(this._navigateButtons,this));this._keyNav=true;this._navCounter=-1;}},getButtonById:function(L){var J=this._buttonList.length;for(var K=0;K<J;K++){if(this._buttonList[K]&&this._buttonList[K].get("id")==L){return this._buttonList[K];}}return false;},getButtonByValue:function(P){var M=this.get("buttons");if(!M){return false;}var K=M.length;for(var N=0;N<K;N++){if(M[N].group!==undefined){for(var J=0;J<M[N].buttons.length;J++){if((M[N].buttons[J].value==P)||(M[N].buttons[J].menucmd==P)){return this.getButtonById(M[N].buttons[J].id);}if(M[N].buttons[J].menu){for(var O=0;O<M[N].buttons[J].menu.length;O++){if(M[N].buttons[J].menu[O].value==P){return this.getButtonById(M[N].buttons[J].id);}}}}}else{if((M[N].value==P)||(M[N].menucmd==P)){return this.getButtonById(M[N].id);}if(M[N].menu){for(var L=0;L<M[N].menu.length;L++){if(M[N].menu[L].value==P){return this.getButtonById(M[N].id);}}}}}return false;},getButtonByIndex:function(J){if(this._buttonList[J]){return this._buttonList[J];}else{return false;}},getButtons:function(){return this._buttonList;},disableButton:function(K){var J=B.call(this,K);if(J){J.set("disabled",true);}else{return false;}},enableButton:function(K){if(this.get("disabled")){return false;}var J=B.call(this,K);if(J){if(J.get("disabled")){J.set("disabled",false);}}else{return false;}},isSelected:function(K){var J=B.call(this,K);if(J){return J._selected;}return false;},selectButton:function(N,L){var K=B.call(this,N);if(K&&(K.get("type")=="push")){K.get("node").addClass("yui-button-selected");K.get("node").addClass("yui-button-"+K.get("value")+"-selected");K._selected=true;if(L){if(K.buttonType=="rich"){var M=K.getMenu().getItems();for(var J=0;J<M.length;J++){if(M[J].value==L){M[J].cfg.setProperty("checked",true);K.set("label",'<span class="yui-toolbar-'+K.get("value")+"-"+(L).replace(/ /g,"-").toLowerCase()+'">'+M[J]._oText.nodeValue+"</span>");}else{M[J].cfg.setProperty("checked",false);}}}}}else{return false;}},deselectButton:function(K){var J=B.call(this,K);if(J){J.get("node").removeClass("yui-button-selected");J.get("node").removeClass("yui-button-"+J.get("value")+"-selected");J.get("node").removeClass("yui-button-hover");J._selected=false;}else{return false;}},deselectAllButtons:function(){var J=this._buttonList.length;for(var K=0;K<J;K++){this.deselectButton(this._buttonList[K]);}},disableAllButtons:function(){if(this.get("disabled")){return false;}var J=this._buttonList.length;for(var K=0;K<J;K++){this.disableButton(this._buttonList[K]);
}},enableAllButtons:function(){if(this.get("disabled")){return false;}var J=this._buttonList.length;for(var K=0;K<J;K++){this.enableButton(this._buttonList[K]);}},resetAllButtons:function(N){if(!C.Lang.isObject(N)){N={};}if(this.get("disabled")||!this._buttonList){return false;}var J=this._buttonList.length;for(var K=0;K<J;K++){var M=this._buttonList[K];if(M){var L=false;if(N[M.get("id")]){this.enableButton(M);this.selectButton(M);}else{if(L){this.disableButton(M);}else{this.enableButton(M);}this.deselectButton(M);}}}},destroyButton:function(O){var M=B.call(this,O);if(M){var N=M.get("id"),K=[],L=0,J=this._buttonList.length;M.destroy();for(L=0;L<J;L++){if(this._buttonList[L].get("id")!=N){K[K.length]=this._buttonList[L];}}this._buttonList=K;}else{return false;}},destructor:function(){var K=this._configuredButtons.length,L,M,J;for(J=0;J<K;J++){this.destroyButton(this._configuredButtons[J]);}this._configuredButtons=null;this.get("element").innerHTML="";this.get("element").className="";for(M in this){if(H.hasOwnProperty(this,M)){this[M]=null;}}return true;},collapse:function(K){var J=this._titlebar.query("span.collapse");if(K===false){this.get("cont").get("parentNode").removeClass("yui-toolbar-container-collapsed");if(J){J.removeClass("collapsed");J.set("title",this.STR_COLLAPSE);}this.fire("toolbarExpanded",{type:"toolbarExpanded"});}else{if(J){J.addClass("collapsed");J.set("title",this.STR_EXPAND);}this.get("cont").get("parentNode").addClass("yui-toolbar-container-collapsed");this.fire("toolbarCollapsed",{type:"toolbarCollapsed"});}},toString:function(){return"Toolbar";}});C.namespace("Y.Toolbar");C.Toolbar.Bar=G;var A=C.Port(),H=A.lang,F=A.util.Dom,I=A.util.Event;var E=function(L){var K=C.get(L.node),M=K.get("id");if(!M){M=C.stamp(K);K.set("id",M);}var J=C.Node.create('<div id="'+M+'_container"><div class="first-child"><div id="'+M+'_toolbar" class="toolbar_cont"></div><div class="wrapper"></div></div></div>');C.get("body").appendChild(J);L.element_cont=J;L.editor_wrapper=J.query("div.wrapper");L.toolbar_cont=J.query("div.toolbar_cont");C.get("body").removeChild(J);if(!L.html){L.html='<html><head><title>{TITLE}</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><base href="'+this._baseHREF+'"><style>{CSS}</style><style>{HIDDEN_CSS}</style><style>{EXTRA_CSS}</style></head><body onload="document.body._rteLoaded = true;">{CONTENT}</body></html>';}if(!L.css){L.css=this._defaultCSS;}E.superclass.constructor.apply(this,arguments);};E.NAME="simpleeditor";E.ATTRS={node:{setter:function(J){var K=C.get(J);if(!K){C.error("Invalid Node Given: "+J);}else{K=K.item(0);}return K;}},"container":{writeOnce:true,value:false},"iframe":{value:null},"textarea":{value:null,writeOnce:true},"element_cont":{value:null},"editor_wrapper":{value:null},"toolbar_cont":{value:null,writeOnce:true},"toolbar":{value:null},"height":{value:null,setter:function(J){if(this._rendered){this.get("iframe").get("parentNode").setStyle("height",J);}}},"width":{value:null,setter:function(J){if(this._rendered){this.get("element_cont").setStyle("width",J);}}},"blankimage":{value:null},"css":{value:null,writeOnce:true},"html":{value:null,writeOnce:true},"extracss":{value:"",writeOnce:true},setDesignMode:{value:true},nodeChangeDelay:{value:true},dompath:{value:false},markup:{value:"semantic",validator:function(J){switch(J.toLowerCase()){case"semantic":case"css":case"default":case"xhtml":return true;}return false;}},maxUndo:{writeOnce:true,value:30},ptags:{writeOnce:true,value:false},plainText:{writeOnce:true,value:false},disabled_iframe:{value:null},nodeChangeThreshold:{value:3,validator:C.Lang.isNumber},allowNoEdit:{value:false,validator:C.Lang.isBoolean},limitCommands:{value:false,validator:C.Lang.isBoolean},removeLineBreaks:{value:false,validator:C.Lang.isBoolean},filterWord:{value:false,validator:C.Lang.isBoolean},insert:{value:false},saveEl:{value:null,setter:function(J){var K=C.get(J);if(!K){return false;}else{K=K.item(0);}return K;}},disabled:{value:false,setter:function(J){if(this._rendered){this._disableEditor(J);}}},focusAtStart:{value:false,writeOnce:true},handleSubmit:{value:false}};C.extend(E,C.PortBase,{_handleSubmit:function(){var J=this.get("handleSubmit");if(this.get("node").get("form")){if(!this._formButtons){this._formButtons=[];}if(J){this.get("node").get("form").on("submit",C.bind(this._handleFormSubmit,this));var K=this.get("node").get("form").query("input");if(K){K.each(function(M,L){var N=M.get("type");if(N&&(N.toLowerCase()=="submit")){M.on("click",C.bind(this._handleFormButtonClick,this));this._formButtons.push(M);}},this);}}else{}}},_handleInsert:function(){if(this.get("insert")){var M={fontname:true,fontsize:true,forecolor:true,backcolor:true};var L=this._defaultToolbar.buttons;for(var K=0;K<L.length;K++){if(L[K].buttons){for(var J=0;J<L[K].buttons.length;J++){if(L[K].buttons[J].value){if(M[L[K].buttons[J].value]){delete L[K].buttons[J].disabled;}}}}}}},_handleDOMPath:function(){var J=this.get("dompath");if(J&&!this.dompath){this.dompath=C.Node.create('<div class="dompath" id="'+this.get("node").get("id")+'_dompath"></div>');this.get("element_cont").get("firstChild").appendChild(this.dompath);if(this.get("iframe")){this._writeDomPath();}}else{if(!J&&this.dompath){this.dompath.get("parentNode").removeChild(this.dompath);this.dompath=null;}}},_lastCommand:null,_undoNodeChange:function(){},_storeUndo:function(){},_checkKey:function(J,M){var K=false;if((M.keyCode===J.key)){if(J.mods&&(J.mods.length>0)){var N=0;for(var L=0;L<J.mods.length;L++){if(this.browser.mac){if(J.mods[L]=="ctrl"){J.mods[L]="meta";}}if(M[J.mods[L]+"Key"]===true){N++;}}if(N===J.mods.length){K=true;}}else{K=true;}}return K;},_keyMap:{SELECT_ALL:{key:65,mods:["ctrl"]},CLOSE_WINDOW:{key:87,mods:["shift","ctrl"]},FOCUS_TOOLBAR:{key:27,mods:["shift"]},FOCUS_AFTER:{key:27},FONT_SIZE_UP:{key:38,mods:["shift","ctrl"]},FONT_SIZE_DOWN:{key:40,mods:["shift","ctrl"]},CREATE_LINK:{key:76,mods:["shift","ctrl"]},BOLD:{key:66,mods:["shift","ctrl"]},ITALIC:{key:73,mods:["shift","ctrl"]},UNDERLINE:{key:85,mods:["shift","ctrl"]},UNDO:{key:90,mods:["ctrl"]},REDO:{key:90,mods:["shift","ctrl"]},JUSTIFY_LEFT:{key:219,mods:["shift","ctrl"]},JUSTIFY_CENTER:{key:220,mods:["shift","ctrl"]},JUSTIFY_RIGHT:{key:221,mods:["shift","ctrl"]}},_cleanClassName:function(J){return J.replace(/ /g,"-").toLowerCase();
},_textarea:null,_docType:'<!DOCTYPE HTML PUBLIC "-/'+"/W3C/"+"/DTD HTML 4.01/"+'/EN" "http:/'+'/www.w3.org/TR/html4/strict.dtd">',editorDirty:null,_defaultCSS:"html { height: 95%; } body { padding: 7px; background-color: #fff; font: 13px/1.22 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small; } a, a:visited, a:hover { color: blue !important; text-decoration: underline !important; cursor: text !important; } .warning-localfile { border-bottom: 1px dashed red !important; } .yui-busy { cursor: wait !important; } img.selected { border: 2px dotted #808080; } img { cursor: pointer !important; border: none; } body.ptags.webkit div.yui-wk-p { margin: 11px 0; } body.ptags.webkit div.yui-wk-div { margin: 0; }",_defaultToolbar:null,_lastButton:null,_baseHREF:function(){var J=document.location.href;if(J.indexOf("?")!==-1){J=J.substring(0,J.indexOf("?"));}J=J.substring(0,J.lastIndexOf("/"))+"/";return J;}(),_lastImage:null,_blankImageLoaded:null,_fixNodesTimer:null,_nodeChangeTimer:null,_nodeChangeDelayTimer:null,_lastNodeChangeEvent:null,_lastNodeChange:0,_rendered:null,DOMReady:null,_selection:null,_mask:null,_showingHiddenElements:null,currentWindow:null,currentEvent:null,operaEvent:null,currentFont:null,currentElement:null,dompath:null,beforeElement:null,afterElement:null,invalidHTML:{form:true,input:true,button:true,select:true,link:true,html:true,body:true,iframe:true,script:true,style:true,textarea:true},toolbar:null,_contentTimer:null,_contentTimerMax:500,_contentTimerCounter:0,_disabled:["createlink","fontname","fontsize","forecolor","backcolor"],_alwaysDisabled:{undo:true,redo:true},_alwaysEnabled:{},_semantic:{"bold":true,"italic":true,"underline":true},_tag2cmd:{"b":"bold","strong":"bold","i":"italic","em":"italic","u":"underline","sup":"superscript","sub":"subscript","img":"insertimage","a":"createlink","ul":"insertunorderedlist","ol":"insertorderedlist"},_createIframe:function(){var M=document.createElement("iframe");M.id=this.get("node").get("id")+"_editor";var L={border:"0",frameBorder:"0",marginWidth:"0",marginHeight:"0",leftMargin:"0",topMargin:"0",allowTransparency:"true",width:"100%"};if(this.get("autoHeight")){L.scrolling="no";}C.each(L,function(O,N){M.setAttribute(N,O);});var K="javascript:;";if(this.browser.ie){K="javascript:false;";}M.setAttribute("src",K);var J=C.get(M);J.setStyle("visibility","hidden");return J;},_isElement:function(K,J){if(K&&K.tagName&&(K.tagName.toLowerCase()==J)){return true;}if(K&&K.getAttribute&&(K.getAttribute("tag")==J)){return true;}return false;},_hasParent:function(K,J){if(!K||!K.parentNode){return false;}while(K.parentNode){if(this._isElement(K,J)){return K;}if(K.parentNode){K=K.parentNode;}else{return false;}}return false;},_getDoc:function(){var K=false;try{var J=document.getElementById(this.get("iframe").get("id"));if(J&&J.contentWindow.document){K=J.contentWindow.document;return K;}}catch(L){return false;}},_getWindow:function(){var J=document.getElementById(this.get("iframe").get("id"));return J.contentWindow;},focus:function(){this._getWindow().focus();},_focusWindow:function(){A.log("_focusWindow: depreciated in favor of this.focus()","warn","Editor");this.focus();},_hasSelection:function(){var L=this._getSelection();var J=this._getRange();var K=false;if(!L||!J){return K;}if(this.browser.ie||this.browser.opera){if(J.text){K=true;}if(J.html){K=true;}}else{if(this.browser.webkit){if(L+""!==""){K=true;}}else{if(L&&(L.toString()!=="")&&(L!==undefined)){K=true;}}}return K;},_getSelection:function(){var J=null;if(this._getDoc()&&this._getWindow()){if(this._getDoc().selection){J=this._getDoc().selection;}else{J=this._getWindow().getSelection();}if(this.browser.webkit){if(J.baseNode){this._selection={};this._selection.baseNode=J.baseNode;this._selection.baseOffset=J.baseOffset;this._selection.extentNode=J.extentNode;this._selection.extentOffset=J.extentOffset;}else{if(this._selection!==null){J=this._getWindow().getSelection();J.setBaseAndExtent(this._selection.baseNode,this._selection.baseOffset,this._selection.extentNode,this._selection.extentOffset);this._selection=null;}}}}return J;},_selectNode:function(K,N){if(!K){return false;}var L=this._getSelection(),J=null;if(this.browser.ie){try{J=this._getDoc().body.createTextRange();J.moveToElementText(K);J.select();}catch(M){A.log("IE failed to select element: "+K.tagName,"warn","SimpleEditor");}}else{if(this.browser.webkit){if(N){L.setBaseAndExtent(K,1,K,K.innerText.length);}else{L.setBaseAndExtent(K,0,K,K.innerText.length);}}else{if(this.browser.opera){L=this._getWindow().getSelection();J=this._getDoc().createRange();J.selectNode(K);L.removeAllRanges();L.addRange(J);}else{J=this._getDoc().createRange();J.selectNodeContents(K);L.removeAllRanges();L.addRange(J);}}}this.nodeChange();},_getRange:function(){var J=this._getSelection();if(J===null){return null;}if(this.browser.webkit&&!J.getRangeAt){var M=this._getDoc().createRange();try{M.setStart(J.anchorNode,J.anchorOffset);M.setEnd(J.focusNode,J.focusOffset);}catch(L){M=this._getWindow().getSelection()+"";}return M;}if(this.browser.ie||this.browser.opera){try{return J.createRange();}catch(K){return null;}}if(J.rangeCount>0){return J.getRangeAt(0);}return null;},_setDesignMode:function(J){if(this.get("setDesignMode")){try{this._getDoc().designMode=((J.toLowerCase()=="off")?"off":"on");}catch(K){}}},_toggleDesignMode:function(){A.log("It is not recommended to use this method and it will be depreciated.","warn","SimpleEditor");var K=this._getDoc().designMode,J=((K.toLowerCase()=="on")?"off":"on");this._setDesignMode(J);return J;},_focused:null,_handleFocus:function(J){if(!this._focused){A.log("Editor Window Focused","info","SimpleEditor");this._focused=true;this.fireEvent("editorWindowFocus",{type:"editorWindowFocus",target:this});}},_handleBlur:function(J){if(this._focused){A.log("Editor Window Blurred","info","SimpleEditor");this._focused=false;this.fireEvent("editorWindowBlur",{type:"editorWindowBlur",target:this});}},_initEditorEvents:function(){var K=this._getDoc(),J=this._getWindow();
C.Event.nativeAdd(K,"mouseup",C.bind(this._handleMouseUp,this));C.Event.nativeAdd(K,"mousedown",C.bind(this._handleMouseDown,this));C.Event.nativeAdd(K,"click",C.bind(this._handleClick,this));C.Event.nativeAdd(K,"dblclick",C.bind(this._handleDoubleClick,this));C.Event.nativeAdd(K,"keypress",C.bind(this._handleKeyPress,this));C.Event.nativeAdd(K,"keyup",C.bind(this._handleKeyUp,this));C.Event.nativeAdd(K,"keydown",C.bind(this._handleKeyDown,this));C.Event.nativeAdd(J,"focus",C.bind(this._handleFocus,this));C.Event.nativeAdd(J,"blur",C.bind(this._handleBlur,this));},_removeEditorEvents:function(){var K=this._getDoc(),J=this._getWindow();C.Event.nativeRremove(K,"mouseup",C.bind(this._handleMouseUp,this));C.Event.nativeRremove(K,"mousedown",C.bind(this._handleMouseDown,this));C.Event.nativeRremove(K,"click",C.bind(this._handleClick,this));C.Event.nativeRremove(K,"dblclick",C.bind(this._handleDoubleClick,this));C.Event.nativeRremove(K,"keypress",C.bind(this._handleKeyPress,this));C.Event.nativeRremove(K,"keyup",C.bind(this._handleKeyUp,this));C.Event.nativeRremove(K,"keydown",C.bind(this._handleKeyDown,this));C.Event.nativeRremove(J,"focus",C.bind(this._handleFocus,this));C.Event.nativeRremove(J,"blur",C.bind(this._handleBlur,this));},_fixWebkitDivs:function(){if(this.browser.webkit){var J=this._getDoc().body.getElementsByTagName("div");F.addClass(J,"yui-wk-div");}},_initEditor:function(J){if(this._editorInit){return;}this._editorInit=true;if(this.browser.ie){this._getDoc().body.style.margin="0";}if(!this.get("disabled")){this._setDesignMode("on");this._contentTimerCounter=0;}if(!this._getDoc().body){A.log("Body is null, check again","error","SimpleEditor");this._contentTimerCounter=0;this._editorInit=false;this._checkLoaded();return false;}A.log("editorLoaded","info","SimpleEditor");if(!J){this.toolbar.on("buttonClick",C.bind(this._handleToolbarClick,this));}if(!this.get("disabled")){this._initEditorEvents();this.toolbar.set("disabled",false);}if(J){this.fire("editorContentReloaded",{type:"editorreloaded"});}else{this.fire("editorContentLoaded",{type:"editorLoaded"});}this._fixWebkitDivs();if(this.get("dompath")){A.log("Delayed DomPath write","info","SimpleEditor");C.later(150,this,this._writeDomPath);}var K=[];C.each(this.browser,function(M,L){if(M){K.push(L);}},this);if(this.get("ptags")){K.push("ptags");}C.DOM.addClass(this._getDoc().body,K.join(" "));this.nodeChange(true);},_checkLoaded:function(K){this._editorInit=false;this._contentTimerCounter++;if(this._contentTimer){clearTimeout(this._contentTimer);}if(this._contentTimerCounter>this._contentTimerMax){A.log("ERROR: Body Did Not load","error","SimpleEditor");return false;}var M=false;try{if(this._getDoc()&&this._getDoc().body){if(this.browser.ie){if(this._getDoc().body.readyState=="complete"){M=true;}}else{if(this._getDoc().body._rteLoaded===true){M=true;}}}}catch(L){M=false;A.log("checking body (e)"+L,"error","SimpleEditor");}if(M===true){A.log("Firing _initEditor","info","SimpleEditor");this._initEditor(K);}else{var J=this;this._contentTimer=setTimeout(function(){J._checkLoaded.call(J,K);},20);}},_setInitialContent:function(K){A.log("Populating editor body with contents of the text area","info","SimpleEditor");var N=((this._textarea)?this.get("node").get("value"):this.get("node").get("innerHTML")),P=null;if(N===""){N="<br>";}var L=C.Lang.substitute(this.get("html"),{TITLE:this.STR_TITLE,CONTENT:this._cleanIncomingHTML(N),CSS:this.get("css"),HIDDEN_CSS:((this.get("hiddencss"))?this.get("hiddencss"):"/* No Hidden CSS */"),EXTRA_CSS:((this.get("extracss"))?this.get("extracss"):"/* No Extra CSS */")}),J=true;L=L.replace(/RIGHT_BRACKET/gi,"{");L=L.replace(/LEFT_BRACKET/gi,"}");if(document.compatMode!="BackCompat"){A.log("Adding Doctype to editable area","info","SimpleEditor");L=this._docType+"\n"+L;}else{A.log("DocType skipped because we are in BackCompat Mode.","warn","SimpleEditor");}if(this.browser.ie||this.browser.webkit||this.browser.opera||(navigator.userAgent.indexOf("Firefox/1.5")!=-1)){try{if(this.browser.air){P=this._getDoc().implementation.createHTMLDocument();var Q=this._getDoc();Q.open();Q.close();P.open();P.write(L);P.close();var M=Q.importNode(P.getElementsByTagName("html")[0],true);Q.replaceChild(M,Q.getElementsByTagName("html")[0]);Q.body._rteLoaded=true;}else{P=this._getDoc();P.open();P.write(L);P.close();}}catch(O){A.log("Setting doc failed.. (_setInitialContent)","error","SimpleEditor");J=false;}}else{this.get("iframe").set("src","data:text/html;charset=utf-8,"+encodeURIComponent(L));}this.get("iframe").setStyle("visibility","");if(J){this._checkLoaded(K);}},_setMarkupType:function(J){switch(this.get("markup")){case"css":this._setEditorStyle(true);break;case"default":this._setEditorStyle(false);break;case"semantic":case"xhtml":if(this._semantic[J]){this._setEditorStyle(false);}else{this._setEditorStyle(true);}break;}},_setEditorStyle:function(K){try{this._getDoc().execCommand("useCSS",false,!K);}catch(J){}},_getSelectedElement:function(){var O=this._getDoc(),L=null,M=null,P=null,K=true;if(this.browser.ie){this.currentEvent=this._getWindow().event;L=this._getRange();if(L){P=L.item?L.item(0):L.parentElement();if(this._hasSelection()){}if(P===O.body){P=null;}}if((this.currentEvent!==null)&&(this.currentEvent.keyCode===0)){P=I.getTarget(this.currentEvent);}}else{M=this._getSelection();L=this._getRange();if(!M||!L){return null;}if(!this._hasSelection()&&this.browser.webkit3){}if(this.browser.gecko){if(L.startContainer){if(L.startContainer.nodeType===3){P=L.startContainer.parentNode;}else{if(L.startContainer.nodeType===1){P=L.startContainer;}}if(this.currentEvent){var J=I.getTarget(this.currentEvent);if(!this._isElement(J,"html")){if(P!==J){P=J;}}}}}if(K){if(M.anchorNode&&(M.anchorNode.nodeType==3)){if(M.anchorNode.parentNode){P=M.anchorNode.parentNode;}if(M.anchorNode.nextSibling!=M.focusNode.nextSibling){P=M.anchorNode.nextSibling;}}if(this._isElement(P,"br")){P=null;}if(!P){P=L.commonAncestorContainer;if(!L.collapsed){if(L.startContainer==L.endContainer){if(L.startOffset-L.endOffset<2){if(L.startContainer.hasChildNodes()){P=L.startContainer.childNodes[L.startOffset];
}}}}}}}if(this.currentEvent!==null){try{switch(this.currentEvent.type){case"click":case"mousedown":case"mouseup":if(this.browser.webkit){P=I.getTarget(this.currentEvent);}break;default:break;}}catch(N){A.log("Firefox 1.5 errors here: "+N,"error","SimpleEditor");}}else{if((this.currentElement&&this.currentElement[0])&&(!this.browser.ie)){}}if(this.browser.opera||this.browser.webkit){if(this.currentEvent&&!P){P=I.getTarget(this.currentEvent);}}if(!P||!P.tagName){P=O.body;}if(this._isElement(P,"html")){P=O.body;}if(this._isElement(P,"body")){P=O.body;}if(P&&!P.parentNode){P=O.body;}if(P===undefined){P=null;}return P;},_getSelectedNode:function(){return C.get(this._getSelectedElement());},_getDomPath:function(J){if(!J){J=this._getSelectedElement();}var K=[];while(J!==null){if(J.ownerDocument!=this._getDoc()){J=null;break;}if(J.nodeName&&J.nodeType&&(J.nodeType==1)){K[K.length]=J;}if(this._isElement(J,"body")){break;}J=J.parentNode;}if(K.length===0){if(this._getDoc()&&this._getDoc().body){K[0]=this._getDoc().body;}}return K.reverse();},_writeDomPath:function(){var P=this._getDomPath(),N=[],L="",Q="";for(var J=0;J<P.length;J++){var R=P[J].tagName.toLowerCase();if((R=="ol")&&(P[J].type)){R+=":"+P[J].type;}if(F.hasClass(P[J],"yui-tag")){R=P[J].getAttribute("tag");}if((this.get("markup")=="semantic")||(this.get("markup")=="xhtml")){switch(R){case"b":R="strong";break;case"i":R="em";break;}}if(!F.hasClass(P[J],"yui-non")){if(F.hasClass(P[J],"yui-tag")){Q=R;}else{L=((P[J].className!=="")?"."+P[J].className.replace(/ /g,"."):"");if((L.indexOf("yui")!=-1)||(L.toLowerCase().indexOf("apple-style-span")!=-1)){L="";}Q=R+((P[J].id)?"#"+P[J].id:"")+L;}switch(R){case"body":Q="body";break;case"a":if(P[J].getAttribute("href",2)){Q+=":"+P[J].getAttribute("href",2).replace("mailto:","").replace("http:/"+"/","").replace("https:/"+"/","");}break;case"img":var K=P[J].height;var O=P[J].width;if(P[J].style.height){K=parseInt(P[J].style.height,10);}if(P[J].style.width){O=parseInt(P[J].style.width,10);}Q+="("+O+"x"+K+")";break;}if(Q.length>10){Q='<span title="'+Q+'">'+Q.substring(0,10)+"..."+"</span>";}else{Q='<span title="'+Q+'">'+Q+"</span>";}N[N.length]=Q;}}var M=N.join(" "+this.SEP_DOMPATH+" ");if(this.dompath.get("innerHTML")!=M){this.dompath.set("innerHTML",M);}},_fixNodes:function(){try{var M=this._getDoc(),J=[];C.each(this.invalidHTML,function(P,O){if(O.toLowerCase()!="span"){var Q=M.body.getElementsByTagName(O);if(Q.length){for(var R=0;R<Q.length;R++){J.push(Q[R]);}}}});for(var K=0;K<J.length;K++){if(J[K].parentNode){if(H.isObject(this.invalidHTML[J[K].tagName.toLowerCase()])&&this.invalidHTML[J[K].tagName.toLowerCase()].keepContents){this._swapEl(J[K],"span",function(O){O.className="yui-non";});}else{J[K].parentNode.removeChild(J[K]);}}}var N=this._getDoc().getElementsByTagName("img");F.addClass(N,"yui-img");}catch(L){}},_isNonEditable:function(L){if(this.get("allowNoEdit")){var K=I.getTarget(L);if(this._isElement(K,"html")){K=null;}var O=this._getDomPath(K);for(var J=(O.length-1);J>-1;J--){if(F.hasClass(O[J],this.CLASS_NOEDIT)){try{this._getDoc().execCommand("enableObjectResizing",false,"false");}catch(N){}this.nodeChange();I.stopEvent(L);A.log("CLASS_NOEDIT found in DOM Path, stopping event","info","SimpleEditor");return true;}}try{this._getDoc().execCommand("enableObjectResizing",false,"true");}catch(M){}}return false;},_setCurrentEvent:function(J){this.currentEvent=J;},_handleClick:function(L){var K=this.fireEvent("beforeEditorClick",{type:"beforeEditorClick",target:this,ev:L});if(K===false){return false;}if(this._isNonEditable(L)){return false;}this._setCurrentEvent(L);if(this.currentWindow){this.closeWindow();}if(this.currentWindow){this.closeWindow();}if(this.browser.webkit){var J=I.getTarget(L);if(this._isElement(J,"a")||this._isElement(J.parentNode,"a")){I.stopEvent(L);this.nodeChange();}}else{this.nodeChange();}this.fireEvent("editorClick",{type:"editorClick",target:this,ev:L});},_handleMouseUp:function(L){var K=this.fireEvent("beforeEditorMouseUp",{type:"beforeEditorMouseUp",target:this,ev:L});if(K===false){return false;}if(this._isNonEditable(L)){return false;}var J=this;if(this.browser.opera){var M=I.getTarget(L);if(this._isElement(M,"img")){this.nodeChange();if(this.operaEvent){clearTimeout(this.operaEvent);this.operaEvent=null;this._handleDoubleClick(L);}else{this.operaEvent=window.setTimeout(function(){J.operaEvent=false;},700);}}}if(this.browser.webkit||this.browser.opera){if(this.browser.webkit){I.stopEvent(L);}}this.nodeChange();this.fireEvent("editorMouseUp",{type:"editorMouseUp",target:this,ev:L});},_handleMouseDown:function(K){var J=this.fireEvent("beforeEditorMouseDown",{type:"beforeEditorMouseDown",target:this,ev:K});if(J===false){return false;}if(this._isNonEditable(K)){return false;}this._setCurrentEvent(K);var L=I.getTarget(K);if(this.browser.webkit&&this._hasSelection()){var M=this._getSelection();if(!this.browser.webkit3){M.collapse(true);}else{M.collapseToStart();}}if(this.browser.webkit&&this._lastImage){F.removeClass(this._lastImage,"selected");this._lastImage=null;}if(this._isElement(L,"img")||this._isElement(L,"a")){if(this.browser.webkit){I.stopEvent(K);if(this._isElement(L,"img")){F.addClass(L,"selected");this._lastImage=L;}}if(this.currentWindow){this.closeWindow();}this.nodeChange();}this.fireEvent("editorMouseDown",{type:"editorMouseDown",target:this,ev:K});},_handleDoubleClick:function(K){var J=this.fireEvent("beforeEditorDoubleClick",{type:"beforeEditorDoubleClick",target:this,ev:K});if(J===false){return false;}if(this._isNonEditable(K)){return false;}this._setCurrentEvent(K);var L=I.getTarget(K);if(this._isElement(L,"img")){this.currentElement[0]=L;this.toolbar.fireEvent("insertimageClick",{type:"insertimageClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});}else{if(this._hasParent(L,"a")){this.currentElement[0]=this._hasParent(L,"a");this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});
this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});}}this.nodeChange();this.fireEvent("editorDoubleClick",{type:"editorDoubleClick",target:this,ev:K});},_handleKeyUp:function(L){var K=this.fireEvent("beforeEditorKeyUp",{type:"beforeEditorKeyUp",target:this,ev:L});if(K===false){return false;}if(this._isNonEditable(L)){return false;}this._setCurrentEvent(L);switch(L.keyCode){case this._keyMap.SELECT_ALL.key:if(this._checkKey(this._keyMap.SELECT_ALL,L)){this.nodeChange();}break;case 32:case 35:case 36:case 37:case 38:case 39:case 40:case 46:case 8:case this._keyMap.CLOSE_WINDOW.key:if((L.keyCode==this._keyMap.CLOSE_WINDOW.key)&&this.currentWindow){if(this._checkKey(this._keyMap.CLOSE_WINDOW,L)){this.closeWindow();}}else{if(!this.browser.ie){if(this._nodeChangeTimer){clearTimeout(this._nodeChangeTimer);}var J=this;this._nodeChangeTimer=setTimeout(function(){J._nodeChangeTimer=null;J.nodeChange.call(J);},100);}else{this.nodeChange();}this.editorDirty=true;}break;}this.fireEvent("editorKeyUp",{type:"editorKeyUp",target:this,ev:L});this._storeUndo();},_handleKeyPress:function(L){var K=this.fireEvent("beforeEditorKeyPress",{type:"beforeEditorKeyPress",target:this,ev:L});if(K===false){return false;}if(this.get("allowNoEdit")){if(L&&L.keyCode&&(L.keyCode==63272)){A.log("allowNoEdit is set, forward delete key has been disabled","warn","SimpleEditor");I.stopEvent(L);}}if(this._isNonEditable(L)){return false;}this._setCurrentEvent(L);if(this.browser.opera){if(L.keyCode===13){var J=this._getSelectedElement();if(!this._isElement(J,"li")){this.execCommand("inserthtml","<br>");I.stopEvent(L);}}}if(this.browser.webkit){if(!this.browser.webkit3){if(L.keyCode&&(L.keyCode==122)&&(L.metaKey)){if(this._hasParent(this._getSelectedElement(),"li")){A.log("We are in an LI and we found CMD + z, stopping the event","warn","SimpleEditor");I.stopEvent(L);}}}this._listFix(L);}this._fixListDupIds();this.fireEvent("editorKeyPress",{type:"editorKeyPress",target:this,ev:L});},_handleKeyDown:function(c){var e=this.fireEvent("beforeEditorKeyDown",{type:"beforeEditorKeyDown",target:this,ev:c});if(e===false){return false;}var Z=null,J=null;if(this._isNonEditable(c)){return false;}this._setCurrentEvent(c);if(this.currentWindow){this.closeWindow();}if(this.currentWindow){this.closeWindow();}var S=false,X=null,U=null,W=false;switch(c.keyCode){case this._keyMap.FOCUS_TOOLBAR.key:if(this._checkKey(this._keyMap.FOCUS_TOOLBAR,c)){var b=this.toolbar.getElementsByTagName("h2")[0];if(b&&b.firstChild){b.firstChild.focus();}}else{if(this._checkKey(this._keyMap.FOCUS_AFTER,c)){this.afterElement.focus();}}I.stopEvent(c);S=false;break;case this._keyMap.CREATE_LINK.key:if(this._hasSelection()){if(this._checkKey(this._keyMap.CREATE_LINK,c)){var K=true;if(this.get("limitCommands")){if(!this.toolbar.getButtonByValue("createlink")){A.log("Toolbar Button for (createlink) was not found, skipping exec.","info","SimpleEditor");K=false;}}if(K){this.execCommand("createlink","");this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});S=false;}}}break;case this._keyMap.UNDO.key:case this._keyMap.REDO.key:if(this._checkKey(this._keyMap.REDO,c)){X="redo";S=true;}else{if(this._checkKey(this._keyMap.UNDO,c)){X="undo";S=true;}}break;case this._keyMap.BOLD.key:if(this._checkKey(this._keyMap.BOLD,c)){X="bold";S=true;}break;case this._keyMap.FONT_SIZE_UP.key:case this._keyMap.FONT_SIZE_DOWN.key:var P=false,Y=false;if(this._checkKey(this._keyMap.FONT_SIZE_UP,c)){P=true;}if(this._checkKey(this._keyMap.FONT_SIZE_DOWN,c)){Y=true;}if(P||Y){var M=this.toolbar.getButtonByValue("fontsize"),L=parseInt(M.get("label"),10),N=(L+1);if(Y){N=(L-1);}X="fontsize";U=N+"px";S=true;}break;case this._keyMap.ITALIC.key:if(this._checkKey(this._keyMap.ITALIC,c)){X="italic";S=true;}break;case this._keyMap.UNDERLINE.key:if(this._checkKey(this._keyMap.UNDERLINE,c)){X="underline";S=true;}break;case 9:if(this.browser.ie){J=this._getRange();Z=this._getSelectedElement();if(!this._isElement(Z,"li")){if(J){J.pasteHTML("&nbsp;&nbsp;&nbsp;&nbsp;");J.collapse(false);J.select();}I.stopEvent(c);}}if(this.browser.gecko>1.8){Z=this._getSelectedElement();if(this._isElement(Z,"li")){if(c.shiftKey){this._getDoc().execCommand("outdent",null,"");}else{this._getDoc().execCommand("indent",null,"");}}else{if(!this._hasSelection()){this.execCommand("inserthtml","&nbsp;&nbsp;&nbsp;&nbsp;");}}I.stopEvent(c);}break;case 13:var R=null,a=0;if(this.get("ptags")&&!c.shiftKey){if(this.browser.gecko){Z=this._getSelectedElement();if(!this._hasParent(Z,"li")){if(this._hasParent(Z,"p")){R=this._getDoc().createElement("p");R.innerHTML="&nbsp;";F.insertAfter(R,Z);this._selectNode(R.firstChild);}else{if(this._isElement(Z,"body")){this.execCommand("insertparagraph",null);var T=this._getDoc().body.getElementsByTagName("p");for(a=0;a<T.length;a++){if(T[a].getAttribute("_moz_dirty")!==null){R=this._getDoc().createElement("p");R.innerHTML="&nbsp;";F.insertAfter(R,T[a]);this._selectNode(R.firstChild);T[a].removeAttribute("_moz_dirty");}}}else{A.log("Something went wrong with paragraphs, please file a bug!!","error","SimpleEditor");S=true;X="insertparagraph";}}I.stopEvent(c);}}if(this.browser.webkit){Z=this._getSelectedElement();if(!this._hasParent(Z,"li")){this.execCommand("insertparagraph",null);var V=this._getDoc().body.getElementsByTagName("div");for(a=0;a<V.length;a++){if(!F.hasClass(V[a],"yui-wk-div")){F.addClass(V[a],"yui-wk-p");}}I.stopEvent(c);}}}else{if(this.browser.webkit){Z=this._getSelectedElement();if(!this._hasParent(Z,"li")){if(this.browser.webkit4){this.execCommand("insertlinebreak");}else{this.execCommand("inserthtml",'<var id="yui-br"></var>');var Q=this._getDoc().getElementById("yui-br"),d=this._getDoc().createElement("br"),O=this._getDoc().createElement("span");Q.parentNode.replaceChild(d,Q);O.className="yui-non";O.innerHTML="&nbsp;";F.insertAfter(O,d);this._selectNode(O);}I.stopEvent(c);
}}if(this.browser.ie){A.log("Stopping P tags","info","SimpleEditor");J=this._getRange();Z=this._getSelectedElement();if(!this._isElement(Z,"li")){if(J){J.pasteHTML("<br>");J.collapse(false);J.select();}I.stopEvent(c);}}}break;}if(this.browser.ie){this._listFix(c);}if(S&&X){this.execCommand(X,U);I.stopEvent(c);this.nodeChange();}this.fireEvent("editorKeyDown",{type:"editorKeyDown",target:this,ev:c});},_fixListRunning:null,_fixListDupIds:function(){if(this._fixListRunning){return false;}if(this._getDoc()){this._fixListRunning=true;var J=this._getDoc().body.getElementsByTagName("li"),K=0,L={};for(K=0;K<J.length;K++){if(J[K].id){if(L[J[K].id]){J[K].id="";}L[J[K].id]=true;}}this._fixListRunning=false;}},_listFix:function(P){var R=null,N=null,J=false,L=null;if(this.browser.webkit){if(P.keyCode&&(P.keyCode==13)){if(this._hasParent(this._getSelectedElement(),"li")){var M=this._hasParent(this._getSelectedElement(),"li");if(M.previousSibling){if(M.firstChild&&(M.firstChild.length==1)){this._selectNode(M);}}}}}if(P.keyCode&&((!this.browser.webkit3&&(P.keyCode==25))||((this.browser.webkit3||!this.browser.webkit)&&((P.keyCode==9)&&P.shiftKey)))){R=this._getSelectedElement();if(this._hasParent(R,"li")){R=this._hasParent(R,"li");A.log("We have a SHIFT tab in an LI, reverse it..","info","SimpleEditor");if(this._hasParent(R,"ul")||this._hasParent(R,"ol")){A.log("We have a double parent, move up a level","info","SimpleEditor");N=this._hasParent(R,"ul");if(!N){N=this._hasParent(R,"ol");}if(this._isElement(N.previousSibling,"li")){N.removeChild(R);N.parentNode.insertBefore(R,N.nextSibling);if(this.browser.ie){L=this._getDoc().body.createTextRange();L.moveToElementText(R);L.collapse(false);L.select();}if(this.browser.webkit){this._selectNode(R.firstChild);}I.stopEvent(P);}}}}if(P.keyCode&&((P.keyCode==9)&&(!P.shiftKey))){A.log("List Fix - Tab","info","SimpleEditor");var K=this._getSelectedElement();if(this._hasParent(K,"li")){J=this._hasParent(K,"li").innerHTML;}if(this.browser.webkit){this._getDoc().execCommand("inserttext",false,"\t");}R=this._getSelectedElement();if(this._hasParent(R,"li")){A.log("We have a tab in an LI","info","SimpleEditor");N=this._hasParent(R,"li");A.log("parLI: "+N.tagName+" :: "+N.innerHTML);var O=this._getDoc().createElement(N.parentNode.tagName.toLowerCase());if(this.browser.webkit){var Q=F.getElementsByClassName("Apple-tab-span","span",N);if(Q[0]){N.removeChild(Q[0]);N.innerHTML=H.trim(N.innerHTML);if(J){N.innerHTML='<span class="yui-non">'+J+"</span>&nbsp;";}else{N.innerHTML='<span class="yui-non">&nbsp;</span>&nbsp;';}}}else{if(J){N.innerHTML=J+"&nbsp;";}else{N.innerHTML="&nbsp;";}}N.parentNode.replaceChild(O,N);O.appendChild(N);if(this.browser.webkit){this._getSelection().setBaseAndExtent(N.firstChild,1,N.firstChild,N.firstChild.innerText.length);if(!this.browser.webkit3){N.parentNode.parentNode.style.display="list-item";setTimeout(function(){N.parentNode.parentNode.style.display="block";},1);}}else{if(this.browser.ie){L=this._getDoc().body.createTextRange();L.moveToElementText(N);L.collapse(false);L.select();}else{this._selectNode(N);}}I.stopEvent(P);}if(this.browser.webkit){I.stopEvent(P);}this.nodeChange();}},nodeChange:function(J){var K=this;this._storeUndo();if(this.get("nodeChangeDelay")){this._nodeChangeDelayTimer=window.setTimeout(function(){K._nodeChangeDelayTimer=null;K._nodeChange.apply(K,arguments);},0);}else{this._nodeChange();}},_nodeChange:function(K){var M=parseInt(this.get("nodeChangeThreshold"),10),T=Math.round(new Date().getTime()/1000),W=this;if(K===true){this._lastNodeChange=0;}if((this._lastNodeChange+M)<T){if(this._fixNodesTimer===null){this._fixNodesTimer=window.setTimeout(function(){W._fixNodes.call(W);W._fixNodesTimer=null;},0);}}this._lastNodeChange=T;if(this.currentEvent){try{this._lastNodeChangeEvent=this.currentEvent.type;}catch(h){}}var g=this.fire("beforeNodeChange",{type:"beforeNodeChange"});if(g===false){return false;}if(this.get("dompath")){C.later(0,this,this._writeDomPath);}if(!this.get("disabled")){if(this.STOP_NODE_CHANGE){this.STOP_NODE_CHANGE=false;return false;}else{var Y=this._getSelection(),V=this._getRange(),J=this._getSelectedElement(),R=this.toolbar.getButtonByValue("fontname"),Q=this.toolbar.getButtonByValue("fontsize"),O=this.toolbar.getButtonByValue("undo"),L=this.toolbar.getButtonByValue("redo");var S={};if(this._lastButton){S[this._lastButton.id]=true;}if(!this._isElement(J,"body")){if(R){S[R.get("id")]=true;}if(Q){S[Q.get("id")]=true;}}if(L){delete S[L.get("id")];}this.toolbar.resetAllButtons(S);for(var k=0;k<this._disabled.length;k++){var U=this.toolbar.getButtonByValue(this._disabled[k]);if(U&&U.get){if(this._lastButton&&(U.get("id")===this._lastButton.id)){}else{if(!this._hasSelection()&&!this.get("insert")){switch(this._disabled[k]){case"fontname":case"fontsize":break;default:this.toolbar.disableButton(U);}}else{if(!this._alwaysDisabled[this._disabled[k]]){this.toolbar.enableButton(U);}}if(!this._alwaysEnabled[this._disabled[k]]){this.toolbar.deselectButton(U);}}}}var X=this._getDomPath();var l=null,b=null;for(var c=0;c<X.length;c++){l=X[c].tagName.toLowerCase();if(X[c].getAttribute("tag")){l=X[c].getAttribute("tag").toLowerCase();}b=this._tag2cmd[l];if(b===undefined){b=[];}if(!H.isArray(b)){b=[b];}if(X[c].style.fontWeight.toLowerCase()=="bold"){b[b.length]="bold";}if(X[c].style.fontStyle.toLowerCase()=="italic"){b[b.length]="italic";}if(X[c].style.textDecoration.toLowerCase()=="underline"){b[b.length]="underline";}if(X[c].style.textDecoration.toLowerCase()=="line-through"){b[b.length]="strikethrough";}if(b.length>0){for(var a=0;a<b.length;a++){this.toolbar.selectButton(b[a]);this.toolbar.enableButton(b[a]);}}switch(X[c].style.textAlign.toLowerCase()){case"left":case"right":case"center":case"justify":var Z=X[c].style.textAlign.toLowerCase();if(X[c].style.textAlign.toLowerCase()=="justify"){Z="full";}this.toolbar.selectButton("justify"+Z);this.toolbar.enableButton("justify"+Z);break;}}if(R){var f=R._conf.data.initValue.label;
R.set("label",'<span class="yui-toolbar-fontname-'+this._cleanClassName(f)+'">'+f+"</span>");this._updateMenuChecked("fontname",f);}if(Q){Q.set("label",Q._conf.data.initValue.label);}var P=this.toolbar.getButtonByValue("heading");if(P){P.set("label",P._conf.data.initValue.label);this._updateMenuChecked("heading","none");}var N=this.toolbar.getButtonByValue("insertimage");if(N&&this.currentWindow&&(this.currentWindow.name=="insertimage")){this.toolbar.disableButton(N);}if(this._lastButton&&this._lastButton.isSelected){this.toolbar.deselectButton(this._lastButton.id);}this._undoNodeChange();}}this.fire("afterNodeChange",{type:"afterNodeChange"});},_updateMenuChecked:function(J,K,M){if(!M){M=this.toolbar;}var L=M.getButtonByValue(J);L.checkValue(K);},_handleToolbarClick:function(K){var M="";var N="";var L=K.button.value;if(K.button.menucmd){M=L;L=K.button.menucmd;}this._lastButton=K.button;if(this.STOP_EXEC_COMMAND){A.log("execCommand skipped because we found the STOP_EXEC_COMMAND flag set to true","warn","SimpleEditor");A.log("NOEXEC::execCommand::("+L+"), ("+M+")","warn","SimpleEditor");this.STOP_EXEC_COMMAND=false;return false;}else{this.execCommand(L,M);if(!this.browser.webkit){var J=this;setTimeout(function(){J.focus.call(J);},5);}}I.stopEvent(K);},_setupAfterElement:function(){if(!this.beforeElement){this.beforeElement=C.Node.create('<h2 class="yui-editor-skipheader" tabIndex="-1"></h2>');this.beforeElement.set("innerHTML",this.STR_BEFORE_EDITOR);this.get("element_cont").query(".first-child").insertBefore(this.beforeElement,this.toolbar.get("node").get("nextSibling"));}if(!this.afterElement){this.afterElement=C.Node.create('<h2 class="yui-editor-skipheader" tabIndex="-1">'+this.STR_LEAVE_EDITOR+"</h2>");this.get("element_cont").get("firstChild").appendChild(this.afterElement);}},_disableEditor:function(N){var M,L,K,J;if(!this.get("disabled_iframe")&&N){M=this._createIframe();M.set("id","disabled_"+this.get("iframe").get("id"));M.setStyle("height","100%");M.setStyle("display","none");M.setStyle("visibility","visible");this.set("disabled_iframe",M);L=this.get("iframe").get("parentNode");L.appendChild(M);}if(!M){M=this.get("disabled_iframe");}if(N){this._orgIframe=this.get("iframe");if(this.toolbar){this.toolbar.set("disabled",true);}K=this.getEditorHTML();J=this.get("iframe").get("offsetHeight");M.setStyle("visibility","");M.setStyle("position","");M.setStyle("top","");M.setStyle("left","");this._orgIframe.setStyle("visibility","hidden");this._orgIframe.setStyle("position","absolute");this._orgIframe.setStyle("top","-99999px");this._orgIframe.setStyle("left","-99999px");this.set("iframe",M);this._setInitialContent(true);if(!this._mask){this._mask=C.Node.create('<div class="yui-editor-masked"></div>');if(this.browser.ie){this._mask.setStyle("height",J+"px");}this.get("iframe").get("parentNode").appendChild(this._mask);}this.on("editorContentReloaded",function(){this._getDoc().body._rteLoaded=false;this.setEditorHTML(K);M.setStyle("display","block");});}else{if(this._mask){this._mask.get("parentNode").removeChild(this._mask);this._mask=null;if(this.toolbar){this.toolbar.set("disabled",false);}M.setStyle("visibility","hidden");M.setStyle("position","absolute");M.setStyle("top","-99999px");M.setStyle("left","-99999px");this._orgIframe.setStyle("visibility","");this._orgIframe.setStyle("position","");this._orgIframe.setStyle("top","");this._orgIframe.setStyle("left","");this.set("iframe",this._orgIframe);this.focus();C.later(100,this,this.nodeChange);}}},SEP_DOMPATH:"<",STR_LEAVE_EDITOR:"You have left the Rich Text Editor.",STR_BEFORE_EDITOR:"This text field can contain stylized text and graphics. To cycle through all formatting options, use the keyboard shortcut Shift + Escape to place focus on the toolbar and navigate between options with your arrow keys. To exit this text editor use the Escape key and continue tabbing. <h4>Common formatting keyboard shortcuts:</h4><ul><li>Control Shift B sets text to bold</li> <li>Control Shift I sets text to italic</li> <li>Control Shift U underlines text</li> <li>Control Shift L adds an HTML link</li></ul>",STR_TITLE:"Rich Text Area.",STR_IMAGE_HERE:"Image URL Here",STR_IMAGE_URL:"Image URL",STR_LINK_URL:"Link URL",STOP_EXEC_COMMAND:false,STOP_NODE_CHANGE:false,CLASS_NOEDIT:"yui-noedit",CLASS_CONTAINER:"yui-editor-container",CLASS_EDITABLE:"yui-editor-editable",CLASS_EDITABLE_CONT:"yui-editor-editable-container",CLASS_PREFIX:"yui-editor",browser:function(){var J=C.UA;if(J.webkit>=420){J.webkit3=J.webkit;}else{J.webkit3=0;}if(J.webkit>=530){J.webkit4=J.webkit;}else{J.webkit4=0;}J.mac=false;if(navigator.userAgent.indexOf("Macintosh")!==-1){J.mac=true;}return J;}(),initializer:function(){if(!this._defaultToolbar){this._defaultToolbar={collapse:true,titlebar:"Text Editing Tools",draggable:false,buttons:[{group:"fontstyle",label:"Font Name and Size",buttons:[{type:"select",label:"Arial",value:"fontname",disabled:true,menu:[{text:"Arial",checked:true},{text:"Arial Black"},{text:"Comic Sans MS"},{text:"Courier New"},{text:"Lucida Console"},{text:"Tahoma"},{text:"Times New Roman"},{text:"Trebuchet MS"},{text:"Verdana"}]},{type:"spin",label:"13",value:"fontsize",range:[9,75],disabled:true}]},{type:"separator"},{group:"textstyle",label:"Font Style",buttons:[{type:"push",label:"Bold CTRL + SHIFT + B",value:"bold"},{type:"push",label:"Italic CTRL + SHIFT + I",value:"italic"},{type:"push",label:"Underline CTRL + SHIFT + U",value:"underline"},{type:"push",label:"Strike Through",value:"strikethrough"},{type:"separator"},{type:"color",label:"Font Color",value:"forecolor",disabled:true},{type:"color",label:"Background Color",value:"backcolor",disabled:true}]},{type:"separator"},{group:"indentlist",label:"Lists",buttons:[{type:"push",label:"Create an Unordered List",value:"insertunorderedlist"},{type:"push",label:"Create an Ordered List",value:"insertorderedlist"}]},{type:"separator"},{group:"insertitem",label:"Insert Item",buttons:[{type:"push",label:"HTML Link CTRL + SHIFT + L",value:"createlink",disabled:true},{type:"push",label:"Insert Image",value:"insertimage"}]}]};
}C.Editor.Info._instances[this.get("node").get("id")]=this;this.currentElement=[];this._handleDOMPath();this.on("dompathChange",C.bind(this._handleDOMPath,this));this.set("blankimage",this._getBlankImage());this._handleInsert();this.set("saveEl",this.get("node"));this._handleSubmit();this.on("handleSubmitChange",C.bind(this._handleSubmit,this));if(this.get("focusAtStart")){this.on("editorContentLoaded",function(){C.later(400,this,function(){this.focus();this.editorDirty=false;});});}},_getBlankImage:function(){var J="";if(!this._blankImageLoaded){if(C.Editor.Info.blankImage){this.set("blankimage",C.Editor.Info.blankImage);this._blankImageLoaded=true;}else{var K=document.createElement("div");K.style.position="absolute";K.style.top="-9999px";K.style.left="-9999px";K.className=this.CLASS_PREFIX+"-blankimage";document.body.appendChild(K);J=F.getStyle(K,"backgroundImage");J=J.replace("url(","").replace(")","").replace(/"/g,"");J=J.replace("app:/","");this.set("blankimage",J);this._blankImageLoaded=true;K.parentNode.removeChild(K);C.Editor.Info.blankImage=J;}}else{J=this.get("blankimage");}return J;},_handleAutoHeight:function(){var O=this._getDoc(),K=O.body,P=O.documentElement;var J=parseInt(F.getStyle(this.get("editor_wrapper"),"height"),10);var L=K.scrollHeight;if(this.browser.webkit){L=P.scrollHeight;}if(L<parseInt(this.get("height"),10)){L=parseInt(this.get("height"),10);}if((J!=L)&&(L>=parseInt(this.get("height"),10))){var N=this.get("animate");this.set("animate",false);this.set("height",L+"px");this.set("animate",N);if(this.browser.ie){this.get("iframe").setStyle("height","99%");this.get("iframe").setStyle("zoom","1");var M=this;window.setTimeout(function(){M.get("iframe").setStyle("height","100%");},1);}}},_formButtons:null,_formButtonClicked:null,_handleFormButtonClick:function(K){var J=I.getTarget(K);this._formButtonClicked=J;},_handleFormSubmit:function(L){this.saveHTML();var K=this.get("node").get("form"),J=this._formButtonClicked||false;K.detach("submit",C.bind(this._handleFormSubmit,this));},_handleFontSize:function(L){var J=this.toolbar.getButtonById(L.button.id);var K=J.get("label")+"px";this.execCommand("fontsize",K);return false;},_handleColorPicker:function(L){var K=L.button;var J="#"+L.color;if((K=="forecolor")||(K=="backcolor")){this.execCommand(K,J);}},_handleAlign:function(M){var L=null;for(var J=0;J<M.button.menu.length;J++){if(M.button.menu[J].value==M.button.value){L=M.button.menu[J].value;}}var K=this._getSelection();this.execCommand(L,K);return false;},_handleAfterNodeChange:function(){var T=this._getDomPath(),P=null,M=null,Q=null,K=false,N=this.toolbar.getButtonByValue("fontname"),O=this.toolbar.getButtonByValue("fontsize"),J=this.toolbar.getButtonByValue("heading");for(var L=0;L<T.length;L++){P=T[L];var S=P.tagName.toLowerCase();if(P.getAttribute("tag")){S=P.getAttribute("tag");}M=P.getAttribute("face");if(F.getStyle(P,"fontFamily")){M=F.getStyle(P,"fontFamily");M=M.replace(/'/g,"");}if(S.substring(0,1)=="h"){if(J){}}}if(N){if(!K){M=N._conf.data.initValue.label;}var R='<span class="yui-toolbar-fontname-'+this._cleanClassName(M)+'">'+M+"</span>";if(N.get("label")!=R){N.set("label",R);this._updateMenuChecked("fontname",M);}}if(O){Q=parseInt(F.getStyle(P,"fontSize"),10);if((Q===null)||isNaN(Q)){Q=O._conf.data.initValue.label;}O.set("label",""+Q);}if(!this._isElement(P,"body")&&!this._isElement(P,"img")){this.toolbar.enableButton(N);this.toolbar.enableButton(O);this.toolbar.enableButton("forecolor");this.toolbar.enableButton("backcolor");}if(this._isElement(P,"img")){if(C.Overlay){this.toolbar.enableButton("createlink");}}if(this._hasParent(P,"blockquote")){this.toolbar.selectButton("indent");this.toolbar.disableButton("indent");this.toolbar.enableButton("outdent");}if(this._hasParent(P,"ol")||this._hasParent(P,"ul")){this.toolbar.disableButton("indent");}this._lastButton=null;},_handleInsertImageClick:function(){if(this.get("limitCommands")){if(!this.toolbar.getButtonByValue("insertimage")){A.log("Toolbar Button for (insertimage) was not found, skipping exec.","info","SimpleEditor");return false;}}this.toolbar.set("disabled",true);var J=function(){var K=this.currentElement[0],M="http://";if(!K){K=this._getSelectedElement();}if(K){if(K.getAttribute("src")){M=K.getAttribute("src",2);if(M.indexOf(this.get("blankimage"))!=-1){M=this.STR_IMAGE_HERE;}}}var L=prompt(this.STR_IMAGE_URL+": ",M);if((L!=="")&&(L!==null)){K.setAttribute("src",L);}else{if(L===""){K.parentNode.removeChild(K);this.currentElement=[];this.nodeChange();}else{if((L===null)){M=K.getAttribute("src",2);if(M.indexOf(this.get("blankimage"))!=-1){K.parentNode.removeChild(K);this.currentElement=[];this.nodeChange();}}}}this.closeWindow();this.toolbar.set("disabled",false);this.unsubscribe("afterExecCommand",J,this,true);};this.on("afterExecCommand",J,this,true);},_handleInsertImageWindowClose:function(){this.nodeChange();},_isLocalFile:function(J){if((J)&&(J!=="")&&((J.indexOf("file:/")!=-1)||(J.indexOf(":\\")!=-1))){return true;}return false;},_handleCreateLinkClick:function(){if(this.get("limitCommands")){if(!this.toolbar.getButtonByValue("createlink")){A.log("Toolbar Button for (createlink) was not found, skipping exec.","info","SimpleEditor");return false;}}this.toolbar.set("disabled",true);var J=function(){var M=this.currentElement[0],L="";if(M){if(M.getAttribute("href",2)!==null){L=M.getAttribute("href",2);}}var O=prompt(this.STR_LINK_URL+": ",L);if((O!=="")&&(O!==null)){var N=O;if((N.indexOf(":/"+"/")==-1)&&(N.substring(0,1)!="/")&&(N.substring(0,6).toLowerCase()!="mailto")){if((N.indexOf("@")!=-1)&&(N.substring(0,6).toLowerCase()!="mailto")){N="mailto:"+N;}else{if(N.substring(0,1)!="#"){}}}M.setAttribute("href",N);}else{if(O!==null){var K=this._getDoc().createElement("span");K.innerHTML=M.innerHTML;F.addClass(K,"yui-non");M.parentNode.replaceChild(K,M);}}this.closeWindow();this.toolbar.set("disabled",false);this.unsubscribe("afterExecCommand",J,this,true);};this.on("afterExecCommand",J,this);},_handleCreateLinkWindowClose:function(){this.nodeChange();
this.currentElement=[];},render:function(){if(this._rendered){return false;}A.log("Render","info","SimpleEditor");if(this.get("node")){this._textarea=true;if(this.get("node").get("tagName").toLowerCase()!=="textarea"){this._textarea=false;}}else{A.log("No Element","error","SimpleEditor");return false;}this._rendered=true;C.later(4,this,this._render);},_render:function(){A.log("_render");this.set("textarea",this.get("node"));this.get("element_cont").setStyle("display","none");this.get("element_cont").addClass(this.CLASS_CONTAINER);this.set("iframe",this._createIframe());C.later(10,this,this._setInitialContent,false);this.get("editor_wrapper").appendChild(this.get("iframe"));if(this.get("disabled")){this._disableEditor(true);}var J=this.get("toolbar");if(!J){J=this._defaultToolbar;}if(J instanceof C.Toolbar.Bar){this.toolbar=J;this.toolbar.set("disabled",true);}else{J.node=this.get("toolbar_cont");J.disabled=true;this.toolbar=new C.Toolbar.Bar(J);}A.log("fireEvent::toolbarLoaded","info","SimpleEditor");this.fire("toolbarLoaded",{type:"toolbarLoaded"});this.toolbar.on("toolbarCollapsed",function(){if(this.currentWindow){this.moveWindow();}},this,true);this.toolbar.on("toolbarExpanded",function(){if(this.currentWindow){this.moveWindow();}},this,true);this.toolbar.on("fontsizeClick",this._handleFontSize,this,true);this.toolbar.on("colorPickerClicked",function(K){this._handleColorPicker(K);this.STOP_EXEC_COMMAND=true;},this,true);this.toolbar.on("alignClick",this._handleAlign,this,true);this.on("afterNodeChange",this._handleAfterNodeChange,this,true);this.toolbar.on("insertimageClick",this._handleInsertImageClick,this,true);this.on("windowinsertimageClose",this._handleInsertImageWindowClose,this,true);this.toolbar.on("createlinkClick",this._handleCreateLinkClick,this,true);this.on("windowcreatelinkClose",this._handleCreateLinkWindowClose,this,true);this.get("node").get("parentNode").replaceChild(this.get("element_cont"),this.get("node"));this.get("node").setStyle("visibility","hidden");this.get("node").setStyle("position","absolute");this.get("node").setStyle("top","-9999px");this.get("node").setStyle("left","-9999px");this.get("element_cont").appendChild(this.get("node"));this.get("element_cont").setStyle("display","block");this.get("iframe").get("parentNode").addClass(this.CLASS_EDITABLE_CONT);this.get("iframe").addClass(this.CLASS_EDITABLE);this.get("element_cont").setStyle("width",this.get("width"));this.get("iframe").get("parentNode").setStyle("height",this.get("height"));this.get("iframe").setStyle("width","100%");this.get("iframe").setStyle("height","100%");C.later(0,this,this._setupAfterElement);this.fire("afterRender",{type:"afterRender"});},execCommand:function(L,K){var O=this.fireEvent("beforeExecCommand",{type:"beforeExecCommand",target:this,args:arguments});if((O===false)||(this.STOP_EXEC_COMMAND)){this.STOP_EXEC_COMMAND=false;return false;}this._lastCommand=L;this._setMarkupType(L);if(this.browser.ie){this._getWindow().focus();}var J=true;if(this.get("limitCommands")){if(!this.toolbar.getButtonByValue(L)){A.log("Toolbar Button for ("+L+") was not found, skipping exec.","info","SimpleEditor");J=false;}}this.editorDirty=true;if((typeof this["cmd_"+L.toLowerCase()]=="function")&&J){A.log("Found execCommand override method: (cmd_"+L.toLowerCase()+")","info","SimpleEditor");var N=this["cmd_"+L.toLowerCase()](K);J=N[0];if(N[1]){L=N[1];}if(N[2]){K=N[2];}}if(J){A.log("execCommand::("+L+"), ("+K+")","info","SimpleEditor");try{this._getDoc().execCommand(L,false,K);}catch(M){A.log("execCommand Failed","error","SimpleEditor");}}else{A.log("OVERRIDE::execCommand::("+L+"),("+K+") skipped","warn","SimpleEditor");}this.on("afterExecCommand",function(){this.unsubscribeAll("afterExecCommand");this.nodeChange();},this,true);this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});},cmd_bold:function(M){if(!this.browser.webkit){var L=this._getSelectedElement();if(L&&this._isElement(L,"span")&&this._hasSelection()){if(L.style.fontWeight=="bold"){L.style.fontWeight="";var J=this._getDoc().createElement("b"),K=L.parentNode;K.replaceChild(J,L);J.appendChild(L);}}}return[true];},cmd_italic:function(M){if(!this.browser.webkit){var L=this._getSelectedElement();if(L&&this._isElement(L,"span")&&this._hasSelection()){if(L.style.fontStyle=="italic"){L.style.fontStyle="";var J=this._getDoc().createElement("i"),K=L.parentNode;K.replaceChild(J,L);J.appendChild(L);}}}return[true];},cmd_underline:function(K){if(!this.browser.webkit){var J=this._getSelectedElement();if(J&&this._isElement(J,"span")){if(J.style.textDecoration=="underline"){J.style.textDecoration="none";}else{J.style.textDecoration="underline";}return[false];}}return[true];},cmd_backcolor:function(M){var J=true,K=this._getSelectedElement(),L="backcolor";if(this.browser.gecko||this.browser.opera){this._setEditorStyle(true);L="hilitecolor";}if(!this._isElement(K,"body")&&!this._hasSelection()){K.style.backgroundColor=M;this._selectNode(K);J=false;}else{if(this.get("insert")){K=this._createInsertElement({backgroundColor:M});}else{this._createCurrentElement("span",{backgroundColor:M,color:K.style.color,fontSize:K.style.fontSize,fontFamily:K.style.fontFamily});this._selectNode(this.currentElement[0]);}J=false;}return[J,L];},cmd_forecolor:function(L){var J=true,K=this._getSelectedElement();if(!this._isElement(K,"body")&&!this._hasSelection()){F.setStyle(K,"color",L);this._selectNode(K);J=false;}else{if(this.get("insert")){K=this._createInsertElement({color:L});}else{this._createCurrentElement("span",{color:L,fontSize:K.style.fontSize,fontFamily:K.style.fontFamily,backgroundColor:K.style.backgroundColor});this._selectNode(this.currentElement[0]);}J=false;}return[J];},cmd_unlink:function(J){this._swapEl(this.currentElement[0],"span",function(K){K.className="yui-non";});return[false];},cmd_createlink:function(L){var K=this._getSelectedElement(),J=null;if(this._hasParent(K,"a")){this.currentElement[0]=this._hasParent(K,"a");}else{if(this._isElement(K,"li")){J=this._getDoc().createElement("a");
J.innerHTML=K.innerHTML;K.innerHTML="";K.appendChild(J);this.currentElement[0]=J;}else{if(!this._isElement(K,"a")){this._createCurrentElement("a");J=this._swapEl(this.currentElement[0],"a");this.currentElement[0]=J;}else{this.currentElement[0]=K;}}}return[false];},cmd_insertimage:function(O){var J=true,K=null,N="insertimage",M=this._getSelectedElement();if(O===""){O=this.get("blankimage");}A.log("InsertImage: "+M.tagName,"info","SimpleEditor");if(this._isElement(M,"img")){this.currentElement[0]=M;J=false;}else{if(this._getDoc().queryCommandEnabled(N)){this._getDoc().execCommand(N,false,O);var P=this._getDoc().getElementsByTagName("img");for(var L=0;L<P.length;L++){if(!F.hasClass(P[L],"yui-img")){F.addClass(P[L],"yui-img");this.currentElement[0]=P[L];}}J=false;}else{if(M==this._getDoc().body){K=this._getDoc().createElement("img");K.setAttribute("src",O);F.addClass(K,"yui-img");this._getDoc().body.appendChild(K);}else{this._createCurrentElement("img");K=this._getDoc().createElement("img");K.setAttribute("src",O);F.addClass(K,"yui-img");this.currentElement[0].parentNode.replaceChild(K,this.currentElement[0]);}this.currentElement[0]=K;J=false;}}return[J];},cmd_inserthtml:function(M){var J=true,L="inserthtml",K=null,N=null;if(this.browser.webkit&&!this._getDoc().queryCommandEnabled(L)){A.log("More Safari DOM tricks (inserthtml)","info","EditorSafari");this._createCurrentElement("img");K=this._getDoc().createElement("span");K.innerHTML=M;this.currentElement[0].parentNode.replaceChild(K,this.currentElement[0]);J=false;}else{if(this.browser.ie){N=this._getRange();if(N.item){N.item(0).outerHTML=M;}else{N.pasteHTML(M);}J=false;}}return[J];},cmd_list:function(g){var Y=true,c=null,R=0,L=null,X="",e=this._getSelectedElement(),Z="insertorderedlist";if(g=="ul"){Z="insertunorderedlist";}if(this.browser.webkit&&!this.browser.webkit4){if(this._isElement(e,"li")&&this._isElement(e.parentNode,g)){A.log("We already have a list, undo it","info","SimpleEditor");L=e.parentNode;c=this._getDoc().createElement("span");F.addClass(c,"yui-non");X="";var K=L.getElementsByTagName("li");for(R=0;R<K.length;R++){X+="<div>"+K[R].innerHTML+"</div>";}c.innerHTML=X;this.currentElement[0]=L;this.currentElement[0].parentNode.replaceChild(c,this.currentElement[0]);}else{A.log("Create list item","info","SimpleEditor");this._createCurrentElement(g.toLowerCase());c=this._getDoc().createElement(g);for(R=0;R<this.currentElement.length;R++){var O=this._getDoc().createElement("li");O.innerHTML=this.currentElement[R].innerHTML+'<span class="yui-non">&nbsp;</span>&nbsp;';c.appendChild(O);if(R>0){this.currentElement[R].parentNode.removeChild(this.currentElement[R]);}}var W=c.firstChild.innerHTML.split("<br>");if(W.length>0){c.innerHTML="";for(var b=0;b<W.length;b++){var d=this._getDoc().createElement("li");d.innerHTML=W[b];c.appendChild(d);}}this.currentElement[0].parentNode.replaceChild(c,this.currentElement[0]);this.currentElement[0]=c;var M=this.currentElement[0].firstChild;M=F.getElementsByClassName("yui-non","span",M)[0];this._getSelection().setBaseAndExtent(M,1,M,M.innerText.length);}Y=false;}else{L=this._getSelectedElement();A.log(L.tagName);if(this._isElement(L,"li")&&this._isElement(L.parentNode,g)||(this.browser.ie&&this._isElement(this._getRange().parentElement,"li"))||(this.browser.ie&&this._isElement(L,"ul"))||(this.browser.ie&&this._isElement(L,"ol"))){A.log("We already have a list, undo it","info","SimpleEditor");if(this.browser.ie){if((this.browser.ie&&this._isElement(L,"ul"))||(this.browser.ie&&this._isElement(L,"ol"))){L=L.getElementsByTagName("li")[0];}A.log("Undo IE","info","SimpleEditor");X="";var N=L.parentNode.getElementsByTagName("li");for(var a=0;a<N.length;a++){X+=N[a].innerHTML+"<br>";}var f=this._getDoc().createElement("span");f.innerHTML=X;L.parentNode.parentNode.replaceChild(f,L.parentNode);}else{this.nodeChange();this._getDoc().execCommand(Z,"",L.parentNode);this.nodeChange();}Y=false;}if(this.browser.opera){var V=this;window.setTimeout(function(){var h=V._getDoc().getElementsByTagName("li");for(var j=0;j<h.length;j++){if(h[j].innerHTML.toLowerCase()=="<br>"){h[j].parentNode.parentNode.removeChild(h[j].parentNode);}}},30);}if(this.browser.ie&&Y){var P="";if(this._getRange().html){P="<li>"+this._getRange().html+"</li>";}else{var Q=this._getRange().text.split("\n");if(Q.length>1){P="";for(var U=0;U<Q.length;U++){P+="<li>"+Q[U]+"</li>";}}else{var T=this._getRange().text;if(T===""){P='<li id="new_list_item">'+T+"</li>";}else{P="<li>"+T+"</li>";}}}this._getRange().pasteHTML("<"+g+">"+P+"</"+g+">");var J=this._getDoc().getElementById("new_list_item");if(J){var S=this._getDoc().body.createTextRange();S.moveToElementText(J);S.collapse(false);S.select();J.id="";}Y=false;}}return Y;},cmd_insertorderedlist:function(J){return[this.cmd_list("ol")];},cmd_insertunorderedlist:function(J){return[this.cmd_list("ul")];},cmd_fontname:function(M){var J=true,L=this._getSelectedElement();this.currentFont=M;if(L&&L.tagName&&!this._hasSelection()&&!this._isElement(L,"body")&&!this.get("insert")){F.setStyle(L,"fontFamily",M);J=false;}else{if(this.get("insert")&&!this._hasSelection()){A.log("No selection and no selected element and we are in insert mode","info","SimpleEditor");var K=this._createInsertElement({fontFamily:M});J=false;}}return[J];},cmd_fontsize:function(M){var J=null,L=true;J=this._getSelectedElement();if(this.browser.webkit){if(this.currentElement[0]){if(J==this.currentElement[0]){L=false;F.setStyle(J,"fontSize",M);this._selectNode(J);this.currentElement[0]=J;}}}if(L){if(!this._isElement(this._getSelectedElement(),"body")&&(!this._hasSelection())){J=this._getSelectedElement();F.setStyle(J,"fontSize",M);if(this.get("insert")&&this.browser.ie){var K=this._getRange();K.collapse(false);K.select();}else{this._selectNode(J);}}else{if(this.currentElement&&(this.currentElement.length>0)&&(!this._hasSelection())&&(!this.get("insert"))){F.setStyle(this.currentElement,"fontSize",M);}else{if(this.get("insert")&&!this._hasSelection()){J=this._createInsertElement({fontSize:M});
this.currentElement[0]=J;this._selectNode(this.currentElement[0]);}else{this._createCurrentElement("span",{"fontSize":M,fontFamily:J.style.fontFamily,color:J.style.color,backgroundColor:J.style.backgroundColor});this._selectNode(this.currentElement[0]);}}}}return[false];},_swapEl:function(K,J,M){var L=this._getDoc().createElement(J);if(K){L.innerHTML=K.innerHTML;}if(typeof M=="function"){M.call(this,L);}if(K){K.parentNode.replaceChild(L,K);}return L;},_createInsertElement:function(J){this._createCurrentElement("span",J);var K=this.currentElement[0];if(this.browser.webkit){K.innerHTML='<span class="yui-non">&nbsp;</span>';K=K.firstChild;this._getSelection().setBaseAndExtent(K,1,K,K.innerText.length);}else{if(this.browser.ie||this.browser.opera){K.innerHTML="&nbsp;";}}this.focus();this._selectNode(K,true);return K;},_createCurrentElement:function(L,O){L=((L)?L:"a");var W=null,K=[],M=this._getDoc();if(this.currentFont){if(!O){O={};}O.fontFamily=this.currentFont;this.currentFont=null;}this.currentElement=[];var R=function(b,d){var c=null;b=((b)?b:"span");b=b.toLowerCase();switch(b){case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":c=M.createElement(b);break;default:c=M.createElement(b);if(b==="span"){F.addClass(c,"yui-tag-"+b);F.addClass(c,"yui-tag");c.setAttribute("tag",b);}if(d){C.each(d,function(f,e){c.style[e]=f;});}break;}return c;};if(!this._hasSelection()){if(this._getDoc().queryCommandEnabled("insertimage")){this._getDoc().execCommand("insertimage",false,"yui-tmp-img");var Q=this._getDoc().getElementsByTagName("img");for(var V=0;V<Q.length;V++){if(Q[V].getAttribute("src",2)=="yui-tmp-img"){K=R(L,O);Q[V].parentNode.replaceChild(K,Q[V]);this.currentElement[this.currentElement.length]=K;}}}else{if(this.currentEvent){W=I.getTarget(this.currentEvent);}else{W=this._getDoc().body;}}if(W){K=R(L,O);if(this._isElement(W,"body")||this._isElement(W,"html")){if(this._isElement(W,"html")){W=this._getDoc().body;}W.appendChild(K);}else{if(W.nextSibling){W.parentNode.insertBefore(K,W.nextSibling);}else{W.parentNode.appendChild(K);}}this.currentElement[this.currentElement.length]=K;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(K,0,K,0);if(this.browser.webkit3){this._getSelection().collapseToStart();}else{this._getSelection().collapse(true);}}}}else{this._setEditorStyle(true);this._getDoc().execCommand("fontname",false,"yui-tmp");var J=[],U,a=["font","span","i","b","u","li"];if(!this._isElement(this._getSelectedElement(),"body")){a[a.length]=this._getDoc().getElementsByTagName(this._getSelectedElement().tagName);a[a.length]=this._getDoc().getElementsByTagName(this._getSelectedElement().parentNode.tagName);}for(var P=0;P<a.length;P++){var N=this._getDoc().getElementsByTagName(a[P]);for(var Z=0;Z<N.length;Z++){J[J.length]=N[Z];}}for(var X=0;X<J.length;X++){if((F.getStyle(J[X],"fontFamily")=="yui-tmp")||(J[X].face&&(J[X].face=="yui-tmp"))){if(L!=="span"){K=R(L,O);}else{K=R(J[X].tagName,O);}K.innerHTML=J[X].innerHTML;if(this._isElement(J[X],"ol")||(this._isElement(J[X],"ul"))){var S=J[X].getElementsByTagName("li")[0];J[X].style.fontFamily="inherit";S.style.fontFamily="inherit";K.innerHTML=S.innerHTML;S.innerHTML="";S.appendChild(K);this.currentElement[this.currentElement.length]=K;}else{if(this._isElement(J[X],"li")){J[X].innerHTML="";J[X].appendChild(K);J[X].style.fontFamily="inherit";this.currentElement[this.currentElement.length]=K;}else{if(J[X].parentNode){J[X].parentNode.replaceChild(K,J[X]);this.currentElement[this.currentElement.length]=K;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(K,0,K,0);if(this.browser.webkit3){this._getSelection().collapseToStart();}else{this._getSelection().collapse(true);}}if(this.browser.ie&&O&&O.fontSize){this._getSelection().empty();}if(this.browser.gecko){this._getSelection().collapseToStart();}}}}}}var Y=this.currentElement.length;for(var T=0;T<Y;T++){if((T+1)!=Y){if(this.currentElement[T]&&this.currentElement[T].nextSibling){if(this._isElement(this.currentElement[T],"br")){this.currentElement[this.currentElement.length]=this.currentElement[T].nextSibling;}}}}}},saveHTML:function(){var K=this.cleanHTML();if(this._textarea){this.get("node").set("value",K);}else{this.get("node").set("innerHTML",K);}if(this.get("saveEl")!==this.get("node")){var J=this.get("saveEl");if(J){if(J.get("tagName").toLowerCase()==="textarea"){J.set("value",K);}else{J.set("innerHTML",K);}}}return K;},setEditorHTML:function(K){var J=this._cleanIncomingHTML(K);J=J.replace(/RIGHT_BRACKET/gi,"{");J=J.replace(/LEFT_BRACKET/gi,"}");this._getDoc().body.innerHTML=J;this.nodeChange();},getEditorHTML:function(){try{var J=this._getDoc().body;if(J===null){A.log("Body is null, returning null.","error","SimpleEditor");return null;}return this._getDoc().body.innerHTML;}catch(K){return"";}},show:function(){if(this.browser.gecko){this._setDesignMode("on");this.focus();}if(this.browser.webkit){var J=this;window.setTimeout(function(){J._setInitialContent.call(J);},10);}if(this.currentWindow){this.closeWindow();}this.get("iframe").setStyle("position","static");this.get("iframe").setStyle("left","");},hide:function(){if(this.currentWindow){this.closeWindow();}if(this._fixNodesTimer){clearTimeout(this._fixNodesTimer);this._fixNodesTimer=null;}if(this._nodeChangeTimer){clearTimeout(this._nodeChangeTimer);this._nodeChangeTimer=null;}this._lastNodeChange=0;this.get("iframe").setStyle("position","absolute");this.get("iframe").setStyle("left","-9999px");},_cleanIncomingHTML:function(J){J=J.replace(/{/gi,"RIGHT_BRACKET");J=J.replace(/}/gi,"LEFT_BRACKET");J=J.replace(/<strong([^>]*)>/gi,"<b$1>");J=J.replace(/<\/strong>/gi,"</b>");J=J.replace(/<embed([^>]*)>/gi,"<YUI_EMBED$1>");J=J.replace(/<\/embed>/gi,"</YUI_EMBED>");J=J.replace(/<em([^>]*)>/gi,"<i$1>");J=J.replace(/<\/em>/gi,"</i>");J=J.replace(/_moz_dirty=""/gi,"");J=J.replace(/<YUI_EMBED([^>]*)>/gi,"<embed$1>");J=J.replace(/<\/YUI_EMBED>/gi,"</embed>");if(this.get("plainText")){A.log("Filtering as plain text","info","SimpleEditor");
J=J.replace(/\n/g,"<br>").replace(/\r/g,"<br>");J=J.replace(/  /gi,"&nbsp;&nbsp;");J=J.replace(/\t/gi,"&nbsp;&nbsp;&nbsp;&nbsp;");}J=J.replace(/<script([^>]*)>/gi,"<bad>");J=J.replace(/<\/script([^>]*)>/gi,"</bad>");J=J.replace(/&lt;script([^>]*)&gt;/gi,"<bad>");J=J.replace(/&lt;\/script([^>]*)&gt;/gi,"</bad>");J=J.replace(/\r\n/g,"<YUI_LF>").replace(/\n/g,"<YUI_LF>").replace(/\r/g,"<YUI_LF>");J=J.replace(new RegExp("<bad([^>]*)>(.*?)</bad>","gi"),"");J=J.replace(/<YUI_LF>/g,"\n");return J;},cleanHTML:function(M){if(!M){M=this.getEditorHTML();}var K=this.get("markup");M=this.pre_filter_linebreaks(M,K);M=this.filter_msword(M);M=M.replace(/<img([^>]*)\/>/gi,"<YUI_IMG$1>");M=M.replace(/<img([^>]*)>/gi,"<YUI_IMG$1>");M=M.replace(/<input([^>]*)\/>/gi,"<YUI_INPUT$1>");M=M.replace(/<input([^>]*)>/gi,"<YUI_INPUT$1>");M=M.replace(/<ul([^>]*)>/gi,"<YUI_UL$1>");M=M.replace(/<\/ul>/gi,"</YUI_UL>");M=M.replace(/<blockquote([^>]*)>/gi,"<YUI_BQ$1>");M=M.replace(/<\/blockquote>/gi,"</YUI_BQ>");M=M.replace(/<embed([^>]*)>/gi,"<YUI_EMBED$1>");M=M.replace(/<\/embed>/gi,"</YUI_EMBED>");if((K=="semantic")||(K=="xhtml")){M=M.replace(/<i(\s+[^>]*)?>/gi,"<em$1>");M=M.replace(/<\/i>/gi,"</em>");M=M.replace(/<b(\s+[^>]*)?>/gi,"<strong$1>");M=M.replace(/<\/b>/gi,"</strong>");}M=M.replace(/_moz_dirty=""/gi,"");M=M.replace(/<strike/gi,'<span style="text-decoration: line-through;"');M=M.replace(/\/strike>/gi,"/span>");if(this.browser.ie){M=M.replace(/text-decoration/gi,"text-decoration");M=M.replace(/font-weight/gi,"font-weight");M=M.replace(/_width="([^>]*)"/gi,"");M=M.replace(/_height="([^>]*)"/gi,"");var L=this._baseHREF.replace(/\//gi,"\\/"),N=new RegExp('src="'+L,"gi");M=M.replace(N,'src="');}M=M.replace(/<font/gi,"<font");M=M.replace(/<\/font>/gi,"</font>");M=M.replace(/<span/gi,"<span");M=M.replace(/<\/span>/gi,"</span>");if((K=="semantic")||(K=="xhtml")||(K=="css")){M=M.replace(new RegExp('<font([^>]*)face="([^>]*)">(.*?)</font>',"gi"),'<span $1 style="font-family: $2;">$3</span>');M=M.replace(/<u/gi,'<span style="text-decoration: underline;"');if(this.browser.webkit){M=M.replace(new RegExp('<span class="Apple-style-span" style="font-weight: bold;">([^>]*)</span>',"gi"),"<strong>$1</strong>");M=M.replace(new RegExp('<span class="Apple-style-span" style="font-style: italic;">([^>]*)</span>',"gi"),"<em>$1</em>");}M=M.replace(/\/u>/gi,"/span>");if(K=="css"){M=M.replace(/<em([^>]*)>/gi,"<i$1>");M=M.replace(/<\/em>/gi,"</i>");M=M.replace(/<strong([^>]*)>/gi,"<b$1>");M=M.replace(/<\/strong>/gi,"</b>");M=M.replace(/<b/gi,'<span style="font-weight: bold;"');M=M.replace(/\/b>/gi,"/span>");M=M.replace(/<i/gi,'<span style="font-style: italic;"');M=M.replace(/\/i>/gi,"/span>");}M=M.replace(/  /gi," ");}else{M=M.replace(/<u/gi,"<u");M=M.replace(/\/u>/gi,"/u>");}M=M.replace(/<ol([^>]*)>/gi,"<ol$1>");M=M.replace(/\/ol>/gi,"/ol>");M=M.replace(/<li/gi,"<li");M=M.replace(/\/li>/gi,"/li>");M=this.filter_safari(M);M=this.filter_internals(M);M=this.filter_all_rgb(M);M=this.post_filter_linebreaks(M,K);if(K=="xhtml"){M=M.replace(/<YUI_IMG([^>]*)>/g,"<img $1 />");M=M.replace(/<YUI_INPUT([^>]*)>/g,"<input $1 />");}else{M=M.replace(/<YUI_IMG([^>]*)>/g,"<img $1>");M=M.replace(/<YUI_INPUT([^>]*)>/g,"<input $1>");}M=M.replace(/<YUI_UL([^>]*)>/g,"<ul$1>");M=M.replace(/<\/YUI_UL>/g,"</ul>");M=this.filter_invalid_lists(M);M=M.replace(/<YUI_BQ([^>]*)>/g,"<blockquote$1>");M=M.replace(/<\/YUI_BQ>/g,"</blockquote>");M=M.replace(/<YUI_EMBED([^>]*)>/g,"<embed$1>");M=M.replace(/<\/YUI_EMBED>/g,"</embed>");M=M.replace(/ &amp; /gi," YUI_AMP ");M=M.replace(/ &amp;/gi," YUI_AMP_F ");M=M.replace(/&amp; /gi," YUI_AMP_R ");M=M.replace(/&amp;/gi,"&");M=M.replace(/ YUI_AMP /gi," &amp; ");M=M.replace(/ YUI_AMP_F /gi," &amp;");M=M.replace(/ YUI_AMP_R /gi,"&amp; ");M=A.lang.trim(M);if(this.get("removeLineBreaks")){M=M.replace(/\n/g,"").replace(/\r/g,"");M=M.replace(/  /gi," ");}for(var J in this.invalidHTML){if(A.lang.hasOwnProperty(this.invalidHTML,J)){if(H.isObject(J)&&J.keepContents){M=M.replace(new RegExp("<"+J+"([^>]*)>(.*?)</"+J+">","gi"),"$1");}else{M=M.replace(new RegExp("<"+J+"([^>]*)>(.*?)</"+J+">","gi"),"");}}}this.fireEvent("cleanHTML",{type:"cleanHTML",target:this,html:M});return M;},filter_msword:function(J){if(!this.get("filterWord")){return J;}J=J.replace(/<o:p>\s*<\/o:p>/g,"");J=J.replace(/<o:p>[\s\S]*?<\/o:p>/g,"&nbsp;");J=J.replace(/<w:[^>]*>[\s\S]*?<\/w:[^>]*>/gi,"");J=J.replace(/\s*mso-[^:]+:[^;"]+;?/gi,"");J=J.replace(/\s*MARGIN: 0cm 0cm 0pt\s*;/gi,"");J=J.replace(/\s*MARGIN: 0cm 0cm 0pt\s*"/gi,'"');J=J.replace(/\s*TEXT-INDENT: 0cm\s*;/gi,"");J=J.replace(/\s*TEXT-INDENT: 0cm\s*"/gi,'"');J=J.replace(/\s*PAGE-BREAK-BEFORE: [^\s;]+;?"/gi,'"');J=J.replace(/\s*FONT-VARIANT: [^\s;]+;?"/gi,'"');J=J.replace(/\s*tab-stops:[^;"]*;?/gi,"");J=J.replace(/\s*tab-stops:[^"]*/gi,"");J=J.replace(/<\\?\?xml[^>]*>/gi,"");J=J.replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"<$1$3");J=J.replace(/<(\w[^>]*) language=([^ |>]*)([^>]*)/gi,"<$1$3");J=J.replace(/<(\w[^>]*) onmouseover="([^\"]*)"([^>]*)/gi,"<$1$3");J=J.replace(/<(\w[^>]*) onmouseout="([^\"]*)"([^>]*)/gi,"<$1$3");return J;},filter_invalid_lists:function(J){J=J.replace(/<\/li>\n/gi,"</li>");J=J.replace(/<\/li><ol>/gi,"</li><li><ol>");J=J.replace(/<\/ol>/gi,"</ol></li>");J=J.replace(/<\/ol><\/li>\n/gi,"</ol>");J=J.replace(/<\/li><ul>/gi,"</li><li><ul>");J=J.replace(/<\/ul>/gi,"</ul></li>");J=J.replace(/<\/ul><\/li>\n?/gi,"</ul>");J=J.replace(/<\/li>/gi,"</li>");J=J.replace(/<\/ol>/gi,"</ol>");J=J.replace(/<ol>/gi,"<ol>");J=J.replace(/<ul>/gi,"<ul>");return J;},filter_safari:function(J){if(this.browser.webkit){J=J.replace(/<span class="Apple-tab-span" style="white-space:pre">([^>])<\/span>/gi,"&nbsp;&nbsp;&nbsp;&nbsp;");J=J.replace(/Apple-style-span/gi,"");J=J.replace(/style="line-height: normal;"/gi,"");J=J.replace(/yui-wk-div/gi,"");J=J.replace(/yui-wk-p/gi,"");J=J.replace(/<li><\/li>/gi,"");J=J.replace(/<li> <\/li>/gi,"");J=J.replace(/<li>  <\/li>/gi,"");if(this.get("ptags")){J=J.replace(/<div([^>]*)>/g,"<p$1>");
J=J.replace(/<\/div>/gi,"</p>");}else{J=J.replace(/<div([^>]*)>([ tnr]*)<\/div>/gi,"<br>");J=J.replace(/<\/div>/gi,"");}}return J;},filter_internals:function(J){J=J.replace(/\r/g,"");J=J.replace(/<\/?(body|head|html)[^>]*>/gi,"");J=J.replace(/<YUI_BR><\/li>/gi,"</li>");J=J.replace(/yui-tag-span/gi,"");J=J.replace(/yui-tag/gi,"");J=J.replace(/yui-non/gi,"");J=J.replace(/yui-img/gi,"");J=J.replace(/ tag="span"/gi,"");J=J.replace(/ class=""/gi,"");J=J.replace(/ style=""/gi,"");J=J.replace(/ class=" "/gi,"");J=J.replace(/ class="  "/gi,"");J=J.replace(/ target=""/gi,"");J=J.replace(/ title=""/gi,"");if(this.browser.ie){J=J.replace(/ class= /gi,"");J=J.replace(/ class= >/gi,"");}return J;},filter_all_rgb:function(N){var M=new RegExp("rgb\\s*?\\(\\s*?([0-9]+).*?,\\s*?([0-9]+).*?,\\s*?([0-9]+).*?\\)","gi");var J=N.match(M);if(H.isArray(J)){for(var L=0;L<J.length;L++){var K=this.filter_rgb(J[L]);N=N.replace(J[L].toString(),K);}}return N;},filter_rgb:function(L){if(L.toLowerCase().indexOf("rgb")!=-1){var O=new RegExp("(.*?)rgb\\s*?\\(\\s*?([0-9]+).*?,\\s*?([0-9]+).*?,\\s*?([0-9]+).*?\\)(.*?)","gi");var K=L.replace(O,"$1,$2,$3,$4,$5").split(",");if(K.length==5){var N=parseInt(K[1],10).toString(16);var M=parseInt(K[2],10).toString(16);var J=parseInt(K[3],10).toString(16);N=N.length==1?"0"+N:N;M=M.length==1?"0"+M:M;J=J.length==1?"0"+J:J;L="#"+N+M+J;}}return L;},pre_filter_linebreaks:function(K,J){if(this.browser.webkit){K=K.replace(/<br class="khtml-block-placeholder">/gi,"<YUI_BR>");K=K.replace(/<br class="webkit-block-placeholder">/gi,"<YUI_BR>");}K=K.replace(/<br>/gi,"<YUI_BR>");K=K.replace(/<br (.*?)>/gi,"<YUI_BR>");K=K.replace(/<br\/>/gi,"<YUI_BR>");K=K.replace(/<br \/>/gi,"<YUI_BR>");K=K.replace(/<div><YUI_BR><\/div>/gi,"<YUI_BR>");K=K.replace(/<p>(&nbsp;|&#160;)<\/p>/g,"<YUI_BR>");K=K.replace(/<p><br>&nbsp;<\/p>/gi,"<YUI_BR>");K=K.replace(/<p>&nbsp;<\/p>/gi,"<YUI_BR>");K=K.replace(/<YUI_BR>$/,"");K=K.replace(/<YUI_BR><\/p>/g,"</p>");if(this.browser.ie){K=K.replace(/&nbsp;&nbsp;&nbsp;&nbsp;/g,"\t");}return K;},post_filter_linebreaks:function(K,J){if(J=="xhtml"){K=K.replace(/<YUI_BR>/g,"<br />");}else{K=K.replace(/<YUI_BR>/g,"<br>");}return K;},clearEditorDoc:function(){this._getDoc().body.innerHTML="&nbsp;";},openWindow:function(J){},moveWindow:function(){},_closeWindow:function(){},closeWindow:function(){this.toolbar.resetAllButtons();this.focus();},destructor:function(){if(this._nodeChangeDelayTimer){clearTimeout(this._nodeChangeDelayTimer);}this.hide();A.log("Destroying Editor","warn","SimpleEditor");if(this.resize){A.log("Destroying Resize","warn","SimpleEditor");this.resize.destroy();}if(this.dd){A.log("Unreg DragDrop Instance","warn","SimpleEditor");this.dd.unreg();}if(this.get("panel")){A.log("Destroying Editor Panel","warn","SimpleEditor");this.get("panel").destroy();}this.saveHTML();this.toolbar.destroy();A.log("Restoring TextArea","info","SimpleEditor");this.setStyle("visibility","visible");this.setStyle("position","static");this.setStyle("top","");this.setStyle("left","");var J=this.get("element");this.get("element_cont").get("parentNode").replaceChild(J,this.get("element_cont").get("element"));this.get("element_cont").get("element").innerHTML="";this.set("handleSubmit",false);return true;},toString:function(){var J="SimpleEditor";return J;}});C.namespace("Editor");C.Editor.Simple=E;C.Editor.Info={_instances:{},blankImage:"",window:{},panel:null,getEditorById:function(J){if(!H.isString(J)){J=J.id;}if(this._instances[J]){return this._instances[J];}return false;},saveAll:function(L){var K,M,J=C.Editor.Info._instances;if(L){C.each(J,function(N,O){if(O.get("element").form&&(O.get("element").form==L)){O.saveHTML();}});}else{C.each(J,function(N){N.saveHTML();});}},toString:function(){var J=0;C.each(this._instances,function(){J++;});return"Editor Info ("+J+" registered intance"+((J>1)?"s":"")+")";}};},"gallery-2009.11.02-20",{requires:["node","gallery-port","substitute"]});