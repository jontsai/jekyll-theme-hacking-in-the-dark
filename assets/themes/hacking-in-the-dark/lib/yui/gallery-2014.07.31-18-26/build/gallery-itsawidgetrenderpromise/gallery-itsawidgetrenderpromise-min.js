YUI.add("gallery-itsawidgetrenderpromise",function(e,t){"use strict";var n=2e4,r="gallery-itsanodepromise";e.Widget.prototype.renderOnAvailable=function(e,t){var n=this;return n.renderOnAvailablePromise(e,{timeout:t}),n},e.Widget.prototype.renderWhenAvailable=function(e,t){var n=this;return n.renderWhenAvailablePromise(e,{timeout:t}),n},e.Widget.prototype.renderOnAvailablePromise=function(t,n){var i=this,s=n&&n.timeout,o=n&&n.promisetype,u=n&&n.stayalive;return u&&!i._autorender&&(i._autorender=function(){var s=i.get("boundingBox"),o=i.get("contentBox");i._noGarbageDestroy=!0,e.use(r,function(){e.Node.unavailablePromise(t).then(function(){var e=i._yuievt,r=e.events[i.constructor.NAME+":render"];r.fired=!1,i._set("rendered",!1),o&&(o.empty(),o.detachAll()),s.get("children").each(function(e){e!==o&&e.remove(!0)}),i.renderOnAvailablePromise(t,n)})})}),new e.Promise(function(n,a){t?e.use(r,function(){e.Node.availablePromise(t,s).then(function(){if(!!i.get("destroyed"))throw new Error("Widget cannot render: it is already destroyed");i.render(t)}).then(function(){return s=s||0,o==="afterrender"?i.renderPromise(s):o==="afterready"?i.readyPromise(s):!0}).then(function(){u&&i._autorender(),n()},a)}):(i.render(),u&&i._autorender(),n())})},e.Widget.prototype.renderWhenAvailablePromise=function(e,t){return t=t||{},t.stayalive=!0,this.renderOnAvailablePromise(e,t)},e.Widget.prototype.renderPromise=function(t){var r=this;return new e.Promise(function(i,s){r.after("render",i),r.get("rendered")&&i(),t!==0&&e.later(t||n,null,function(){var e="renderPromise is rejected by timeout of "+(t||n)+" ms";s(new Error(e))})})},e.Widget.prototype.promiseBeforeReady=function(){return new e.Promise(function(e){e()})},e.Widget.prototype.readyPromise=function(t){var n=this,r;return r=[],r.push(n.renderPromise(t)),r.push(n.promiseBeforeReady(t)),e.batch.apply(e,r)}},"gallery-2013.08.15-00-45",{requires:["yui-base","yui-later","widget-base","promise"]});
