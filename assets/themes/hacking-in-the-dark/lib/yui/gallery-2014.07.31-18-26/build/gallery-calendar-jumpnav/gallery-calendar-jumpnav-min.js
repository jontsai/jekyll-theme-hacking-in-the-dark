YUI.add("gallery-calendar-jumpnav",function(b){function a(c){a.superclass.constructor.apply(this,arguments);}a.NS="jumpnav";a.NAME="calendarJumpnavPlugin";a.ATTRS={yearStart:{value:1985,validator:b.Lang.isNumber},yearEnd:{value:new Date().getFullYear(),validator:b.Lang.isNumber},offsetXY:{value:[30,10],validator:b.Lang.isArray},openEventType:{value:"click",validator:b.Lang.isString},closeAfterGo:{value:true,validator:b.Lang.isBoolean}};b.extend(a,b.Plugin.Base,{_view:null,initializer:function(c){this.afterHostEvent("render",this._afterHostRenderEvent);return this;},destructor:function(){if(this._view){this._view.destroy();}this._view=null;},_afterHostRenderEvent:function(){if(!this._view){var c=this.getAttrs(["yearStart","yearEnd","template","offsetXY","closeAfterGo","openEventType"]);c.calendar=this.get("host");this._view=new b.Calendar.JumpNavView(c);}}});b.Calendar.JumpNavView=b.Base.create("caljumpnav",b.View,[],{events:{"select.yui3-calendar-navpanel-month":{change:"_selectMonth"},"select.yui3-calendar-navpanel-year":{change:"_selectYear"}},template:'<div class="{classPanel}"><div class="yui3-widget-bd">'+'<table><tr><td align="right">Jump to Month:</td>'+'<td><select class="{classMonth}"></select></td></tr>'+'<tr><td align="right">and Year:</td>'+'<td><select class="{classYear}"></select></td></tr>'+"</table></div></div>",_panel:null,_subscr:[],_classCalHead:"yui3-calendar-header-label",_classPanel:"yui3-calendar-jumpnav-panel",_viewNode:null,_classMonth:"yui3-calendar-jumpnav-month",_classYear:"yui3-calendar-jumpnav-year",initializer:function(){var c=this.get("template")||this.template;c=b.Lang.sub(c,{classPanel:this._classPanel,classMonth:this._classMonth,classYear:this._classYear});var d=b.Node.create(c);this.set("container",d);this._createPanelView(d);this._regenMonths(new Date());if(this.get("calendar")){var e=this.get("calendar"),f=e.get("contentBox").one("."+this._classCalHead);this._subscr.push(f.on(this.get("openEventType"),this.render,this));this._subscr.push(e.on("dateChange",this._onCalendarDateChange,this));}return this;},render:function(){var c=this._panel,i=this.get("calendar"),e=i.get("date"),h=this._viewNode.one("."+this._classMonth).get("selectedIndex")||null,f=this._viewNode.one("."+this._classYear).get("selectedIndex")||null;if(h!==e.getMonth()){this._setSelectedMonth(e);}if(!this._yearInSelect(e.getFullYear())){this._regenYears(e);}this._setSelectedYear(e);c.show();var d=i.get("contentBox"),g=d.getXY();g[0]+=+(+d.getComputedStyle("width").replace(/px/,""))+this.get("offsetXY")[0];g[1]+=this.get("offsetXY")[1];c.set("xy",g);return this;},destructor:function(){b.Array.each(this._subscr,function(c){c.detach();});this._subscr=null;if(this._panel){this._panel.destroy();this._panel=null;}this._viewNode=null;},_createPanelView:function(e){var d=this;var c=new b.Panel({srcNode:e,model:false,render:true,visible:false,plugins:[b.Plugin.Drag],buttons:[{value:"Go",section:b.WidgetStdMod.FOOTER,action:function(f){f.preventDefault();d._onGoButton();this.hide();}},{value:"Cancel",section:b.WidgetStdMod.FOOTER,action:function(f){f.preventDefault();this.hide();}}]});this._panel=c;this.set("container",c);this._viewNode=c.get("contentBox");},_setSelectedMonth:function(c){var d=this._viewNode.one("."+this._classMonth);d.set("selectedIndex",c.getMonth());},_setSelectedYear:function(c){var d=this._viewNode.one("."+this._classYear).all("option");d.some(function(e){if(e.get("value")==c.getFullYear()){e.set("selected",true);return true;}});},_regenMonths:function(d){d=d||this.get("calendar").get("date");var e=this._viewNode.one("."+this._classMonth),g=e.getDOMNode(),f=(d&&d.getMonth)?d.getMonth():null,c=["January","February","March","April","May","June","July","August","September","October","November","December"];if(!g){return;}g.options.length=0;b.Array.each(c,function(i,h){g.options[g.options.length]=new Option(i,h);if(f===h){g.options[g.options.length-1].selected=true;}});},_regenYears:function(d){d=d||this.get("calendar").get("date");var h=this._viewNode.one("."+this._classYear),g=h.getDOMNode(),e=(d&&d.getFullYear)?d.getFullYear():null,c=this.get("yearStart"),f=this.get("yearEnd");if(!g){return;}g.options.length=0;for(var i=c;i<=f;i++){g.options[g.options.length]=new Option(i,i);if(e&&e===i){g.options[g.options.length-1].selected=true;}}},_yearInSelect:function(d){var e=this._viewNode.one("."+this._classYear),c=null;e.get("options").some(function(g,f){if(+(g.get("value"))===d){c=f;return true;}});return(c!==null)?true:false;},_onCalendarDateChange:function(d){var c=d.newVal;if(this._panel&&this._panel.get("visible")){this._setSelectedMonth(c);if(!this._yearInSelect(c.getFullYear())){this._regenYears(c);}this._setSelectedYear(c);}},_onGoButton:function(){var c=this.get("container").one("."+this._classMonth).get("value"),d=this.get("container").one("."+this._classYear).get("value");this.get("calendar").set("date",new Date(d,c,1));if(this.get("closeAfterGo")){if(this._panel){this._panel.hide();}else{this._viewNode.hide();}}},_selectMonth:function(h){var d=h.target,f=d.get("options"),i=+d.get("selectedIndex"),c=f.item(i),g=+c.get("value");this.set("month",g);this.fire("monthSelected",{evt:h,value:c.get("value"),text:c.get("text")});},_selectYear:function(h){var d=h.target,g=d.get("options"),i=+d.get("selectedIndex"),c=g.item(i),f=+c.get("value");this.set("year",f);this.fire("yearSelected",{evt:h,value:f,text:c.get("text")});}},{ATTRS:{calendar:{value:null,validator:function(c){return c instanceof b.Calendar;}},template:{valueFn:function(){return this.template;},validator:b.Lang.isString},yearStart:{value:1992,validator:b.Lang.isNumber},yearEnd:{value:new Date().getFullYear(),validator:b.Lang.isNumber},offsetXY:{value:[30,10],validator:b.Lang.isArray},openEventType:{value:"click",validator:b.Lang.isString},closeAfterGo:{value:true,validator:b.Lang.isBoolean}}});b.namespace("Plugin.Calendar").JumpNav=a;},"gallery-2012.09.26-20-36",{requires:["plugin","base-build","view","panel","calendar"],skinnable:false});
