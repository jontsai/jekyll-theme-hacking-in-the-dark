YUI.add("gallery-bt-viewer",function(e,t){var n="bvi_",r={IMAGE:n+"image",BOTTON:n+"button",EXPAND:n+"expand"},i='<span class="'+r.BOTTON+'"></span>',s=function(e){e.get("naturalWidth")>e.get("offsetWidth")&&e.insert(i,"before")},o=function(e){var t=e.currentTarget,n=t.next("."+r.IMAGE);e.preventDefault(),t.toggleClass(r.EXPAND),n.toggleClass(r.EXPAND),this._uiDimensionsChange(),this.syncScroll()},u=e.Base.create("btviewer",e.ScrollView,[e.Bottle.SyncScroll,e.zui.Attribute],{initializer:function(){try{this.setAttrs({flick:!1,bounce:0}),this.setAttrs(e.JSON.parse(this.get("contentBox").getData("cfg-scroll")))}catch(t){}this.set("syncScrollMethod",this._uiDimensionsChange)},destructor:function(){this.unplug(e.zui.RAScroll),this._bviEventHandlers.detach(),delete this._bviEventHandlers},renderUI:function(){var t=this.get("contentBox"),n=this.get("imageNode"),i=this;this.plug(e.zui.RAScroll),this.unplug(e.Plugin.ScrollViewScrollbars),e.Bottle.Device.getTouchSupport()||this.plug(e.zui.ScrollHelper),n.addClass(r.IMAGE),n.each(function(e){e.get("naturalWidth")?s(e):e.once("load",function(e){s(e.target),i._uiDimensionsChange(),i.syncScroll()})}),this._bviEventHandlers=new e.EventHandle([t.delegate("click",o,"."+r.BOTTON,this)]),e.once("btNative",this._nativeScroll,this),this._uiDimensionsChange(),this.syncScroll()},_nativeScroll:function(){this._prevent={move:!1,start:!1,end:!1}}},{ATTRS:{imageNode:{writeOnce:!0,lazyAdd:!1,setter:function(e){return this._imageCSS=e,this.get("contentBox").all(e)}}},HTML_PARSER:{imageNode:function(e){return e.getData("image-node")||"img"}}});e.namespace("Bottle").Viewer=u},"gallery-2013.04.10-22-48",{requires:["gallery-bt-syncscroll","gallery-zui-rascroll","gallery-zui-attribute","gallery-zui-scrollhelper"]});
