YUI.add("gallery-layout-rows",function(e,t){"use strict";function s(t,n){var r=t;if(i)var s=n.bd.get("offsetHeight");var o=n.root.get("offsetHeight")-n.bd.get("offsetHeight");return n.hd&&(r-=n.hd.get("offsetHeight"),o-=n.hd.get("offsetHeight")),n.ft&&(r-=n.ft.get("offsetHeight"),o-=n.ft.get("offsetHeight")),r-=o,r-=n.bd.vertMarginBorderPadding(),Math.max(r,e.PageLayout.min_module_height)}function o(e,t,n,r,i,s){return s.mbp=i.horizMarginBorderPadding(),Math.max(1,Math.floor(e*t[n][r]/100)-s.mbp)}var n=0<e.UA.ie&&e.UA.ie<8,r=0<e.UA.ie&&e.UA.ie<8,i=0<e.UA.ie&&e.UA.ie<8;e.namespace("PageLayoutRows"),e.PageLayoutRows.collapse_classes={vert_parent_class:e.PageLayout.module_rows_class,horiz_parent_class:e.PageLayout.module_class,collapse_parent_pattern:e.PageLayout.expand_vert_nub_class},e.PageLayoutRows.resize=function(t,i,u){var a=this.body_info.outers.size(),f=[],l=[];for(var c=0;c<a;c++){var h=this.body_info.inner_sizes[c].slice(0);f.push(h),l.push(i);var p=0,d=0,v=this.body_info.modules[c],m=v.size();for(var g=0;g<m;g++){var y=v.item(g);y.setStyle("height","auto"),y.hasClass(e.PageLayout.collapsed_horiz_class)?(n&&y.setStyle("display","none"),y.setStyle("width","auto"),n&&y.setStyle("display","block"),h[g]=-y.get("offsetWidth"),l[c]-=y.totalWidth()):h[g]>0&&(p++,d+=h[g])}if(p<m)for(var g=0;g<m;g++)h[g]>0&&(h[g]*=100/d)}var b={};if(this.single_module){var y=this.body_info.modules[0].item(0),w=y._page_layout.children;if(w.bd){var E=o(l[0],f,0,0,y,b),S=Math.max(1,E-w.bd.horizMarginBorderPadding());this.fire("beforeResizeModule",{bd:w.bd,height:"auto",width:S}),this._setWidth(w,E),w.root.setStyle("height","auto"),w.bd.setStyle("height","auto")}var x=y.totalHeight();t=x>u?e.PageLayout.FIT_TO_VIEWPORT:e.PageLayout.FIT_TO_CONTENT,this.body_container.removeClass("FIT_TO_[A-Z_]+")}if(t===e.PageLayout.FIT_TO_CONTENT){var T=[];for(var c=0;c<a;c++){this.body_info.outers.item(c).setStyle("height","auto");var v=this.body_info.modules[c],x=0,N=0,C=v.size(),m=C;for(var g=0;g<m;g++){var E=f[c][g],y=v.item(g);if(E<0){var k=!1;if(E==e.PageLayout.unmanaged_size&&r){var w=y._page_layout.children;if(w.bd){var L=w.bd.totalWidth();N+=L+y.horizMarginBorderPadding(),k=!0,w.root.setStyle("width",L+"px")}}k||(N+=y.totalWidth()),C--}}var A=0;for(var g=0;g<m;g++){var E=f[c][g],y=v.item(g);if(E<0){if(E==e.PageLayout.unmanaged_size){var w=y._page_layout.children;w.bd&&(w.root.setStyle("height","auto"),w.bd.setStyle("height","auto")),x=Math.max(x,y.get("offsetHeight"))}continue}A++;var w=y._page_layout.children;if(w.bd){var E=o(l[c],f,c,g,y,b);N+=E+b.mbp,A==C&&(E+=i-N);var S=Math.max(1,E-w.bd.horizMarginBorderPadding());this.fire("beforeResizeModule",{bd:w.bd,height:"auto",width:S}),this._setWidth(w,E),w.root.setStyle("height","auto"),w.bd.setStyle("height","auto")}x=Math.max(x,y.get("offsetHeight"))}T.push(x)}}else{var T=this.body_info.outer_sizes.slice(0),p=0,d=0;for(var c=0;c<a;c++){var O=this.body_info.outers.item(c),M=O.hasClass(e.PageLayout.collapsed_vert_class);M||T[c]<0?(T[c]=0,M&&O.setStyle("height","auto"),u-=O.one("*").totalHeight(),u-=O.vertMarginBorderPadding()):(p++,d+=T[c])}if(p<a)for(var c=0;c<a;c++)T[c]*=100/d}for(var c=0;c<a;c++){if(t===e.PageLayout.FIT_TO_CONTENT)var x=T[c];else{if(T[c]===0){var y=this.body_info.modules[c].item(0),w=y._page_layout.children;if(w.bd){var _=w.bd.insideHeight(),E=o(l[c],f,c,0,y,b),S=Math.max(1,E-w.bd.horizMarginBorderPadding());this.fire("beforeResizeModule",{bd:w.bd,height:_,width:S}),this._setWidth(w,E),this.fire("afterResizeModule",{bd:w.bd,height:_,width:S})}continue}var x=Math.max(1,Math.floor(u*T[c]/100)-this.body_info.outers.item(c).vertMarginBorderPadding())}this.body_info.outers.item(c).setStyle("height",x+"px");var v=this.body_info.modules[c],N=0,C=v.size(),m=C;for(var g=0;g<m;g++){var E=f[c][g],y=v.item(g);if(E<0){var k=!1;if(E==e.PageLayout.unmanaged_size){var w=y._page_layout.children;if(w.bd){var _=s(x,w),S=w.bd.insideWidth();this.fire("beforeResizeModule",{bd:w.bd,height:_,width:S}),w.bd.setStyle("height",_+"px");if(r){var L=w.bd.totalWidth();N+=L+y.horizMarginBorderPadding(),k=!0,w.root.setStyle("width",L+"px")}this.fire("afterResizeModule",{bd:w.bd,height:_,width:S})}}else y.setStyle("height",Math.max(1,x-y.vertMarginBorderPadding())+"px");k||(N+=y.totalWidth()),C--}}var A=0;for(var g=0;g<m;g++){if(f[c][g]<0)continue;A++;var y=v.item(g),w=y._page_layout.children;if(w.bd){var _=s(x,w),E=o(l[c],f,c,g,y,b);N+=E+b.mbp,A==C&&(E+=i-N);var S=Math.max(1,E-w.bd.horizMarginBorderPadding());t===e.PageLayout.FIT_TO_VIEWPORT&&(this.fire("beforeResizeModule",{bd:w.bd,height:_,width:S}),this._setWidth(w,E)),w.bd.setStyle("height",_+"px"),this.fire("afterResizeModule",{bd:w.bd,height:_,width:S})}}}}},"gallery-2013.06.13-01-19",{requires:["gallery-layout"]});
