YUI.add("gallery-timer",function(a){var d="running",h="paused",i="stopped",g="start",e="stop",c="pause",b="resume",f="timer";a.Timer=a.Base.create("timer",a.Base,[],{initializer:function(j){this.after("statusChange",this._afterStatusChange,this);this.publish(g,{defaultFn:this._defStartFn});this.publish(e,{defaultFn:this._defStopFn});this.publish(c,{defaultFn:this._defPauseFn});this.publish(b,{defaultFn:this._defResumeFn});},start:function(){if(this.get("status")!==d){this.fire(g);}return this;},stop:function(){if(this.get("status")===d){this.fire(e);}return this;},pause:function(){if(this.get("status")===d){this.fire(c);}return this;},resume:function(){if(this.get("status")===h){this.fire(b);}return this;},_timerObj:null,_remainingLength:null,_makeTimer:function(){var k=this._timerObj,j=this.get("repeatCount");if(k){k.cancel();k=null;this._timerObj=null;}if(j===0||j>this.get("step")){k=a.later(this._remainingLength,this,this._timer);}this._timerObj=k;this.set("timer",k);this.set("start",(new Date()).getTime());this.set("stop",this.get("start"));},_destroyTimer:function(){var j=this._timerObj;if(j){j.cancel();j=null;this._timerObj=null;}this.set("timer",null);this.set("stop",(new Date()).getTime());this.set("step",0);this._remainingLength=this._remainingLength-(this.get("stop")-this.get("start"));},_timer:function(){this.fire(f);var j=this.get("step"),k=this.get("repeatCount");this.set("step",++j);if(k>0&&k<=j){this._remainingLength=0;this.stop();}else{this._remainingLength=this.get("length");this._makeTimer();}this._executeCallback();},_afterStatusChange:function(j){switch(j.newVal){case d:this._makeTimer();break;case i:case h:this._destroyTimer();break;}},_defStartFn:function(k){var j=this.get("startDelay");this._remainingLength=this.get("length");if(j>0){a.later(j,this,function(){this.set("status",d);});}else{this.set("status",d);}},_defStopFn:function(j){this._remainingLength=0;this.set("status",i);},_defPauseFn:function(j){this.set("status",h);},_defResumeFn:function(j){this.set("status",d);},_repeatCountValidator:function(j){return(this.get("status")===i);},_executeCallback:function(){var j=this.get("callback");if(a.Lang.isFunction(j)){(this.get("callback"))();}},_remainingGetter:function(){var j=this.get("status"),l=this._remainingLength,k=(new Date()).getTime();if(j===i){return 0;}else{if(j===h){return l;}else{return l-(k-this.get("start"));}}}},{ATTRS:{callback:{value:null,validator:a.Lang.isFunction},length:{value:3000,setter:function(j){return parseInt(j,10);}},remaining:{readonly:true,getter:"_remainingGetter"},repeatCount:{validator:"repeatCountValidator",setter:function(j){return parseInt(j,10);},value:0,lazyAdd:false},start:{readonly:true},startDelay:{value:0},status:{value:i,readonly:true},step:{value:0,readonly:true},stop:{readonly:true},timer:{readonly:true}},STATUS:{RUNNING:d,PAUSED:h,STOPPED:i},EVENTS:{START:g,STOP:e,PAUSE:c,RESUME:b,TIMER:f}});},"gallery-2012.07.25-21-36",{requires:["base-build","event-custom"]});