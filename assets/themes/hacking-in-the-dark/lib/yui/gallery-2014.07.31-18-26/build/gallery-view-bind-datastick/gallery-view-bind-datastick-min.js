YUI.add("gallery-view-bind-datastick",function(e,t){function n(){}n._handlers=[],n.addHandler=function(t){t=e.Array.map(e.Array.flatten([t]),function(t){return e.mix({updateModel:!0,updateView:!0,updateMethod:"text"},t,!0)}),this._handlers=this._handlers.concat(t)},n.prototype={_modelBindings:null,unbindAttrs:function(t){e.Array.each(this._modelBindings,e.bind(function(e,n){if(t&&e.model!==t)return!1;e.model.detach(e.event,e.fn),delete this._modelBindings[n]},this)),this._modelBindings=e.Array.filter(this._modelBindings,function(e){return e}),this.get("container").detach("stick"+(t?":"+t.get("clientId"):""))},bindAttrs:function(t,n){var r=this,s=t||this.get("model"),d="stick:"+s.get("clientId"),v=n||this.bindings||{};this._modelBindings||(this._modelBindings=[]),this.unbindAttrs(t),e.Array.each(e.Object.keys(v),function(t){var n,d,m,g,y=v[t]||{},b=e.guid();t!="container"?n=r.get("container").all(t):(n=e.NodeList(r.get("container")),t="");if(n.isEmpty())return;e.Lang.isString(y)&&(y={observe:y}),g=l(n,y),m=g.observe,d=e.mix({bindKey:b},g.setOptions||{},!0),c(r,n,g,s,m),h(r,n,g,s,m),m&&(e.Array.each(g.events||[],function(e){var i=e,u=function(e){var t=g.getVal.call(r,n,e,g);o(r,g.updateModel,t,g)&&a(s,m,t,d,r,g)};t===""?r.get("container").on(i,u):r.get("container").delegate(i,u,t)}),e.Array.each(e.Array.flatten([m]),function(e){u(s,r,e+"Change",function(e){if(e.bindKey!=b){var t=e.currentTarget;p(r,n,g,f(t,m,g,r,e),t)}})}),p(r,n,g,f(s,m,g,r),s,!0)),i(r,g.initialize,n,s,g)}),this._originalDestroy=this.destroy,this.destroy=function(){r.unbindAttrs(),r._originalDestroy&&r._originalDestroy.apply(arguments)}}};var r=function(t,n){var r=(n||"").split("."),i=e.Array.reduce(r,t,function(e,t){return e[t]});return i==null?t:i},i=function(t,n){if(n)return(e.Lang.isString(n)?t[n]:n).apply(t,e.Array(arguments,2))},s=function(e){return e.get("options").filter(function(e){return e.selected})},o=function(t,n){return e.Lang.isBoolean(n)?n:e.Lang.isFunction(n)||e.Lang.isString(n)?i.apply(this,e.Array(arguments)):!1},u=function(e,t,n,r){e.on(n,r,t),t._modelBindings.push({model:e,event:n,fn:r})},a=function(e,t,n,r,s,o){o.onSet&&(n=i(s,o.onSet,n,o)),e.set(t,n,r)},f=function(t,n,r,s,o){var u,a=function(n){var i;return o&&n===o.attrName?i=r.escape?e.Escape.html(o.newVal):o.newVal:i=r.escape?e.Escape.html(t.get(n)):t.get(n),e.Lang.isUndefined(i)||e.Lang.isNull(i)?"":i};return u=e.Lang.isArray(n)?e.Array.map(n,a):a(n),r.onGet?i(s,r.onGet,u,r):u},l=function(t,r){var i=[{updateModel:!1,updateView:!0,updateMethod:"text",update:function(e,t,n,r){e.set(r.updateMethod,t)},getVal:function(e,t,n){return e.get(n.updateMethod)}}];e.Array.each(n._handlers,function(e){t.item(0).test(e.selector)&&i.push(e)}),i.push(r);var s=e.Array.reduce(i,{},function(t,n){return e.mix(t,n,!0)});return delete s.selector,s},c=function(t,n,r,i,s){var o=["autofocus","autoplay","async","checked","controls","defer","disabled","hidden","loop","multiple","open","readonly","required","scoped","selected"];e.Array.each(r.attributes||[],function(r){var a="",l=r.observe||(r.observe=s),c=function(){var s=e.Array.indexOf(o,r.name,!0)>-1,u=s?"prop":"attr",c=f(i,l,r,t);r.name==="class"?(n.removeClass(a).addClass(c),a=c):n[u](r.name,c)};e.Array.each(e.Array.flatten([l]),function(e){u(i,t,e+"Change",c)}),c()})},h=function(t,n,r,s,o){if(r.visible==null)return;var a=function(){var u=r.visible,a=r.visibleFn,l=f(s,o,r,t),c=!!l;if(e.Lang.isFunction(u)||e.Lang.isString(u))c=i(t,u,l,r);a?i(t,a,n,c,r):c?n.show():n.hide()};e.Array.each(e.Array.flatten([o]),function(e){u(s,t,e+"Change",a)}),a()},p=function(e,t,n,r,s,u){if(!o(e,n.updateView,r,n))return;n.update.call(e,t,r,s,n),u||i(e,n.afterUpdate,t,r,n)};n.addHandler([{selector:'[contenteditable="true"]',updateMethod:"innerHTML",events:["keyup","change","paste","cut"]},{selector:"input",events:["keyup","change","paste","cut"],update:function(e,t){e.item(0).set("value",t)},getVal:function(e){var t=e.item(0).get("value");return e.item(0).test('[type="number"]')?t==null?t:Number(t):t}},{selector:'input[type="radio"]',events:["change"],update:function(e,t){e.filter('[value="'+t+'"]').set("checked",!0)},getVal:function(e){return e.filter(function(e){return e.checked}).item(0).get("value")}},{selector:'input[type="checkbox"]',events:["change"],update:function(t,n,r,i){t.size()>1?e.Array.each(t,function(t){e.Array.indexOf(n,e.one(t).get("value"))>-1?e.one(t).set("checked",!0):e.one(t).set("checked",!1)}):e.Lang.isBoolean(n)?t.item(0).set("checked",n):t.item(0).set("checked",n==t.item(0).get("value"))},getVal:function(e){var t;if(e.size()>1)t=[],e.each(function(e){e.get("checked")&&t.push(e.get("value"))});else{var n=e.item(0),r;t=n.get("checked"),r=n.get("value"),r!="on"&&r!=null&&(t?t=n.get("value"):t=null)}return t}}]),e.namespace("DataBind").Stick=n},"gallery-2013.10.09-22-56",{requires:["view"]});
