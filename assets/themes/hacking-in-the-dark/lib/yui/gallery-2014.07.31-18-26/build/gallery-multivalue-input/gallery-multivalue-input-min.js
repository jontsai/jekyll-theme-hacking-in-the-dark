YUI.add("gallery-multivalue-input",function(e,t){"use strict";function n(e){n.superclass.constructor.apply(this,arguments)}var r=e.Lang,i="multivalueinput",s=e.ClassNameManager.getClassName,o=s(i,"content"),u=s(i,"list"),a=s(i,"listitem"),f=s(i,"ul"),l=s(i,"input"),c=s(i,"remove"),h=e.Node;n.NAME="multiValueInput",n.NS="mvi",n.ATTRS={values:{value:[],validator:function(e){return r.isArray(e)}},placeholder:{value:"type here"}},n.DIV_TEMPLATE='<div class="{div_class}"></div>',n.VALUE_HOLDER_TEMPLATE='<ul class="{ul_class}"></ul>',n.LI_TEMPLATE='<li class="{list_class}">{item}</li>',n.ITEM_REMOVE='<a href="javascript:void(0)" class="{remove_class}">,</a>',e.extend(n,e.Plugin.Base,{initializer:function(){var e=this.get("values"),t=this.get("placeholder");this._host=this.get("host"),this._host.set("placeholder",t),this._divContent=this._createDivNode(),this._host.insert(this._divContent,"before"),this._ul=this._createULNode();if(e)for(var n=0;n<e.length;n++)this._ul.appendChild(this._createListNode(e[n],!0));this._host.addClass(l),this._inputWrapper=this._createListNode(""),this._inputWrapper.appendChild(this._host),this._ul.appendChild(this._inputWrapper),this._divContent.appendChild(this._ul),this._host.ac?this._host.ac.after("select",this._appendItem,this):this._host.after("change",this._appendItem,this),this._host.after("blur",function(){this._host.set("value",""),this._divContent.removeClass("yui3-multivalueinput-border")},this),this._host.after("focus",function(){this._host.set("value",""),this._divContent.addClass("yui3-multivalueinput-border")},this),this._host.on("keydown",this._keyDownHandler,this),this._divContent.delegate("click",function(e){this._removeItem(e.currentTarget.ancestor("."+a))},"."+c,this)},_keyDownHandler:function(e){var t,n,r;if(e.keyCode!==8)return;t=this._ul.get("children"),r=t.size()-2,n=t.item(r),this._host.get("value")||(this._pendingDelete?(this._removeItem(n,r),this._pendingDelete=!1):(n.addClass("yui3-multivalueinput-pendingdelete"),this._pendingDelete=!0))},_createULNode:function(){return h.create(e.substitute(n.VALUE_HOLDER_TEMPLATE,{ul_class:f}))},_createListNode:function(t,r){var i,s;return r?(s=h.create(e.substitute(n.ITEM_REMOVE,{remove_class:c})),i=h.create(e.substitute(n.LI_TEMPLATE,{item:t,list_class:u})),i.appendChild(s),i.addClass(a)):i=h.create(e.substitute(n.LI_TEMPLATE,{item:t,list_class:u})),i},_createDivNode:function(){return h.create(e.substitute(n.DIV_TEMPLATE,{div_class:o}))},_getListIndex:function(e){var t=this._ul.get("children"),n=t.size();for(var r=0;r<n;r++)if(e.compareTo(t.item(r)))return r;return-1},_appendItem:function(){var e=this._host.get("value");this._inputWrapper.insert(this._createListNode(e,!0),"before"),this._addValue(e),this._host.set("value","")},_removeItem:function(e,t){var n=t||this._getListIndex(e);this._host.focus(),e.get("parentNode").removeChild(e),this._removeValue(n)},_addValue:function(e){var t=this.get("values");t.push(e),this.set("values",t.slice(0))},_removeValue:function(e){var t=this.get("values"),n=t[e];t.splice(e,1),this.set("values",t.slice(0))}}),e.MultiValueInput=n,e.namespace("Plugin").MultivalueInput=n},"gallery-2013.05.29-23-38",{skinnable:"true",requires:["plugin","substitute","node"]});
