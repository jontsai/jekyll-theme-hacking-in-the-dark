if (typeof __coverage__ === 'undefined') { __coverage__ = {}; }
if (!__coverage__['build/y3d-scene/y3d-scene.js']) {
   __coverage__['build/y3d-scene/y3d-scene.js'] = {"path":"build/y3d-scene/y3d-scene.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0},"fnMap":{"1":{"name":"(anonymous_1)","line":1,"loc":{"start":{"line":1,"column":21},"end":{"line":1,"column":40}}},"2":{"name":"(anonymous_2)","line":8,"loc":{"start":{"line":8,"column":14},"end":{"line":8,"column":25}}},"3":{"name":"(anonymous_3)","line":15,"loc":{"start":{"line":15,"column":6},"end":{"line":15,"column":25}}},"4":{"name":"(anonymous_4)","line":28,"loc":{"start":{"line":28,"column":9},"end":{"line":28,"column":28}}},"5":{"name":"(anonymous_5)","line":35,"loc":{"start":{"line":35,"column":9},"end":{"line":35,"column":20}}},"6":{"name":"(anonymous_6)","line":44,"loc":{"start":{"line":44,"column":21},"end":{"line":44,"column":40}}},"7":{"name":"(anonymous_7)","line":68,"loc":{"start":{"line":68,"column":14},"end":{"line":68,"column":25}}},"8":{"name":"(anonymous_8)","line":76,"loc":{"start":{"line":76,"column":26},"end":{"line":76,"column":37}}},"9":{"name":"(anonymous_9)","line":90,"loc":{"start":{"line":90,"column":16},"end":{"line":90,"column":45}}},"10":{"name":"(anonymous_10)","line":98,"loc":{"start":{"line":98,"column":16},"end":{"line":98,"column":35}}},"11":{"name":"(anonymous_11)","line":108,"loc":{"start":{"line":108,"column":17},"end":{"line":108,"column":36}}},"12":{"name":"(anonymous_12)","line":122,"loc":{"start":{"line":122,"column":19},"end":{"line":122,"column":30}}},"13":{"name":"(anonymous_13)","line":130,"loc":{"start":{"line":130,"column":14},"end":{"line":130,"column":33}}},"14":{"name":"(anonymous_14)","line":148,"loc":{"start":{"line":148,"column":18},"end":{"line":148,"column":64}}},"15":{"name":"(anonymous_15)","line":160,"loc":{"start":{"line":160,"column":25},"end":{"line":160,"column":44}}},"16":{"name":"(anonymous_16)","line":174,"loc":{"start":{"line":174,"column":17},"end":{"line":174,"column":33}}},"17":{"name":"(anonymous_17)","line":182,"loc":{"start":{"line":182,"column":23},"end":{"line":182,"column":51}}},"18":{"name":"(anonymous_18)","line":209,"loc":{"start":{"line":209,"column":15},"end":{"line":209,"column":61}}},"19":{"name":"(anonymous_19)","line":221,"loc":{"start":{"line":221,"column":22},"end":{"line":221,"column":63}}},"20":{"name":"(anonymous_20)","line":230,"loc":{"start":{"line":230,"column":17},"end":{"line":230,"column":28}}},"21":{"name":"(anonymous_21)","line":254,"loc":{"start":{"line":254,"column":12},"end":{"line":254,"column":23}}},"22":{"name":"(anonymous_22)","line":261,"loc":{"start":{"line":261,"column":11},"end":{"line":261,"column":25}}},"23":{"name":"(anonymous_23)","line":278,"loc":{"start":{"line":278,"column":12},"end":{"line":278,"column":23}}},"24":{"name":"(anonymous_24)","line":285,"loc":{"start":{"line":285,"column":11},"end":{"line":285,"column":25}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":307,"column":3}},"2":{"start":{"line":3,"column":0},"end":{"line":3,"column":18}},"3":{"start":{"line":5,"column":0},"end":{"line":295,"column":3}},"4":{"start":{"line":9,"column":2},"end":{"line":10,"column":37}},"5":{"start":{"line":12,"column":2},"end":{"line":12,"column":75}},"6":{"start":{"line":16,"column":2},"end":{"line":18,"column":43}},"7":{"start":{"line":20,"column":2},"end":{"line":20,"column":126}},"8":{"start":{"line":21,"column":2},"end":{"line":21,"column":121}},"9":{"start":{"line":23,"column":2},"end":{"line":23,"column":44}},"10":{"start":{"line":25,"column":2},"end":{"line":25,"column":44}},"11":{"start":{"line":29,"column":2},"end":{"line":30,"column":43}},"12":{"start":{"line":32,"column":2},"end":{"line":32,"column":40}},"13":{"start":{"line":36,"column":2},"end":{"line":39,"column":43}},"14":{"start":{"line":41,"column":2},"end":{"line":41,"column":25}},"15":{"start":{"line":42,"column":2},"end":{"line":42,"column":30}},"16":{"start":{"line":44,"column":2},"end":{"line":65,"column":5}},"17":{"start":{"line":45,"column":3},"end":{"line":45,"column":48}},"18":{"start":{"line":47,"column":3},"end":{"line":47,"column":31}},"19":{"start":{"line":49,"column":3},"end":{"line":49,"column":116}},"20":{"start":{"line":50,"column":3},"end":{"line":50,"column":87}},"21":{"start":{"line":52,"column":3},"end":{"line":52,"column":93}},"22":{"start":{"line":53,"column":3},"end":{"line":53,"column":52}},"23":{"start":{"line":55,"column":3},"end":{"line":55,"column":62}},"24":{"start":{"line":57,"column":3},"end":{"line":62,"column":4}},"25":{"start":{"line":58,"column":4},"end":{"line":58,"column":38}},"26":{"start":{"line":61,"column":4},"end":{"line":61,"column":37}},"27":{"start":{"line":64,"column":3},"end":{"line":64,"column":29}},"28":{"start":{"line":69,"column":2},"end":{"line":71,"column":43}},"29":{"start":{"line":73,"column":2},"end":{"line":73,"column":81}},"30":{"start":{"line":77,"column":2},"end":{"line":81,"column":33}},"31":{"start":{"line":83,"column":2},"end":{"line":83,"column":40}},"32":{"start":{"line":85,"column":2},"end":{"line":85,"column":81}},"33":{"start":{"line":87,"column":2},"end":{"line":87,"column":26}},"34":{"start":{"line":91,"column":2},"end":{"line":92,"column":30}},"35":{"start":{"line":94,"column":2},"end":{"line":94,"column":59}},"36":{"start":{"line":95,"column":2},"end":{"line":95,"column":62}},"37":{"start":{"line":99,"column":2},"end":{"line":103,"column":35}},"38":{"start":{"line":105,"column":2},"end":{"line":105,"column":45}},"39":{"start":{"line":109,"column":2},"end":{"line":113,"column":33}},"40":{"start":{"line":115,"column":2},"end":{"line":117,"column":3}},"41":{"start":{"line":116,"column":3},"end":{"line":116,"column":123}},"42":{"start":{"line":119,"column":2},"end":{"line":119,"column":59}},"43":{"start":{"line":123,"column":2},"end":{"line":124,"column":30}},"44":{"start":{"line":126,"column":2},"end":{"line":126,"column":37}},"45":{"start":{"line":127,"column":2},"end":{"line":127,"column":69}},"46":{"start":{"line":131,"column":2},"end":{"line":136,"column":5}},"47":{"start":{"line":138,"column":2},"end":{"line":143,"column":3}},"48":{"start":{"line":139,"column":3},"end":{"line":139,"column":49}},"49":{"start":{"line":142,"column":3},"end":{"line":142,"column":47}},"50":{"start":{"line":145,"column":2},"end":{"line":145,"column":17}},"51":{"start":{"line":149,"column":2},"end":{"line":151,"column":35}},"52":{"start":{"line":153,"column":2},"end":{"line":153,"column":37}},"53":{"start":{"line":154,"column":2},"end":{"line":154,"column":57}},"54":{"start":{"line":155,"column":2},"end":{"line":155,"column":35}},"55":{"start":{"line":157,"column":2},"end":{"line":157,"column":32}},"56":{"start":{"line":161,"column":2},"end":{"line":163,"column":37}},"57":{"start":{"line":165,"column":2},"end":{"line":167,"column":3}},"58":{"start":{"line":166,"column":3},"end":{"line":166,"column":10}},"59":{"start":{"line":169,"column":2},"end":{"line":169,"column":141}},"60":{"start":{"line":171,"column":2},"end":{"line":171,"column":55}},"61":{"start":{"line":175,"column":2},"end":{"line":177,"column":3}},"62":{"start":{"line":176,"column":3},"end":{"line":176,"column":47}},"63":{"start":{"line":179,"column":2},"end":{"line":179,"column":15}},"64":{"start":{"line":183,"column":2},"end":{"line":186,"column":49}},"65":{"start":{"line":188,"column":2},"end":{"line":190,"column":3}},"66":{"start":{"line":189,"column":3},"end":{"line":189,"column":10}},"67":{"start":{"line":192,"column":2},"end":{"line":192,"column":63}},"68":{"start":{"line":193,"column":2},"end":{"line":193,"column":31}},"69":{"start":{"line":194,"column":2},"end":{"line":194,"column":45}},"70":{"start":{"line":196,"column":2},"end":{"line":196,"column":56}},"71":{"start":{"line":198,"column":2},"end":{"line":198,"column":57}},"72":{"start":{"line":199,"column":2},"end":{"line":199,"column":102}},"73":{"start":{"line":200,"column":2},"end":{"line":200,"column":89}},"74":{"start":{"line":201,"column":2},"end":{"line":201,"column":89}},"75":{"start":{"line":203,"column":2},"end":{"line":203,"column":97}},"76":{"start":{"line":205,"column":2},"end":{"line":205,"column":42}},"77":{"start":{"line":206,"column":2},"end":{"line":206,"column":40}},"78":{"start":{"line":210,"column":2},"end":{"line":213,"column":43}},"79":{"start":{"line":215,"column":2},"end":{"line":215,"column":60}},"80":{"start":{"line":217,"column":2},"end":{"line":217,"column":85}},"81":{"start":{"line":218,"column":2},"end":{"line":218,"column":80}},"82":{"start":{"line":222,"column":2},"end":{"line":223,"column":30}},"83":{"start":{"line":225,"column":2},"end":{"line":225,"column":51}},"84":{"start":{"line":226,"column":2},"end":{"line":226,"column":82}},"85":{"start":{"line":227,"column":2},"end":{"line":227,"column":49}},"86":{"start":{"line":231,"column":2},"end":{"line":232,"column":30}},"87":{"start":{"line":234,"column":2},"end":{"line":234,"column":49}},"88":{"start":{"line":235,"column":2},"end":{"line":235,"column":57}},"89":{"start":{"line":236,"column":2},"end":{"line":236,"column":48}},"90":{"start":{"line":255,"column":4},"end":{"line":256,"column":39}},"91":{"start":{"line":258,"column":4},"end":{"line":258,"column":33}},"92":{"start":{"line":262,"column":4},"end":{"line":263,"column":39}},"93":{"start":{"line":265,"column":4},"end":{"line":265,"column":31}},"94":{"start":{"line":267,"column":4},"end":{"line":267,"column":15}},"95":{"start":{"line":279,"column":4},"end":{"line":280,"column":39}},"96":{"start":{"line":282,"column":4},"end":{"line":282,"column":32}},"97":{"start":{"line":286,"column":4},"end":{"line":287,"column":39}},"98":{"start":{"line":289,"column":4},"end":{"line":289,"column":30}},"99":{"start":{"line":291,"column":4},"end":{"line":291,"column":15}}},"branchMap":{"1":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":3},"end":{"line":57,"column":3}},{"start":{"line":57,"column":3},"end":{"line":57,"column":3}}]},"2":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":2},"end":{"line":115,"column":2}},{"start":{"line":115,"column":2},"end":{"line":115,"column":2}}]},"3":{"line":138,"type":"if","locations":[{"start":{"line":138,"column":2},"end":{"line":138,"column":2}},{"start":{"line":138,"column":2},"end":{"line":138,"column":2}}]},"4":{"line":165,"type":"if","locations":[{"start":{"line":165,"column":2},"end":{"line":165,"column":2}},{"start":{"line":165,"column":2},"end":{"line":165,"column":2}}]},"5":{"line":175,"type":"if","locations":[{"start":{"line":175,"column":2},"end":{"line":175,"column":2}},{"start":{"line":175,"column":2},"end":{"line":175,"column":2}}]},"6":{"line":188,"type":"if","locations":[{"start":{"line":188,"column":2},"end":{"line":188,"column":2}},{"start":{"line":188,"column":2},"end":{"line":188,"column":2}}]}},"code":["(function () { YUI.add('y3d-scene', function (Y, NAME) {","","var Lang = Y.Lang;","","Y.Scene = Y.Base.create('scene', Y.Base, [], {","\tcontext: null,","","\tinitializer: function() {","\t\tvar instance = this,","\t\t\tsrcNode = instance.get('srcNode');","","\t\tinstance.context = srcNode.getDOMNode().getContext(\"experimental-webgl\");","\t},","","\tadd: function(geometry) {","\t\tvar instance = this,","\t\t\tcontext = instance.context,","\t\t\tgeometries = instance.get('geometries');","","\t\tinstance._loadBufferData(geometry, context.ELEMENT_ARRAY_BUFFER, new Uint16Array(geometry.get('indices')), 'indicesBuffer');","\t\tinstance._loadBufferData(geometry, context.ARRAY_BUFFER, new Float32Array(geometry.get('vertices')), 'verticesBuffer');","","\t\tinstance._loadTextureBufferData(geometry);","","\t\tgeometries[geometry.get('id')] = geometry;","\t},","","\tremove: function(geometry) {","\t\tvar instance = this,","\t\t\tgeometries = instance.get('geometries');","","\t\tdelete geometries[geometry.get('id')];","\t},","","\trender: function() {","\t\tvar instance = this,","\t\t\tcontext = instance.context,","\t\t\tprojectionMatrix = instance._createProjectionMatrix(),","\t\t\tgeometries = instance.get('geometries');","","\t\tinstance._clearColor();","\t\tinstance._enableDepthTest();","","\t\tY.each(geometries, function(geometry) {","\t\t\tvar program = instance._getProgram(geometry);","","\t\t\tcontext.useProgram(program);","","\t\t\tinstance._loadBufferData(geometry, context.ARRAY_BUFFER, new Float32Array(geometry.get('color')), 'colorBuffer');","\t\t\tinstance._setVertexAttribute(geometry.colorBuffer, program.vertexColorAttribute, 4);","","\t\t\tinstance._setVertexAttribute(geometry.verticesBuffer, program.vertexPositionAttribute, 3);","\t\t\tinstance._setTextureAttribute(program, geometry);","","\t\t\tinstance._setUniforms(program, geometry, projectionMatrix);","","\t\t\tif (geometry.get('wireframe')) {","\t\t\t\tinstance._drawWireframe(geometry);","\t\t\t}","\t\t\telse {","\t\t\t\tinstance._drawGeometry(geometry);","\t\t\t}","","\t\t\tinstance._unbindBuffers();","\t\t});","\t},","","\t_clearColor: function() {","\t\tvar instance = this,","\t\t\tcontext = instance.context,","\t\t\tbackground = instance.get('background');","","\t\tcontext.clearColor(background[0], background[1], background[2], background[3]);","\t},","","\t_createProjectionMatrix: function() {","\t\tvar instance = this,","\t\t\tcontext = instance.context,","\t\t\tprojectionMatrix = Y.WebGLMatrix.mat4.create(),","\t\t\theight = instance.get('height'),","\t\t\twidth = instance.get('width');","","\t\tcontext.viewport(0, 0, width, height);","","\t\tY.WebGLMatrix.mat4.perspective(45, width/height, 0.1, 300.0, projectionMatrix);","","\t\treturn projectionMatrix;","\t},","","\t_drawElements: function(type, size, buffer) {","\t\tvar instance = this,","\t\t\tcontext = instance.context;","","\t\tcontext.bindBuffer(context.ELEMENT_ARRAY_BUFFER, buffer);","\t\tcontext.drawElements(type, size, context.UNSIGNED_SHORT, 0);","\t},","","\t_drawGeometry: function(geometry) {","\t\tvar instance = this,","\t\t\tcontext = instance.context,","\t\t\ttype = context.TRIANGLES,","\t\t\tsize = geometry.get('indices').length,","\t\t\tbuffer = geometry.indicesBuffer;","","\t\tinstance._drawElements(type, size, buffer);","\t},","","\t_drawWireframe: function(geometry) {","\t\tvar instance = this,","\t\t\tcontext = instance.context,","\t\t\ttype = context.LINES,","\t\t\tsize =  geometry.get('lines').length,","\t\t\tbuffer = geometry.linesBuffer;","","\t\tif (!buffer) {","\t\t\tinstance._loadBufferData(geometry, context.ELEMENT_ARRAY_BUFFER, new Uint16Array(geometry.get('lines')), 'linesBuffer');","\t\t}","","\t\tinstance._drawElements(type, size, geometry.linesBuffer);","\t},","","\t_enableDepthTest: function() {","\t\tvar instance = this,","\t\t\tcontext = instance.context;","","\t\tcontext.enable(context.DEPTH_TEST);","\t\tcontext.clear(context.COLOR_BUFFER_BIT | context.DEPTH_BUFFER_BIT);","\t},","","\t_getProgram: function(geometry) {","\t\tvar instance = this,","\t\t\ttexture = geometry.get('texture'),","\t\t\tprogram = null,","\t\t\toptions = {","\t\t\t\tcontext: instance.context","\t\t\t};","","\t\tif (texture !== null) {","\t\t\tprogram = Y.Shader.getTextureProgram(options);","\t\t}","\t\telse {","\t\t\tprogram = Y.Shader.getColorProgram(options);","\t\t}","","\t\treturn program;","\t},","","\t_loadBufferData: function(geometry, target, array, bufferName) {","\t\tvar instance = this,","\t\t\tcontext = instance.context,","\t\t\tbuffer = context.createBuffer();","","\t\tcontext.bindBuffer(target, buffer);","\t\tcontext.bufferData(target, array, context.STATIC_DRAW);","\t\tcontext.bindBuffer(target, null);","","\t\tgeometry[bufferName] = buffer;","\t},","","\t_loadTextureBufferData: function(geometry) {","\t\tvar instance = this,","\t\t\tcontext = instance.context,","\t\t\ttexture = geometry.get('texture');","","\t\tif (texture === null) {","\t\t\treturn;","\t\t}","","\t\tinstance._loadBufferData(geometry, context.ARRAY_BUFFER, new Float32Array(geometry.get('textureCoordinates')), 'textureCoordinatesBuffer');","","\t\ttexture.set('webglTexture', context.createTexture());","\t},","","\t_setClearColor: function(value) {","\t\tif (Lang.isString(value)) {","\t\t\tvalue = Y.Color.normalizedColorArray(value);","\t\t}","","\t\treturn value;","\t},","","\t_setTextureAttribute: function(program, geometry) {","\t\tvar instance = this,","\t\t\tcontext = instance.context,","\t\t\ttexture = geometry.get('texture'),","\t\t\ttextureCoordinatesBuffer, image, webglTexture;","","\t\tif (texture === null) {","\t\t\treturn;","\t\t}","","\t\ttextureCoordinatesBuffer = geometry.textureCoordinatesBuffer;","\t\timage = texture.get('image');","\t\twebglTexture = texture.get('webglTexture');","","\t\tcontext.bindTexture(context.TEXTURE_2D, webglTexture);","","\t\tcontext.pixelStorei(context.UNPACK_FLIP_Y_WEBGL, true);","\t\tcontext.texImage2D(context.TEXTURE_2D, 0, context.RGBA, context.RGBA, context.UNSIGNED_BYTE, image);","\t\tcontext.texParameteri(context.TEXTURE_2D, context.TEXTURE_MAG_FILTER, context.NEAREST);","\t\tcontext.texParameteri(context.TEXTURE_2D, context.TEXTURE_MIN_FILTER, context.NEAREST);","","\t\tinstance._setVertexAttribute(textureCoordinatesBuffer, program.textureCoordinatesAttribute, 2);","","\t\tcontext.activeTexture(context.TEXTURE0);","\t\tcontext.uniform1i(program.sampler, 0);","\t},","","\t_setUniforms: function(program, geometry, projectionMatrix) {","\t\tvar instance = this,","\t\t\tcontext = instance.context,","\t\t\tcameraMatrix = instance.get('camera').getInvertedMatrix(),","\t\t\tgeometryMatrix = geometry.get('matrix');","","\t\tY.WebGLMatrix.mat4.multiply(cameraMatrix, geometryMatrix);","","\t\tcontext.uniformMatrix4fv(program.projectionMatrixUniform, false, projectionMatrix);","\t\tcontext.uniformMatrix4fv(program.modelViewMatrixUniform, false, cameraMatrix);","\t},","","\t_setVertexAttribute: function(buffer, programAttribute, size) {","\t\tvar instance = this,","\t\t\tcontext = instance.context;","","\t\tcontext.bindBuffer(context.ARRAY_BUFFER, buffer);","\t\tcontext.vertexAttribPointer(programAttribute, size, context.FLOAT, false, 0, 0);","\t\tcontext.bindBuffer(context.ARRAY_BUFFER, null);","\t},","","\t_unbindBuffers: function() {","\t\tvar instance = this,","\t\t\tcontext = instance.context;","","\t\tcontext.bindBuffer(context.ARRAY_BUFFER, null);","\t\tcontext.bindBuffer(context.ELEMENT_ARRAY_BUFFER, null);","\t\tcontext.bindTexture(context.TEXTURE_2D, null);","\t}","}, {","\tATTRS: {","\t\tbackground: {","\t\t\tvalue: 'black',","\t\t\tsetter: '_setClearColor'","\t\t},","","\t\tcamera: {","\t\t\tvalue: new Y.Camera()","\t\t},","","\t\tgeometries: {","\t\t\tvalue: {}","\t\t},","","\t\theight: {","\t\t\tvalueFn: function() {","\t\t\t\tvar instance = this,","\t\t\t\t\tsrcNode = instance.get('srcNode');","","\t\t\t\treturn srcNode.get('height');","\t\t\t},","","\t\t\tsetter: function(val) {","\t\t\t\tvar instance = this,","\t\t\t\t\tsrcNode = instance.get('srcNode');","","\t\t\t\tsrcNode.set('height', val);","","\t\t\t\treturn val;","\t\t\t}","\t\t},","","\t\tsrcNode: {","\t\t\tvalue: Y.Node.one('#y3d'),","\t\t\tsetter: Y.Node.one,","\t\t\twriteOnce: true","\t\t},","","\t\twidth: {","\t\t\tvalueFn: function() {","\t\t\t\tvar instance = this,","\t\t\t\t\tsrcNode = instance.get('srcNode');","","\t\t\t\treturn srcNode.get('width');","\t\t\t},","","\t\t\tsetter: function(val) {","\t\t\t\tvar instance = this,","\t\t\t\t\tsrcNode = instance.get('srcNode');","","\t\t\t\tsrcNode.set('width', val);","","\t\t\t\treturn val;","\t\t\t}","\t\t}","\t}","});","","}, 'gallery-2013.08.22-21-03', {","    \"requires\": [","        \"base-build\",","        \"base-pluginhost\",","        \"node-base\",","        \"y3d-camera\",","        \"y3d-color\",","        \"y3d-matrix\",","        \"y3d-shader\"","    ]","});","","}());"]};
}
var __cov_LiEHuJTiil3R0LHpIXWV$A = __coverage__['build/y3d-scene/y3d-scene.js'];
__cov_LiEHuJTiil3R0LHpIXWV$A.s['1']++;YUI.add('y3d-scene',function(Y,NAME){__cov_LiEHuJTiil3R0LHpIXWV$A.f['1']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['2']++;var Lang=Y.Lang;__cov_LiEHuJTiil3R0LHpIXWV$A.s['3']++;Y.Scene=Y.Base.create('scene',Y.Base,[],{context:null,initializer:function(){__cov_LiEHuJTiil3R0LHpIXWV$A.f['2']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['4']++;var instance=this,srcNode=instance.get('srcNode');__cov_LiEHuJTiil3R0LHpIXWV$A.s['5']++;instance.context=srcNode.getDOMNode().getContext('experimental-webgl');},add:function(geometry){__cov_LiEHuJTiil3R0LHpIXWV$A.f['3']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['6']++;var instance=this,context=instance.context,geometries=instance.get('geometries');__cov_LiEHuJTiil3R0LHpIXWV$A.s['7']++;instance._loadBufferData(geometry,context.ELEMENT_ARRAY_BUFFER,new Uint16Array(geometry.get('indices')),'indicesBuffer');__cov_LiEHuJTiil3R0LHpIXWV$A.s['8']++;instance._loadBufferData(geometry,context.ARRAY_BUFFER,new Float32Array(geometry.get('vertices')),'verticesBuffer');__cov_LiEHuJTiil3R0LHpIXWV$A.s['9']++;instance._loadTextureBufferData(geometry);__cov_LiEHuJTiil3R0LHpIXWV$A.s['10']++;geometries[geometry.get('id')]=geometry;},remove:function(geometry){__cov_LiEHuJTiil3R0LHpIXWV$A.f['4']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['11']++;var instance=this,geometries=instance.get('geometries');__cov_LiEHuJTiil3R0LHpIXWV$A.s['12']++;delete geometries[geometry.get('id')];},render:function(){__cov_LiEHuJTiil3R0LHpIXWV$A.f['5']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['13']++;var instance=this,context=instance.context,projectionMatrix=instance._createProjectionMatrix(),geometries=instance.get('geometries');__cov_LiEHuJTiil3R0LHpIXWV$A.s['14']++;instance._clearColor();__cov_LiEHuJTiil3R0LHpIXWV$A.s['15']++;instance._enableDepthTest();__cov_LiEHuJTiil3R0LHpIXWV$A.s['16']++;Y.each(geometries,function(geometry){__cov_LiEHuJTiil3R0LHpIXWV$A.f['6']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['17']++;var program=instance._getProgram(geometry);__cov_LiEHuJTiil3R0LHpIXWV$A.s['18']++;context.useProgram(program);__cov_LiEHuJTiil3R0LHpIXWV$A.s['19']++;instance._loadBufferData(geometry,context.ARRAY_BUFFER,new Float32Array(geometry.get('color')),'colorBuffer');__cov_LiEHuJTiil3R0LHpIXWV$A.s['20']++;instance._setVertexAttribute(geometry.colorBuffer,program.vertexColorAttribute,4);__cov_LiEHuJTiil3R0LHpIXWV$A.s['21']++;instance._setVertexAttribute(geometry.verticesBuffer,program.vertexPositionAttribute,3);__cov_LiEHuJTiil3R0LHpIXWV$A.s['22']++;instance._setTextureAttribute(program,geometry);__cov_LiEHuJTiil3R0LHpIXWV$A.s['23']++;instance._setUniforms(program,geometry,projectionMatrix);__cov_LiEHuJTiil3R0LHpIXWV$A.s['24']++;if(geometry.get('wireframe')){__cov_LiEHuJTiil3R0LHpIXWV$A.b['1'][0]++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['25']++;instance._drawWireframe(geometry);}else{__cov_LiEHuJTiil3R0LHpIXWV$A.b['1'][1]++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['26']++;instance._drawGeometry(geometry);}__cov_LiEHuJTiil3R0LHpIXWV$A.s['27']++;instance._unbindBuffers();});},_clearColor:function(){__cov_LiEHuJTiil3R0LHpIXWV$A.f['7']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['28']++;var instance=this,context=instance.context,background=instance.get('background');__cov_LiEHuJTiil3R0LHpIXWV$A.s['29']++;context.clearColor(background[0],background[1],background[2],background[3]);},_createProjectionMatrix:function(){__cov_LiEHuJTiil3R0LHpIXWV$A.f['8']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['30']++;var instance=this,context=instance.context,projectionMatrix=Y.WebGLMatrix.mat4.create(),height=instance.get('height'),width=instance.get('width');__cov_LiEHuJTiil3R0LHpIXWV$A.s['31']++;context.viewport(0,0,width,height);__cov_LiEHuJTiil3R0LHpIXWV$A.s['32']++;Y.WebGLMatrix.mat4.perspective(45,width/height,0.1,300,projectionMatrix);__cov_LiEHuJTiil3R0LHpIXWV$A.s['33']++;return projectionMatrix;},_drawElements:function(type,size,buffer){__cov_LiEHuJTiil3R0LHpIXWV$A.f['9']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['34']++;var instance=this,context=instance.context;__cov_LiEHuJTiil3R0LHpIXWV$A.s['35']++;context.bindBuffer(context.ELEMENT_ARRAY_BUFFER,buffer);__cov_LiEHuJTiil3R0LHpIXWV$A.s['36']++;context.drawElements(type,size,context.UNSIGNED_SHORT,0);},_drawGeometry:function(geometry){__cov_LiEHuJTiil3R0LHpIXWV$A.f['10']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['37']++;var instance=this,context=instance.context,type=context.TRIANGLES,size=geometry.get('indices').length,buffer=geometry.indicesBuffer;__cov_LiEHuJTiil3R0LHpIXWV$A.s['38']++;instance._drawElements(type,size,buffer);},_drawWireframe:function(geometry){__cov_LiEHuJTiil3R0LHpIXWV$A.f['11']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['39']++;var instance=this,context=instance.context,type=context.LINES,size=geometry.get('lines').length,buffer=geometry.linesBuffer;__cov_LiEHuJTiil3R0LHpIXWV$A.s['40']++;if(!buffer){__cov_LiEHuJTiil3R0LHpIXWV$A.b['2'][0]++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['41']++;instance._loadBufferData(geometry,context.ELEMENT_ARRAY_BUFFER,new Uint16Array(geometry.get('lines')),'linesBuffer');}else{__cov_LiEHuJTiil3R0LHpIXWV$A.b['2'][1]++;}__cov_LiEHuJTiil3R0LHpIXWV$A.s['42']++;instance._drawElements(type,size,geometry.linesBuffer);},_enableDepthTest:function(){__cov_LiEHuJTiil3R0LHpIXWV$A.f['12']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['43']++;var instance=this,context=instance.context;__cov_LiEHuJTiil3R0LHpIXWV$A.s['44']++;context.enable(context.DEPTH_TEST);__cov_LiEHuJTiil3R0LHpIXWV$A.s['45']++;context.clear(context.COLOR_BUFFER_BIT|context.DEPTH_BUFFER_BIT);},_getProgram:function(geometry){__cov_LiEHuJTiil3R0LHpIXWV$A.f['13']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['46']++;var instance=this,texture=geometry.get('texture'),program=null,options={context:instance.context};__cov_LiEHuJTiil3R0LHpIXWV$A.s['47']++;if(texture!==null){__cov_LiEHuJTiil3R0LHpIXWV$A.b['3'][0]++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['48']++;program=Y.Shader.getTextureProgram(options);}else{__cov_LiEHuJTiil3R0LHpIXWV$A.b['3'][1]++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['49']++;program=Y.Shader.getColorProgram(options);}__cov_LiEHuJTiil3R0LHpIXWV$A.s['50']++;return program;},_loadBufferData:function(geometry,target,array,bufferName){__cov_LiEHuJTiil3R0LHpIXWV$A.f['14']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['51']++;var instance=this,context=instance.context,buffer=context.createBuffer();__cov_LiEHuJTiil3R0LHpIXWV$A.s['52']++;context.bindBuffer(target,buffer);__cov_LiEHuJTiil3R0LHpIXWV$A.s['53']++;context.bufferData(target,array,context.STATIC_DRAW);__cov_LiEHuJTiil3R0LHpIXWV$A.s['54']++;context.bindBuffer(target,null);__cov_LiEHuJTiil3R0LHpIXWV$A.s['55']++;geometry[bufferName]=buffer;},_loadTextureBufferData:function(geometry){__cov_LiEHuJTiil3R0LHpIXWV$A.f['15']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['56']++;var instance=this,context=instance.context,texture=geometry.get('texture');__cov_LiEHuJTiil3R0LHpIXWV$A.s['57']++;if(texture===null){__cov_LiEHuJTiil3R0LHpIXWV$A.b['4'][0]++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['58']++;return;}else{__cov_LiEHuJTiil3R0LHpIXWV$A.b['4'][1]++;}__cov_LiEHuJTiil3R0LHpIXWV$A.s['59']++;instance._loadBufferData(geometry,context.ARRAY_BUFFER,new Float32Array(geometry.get('textureCoordinates')),'textureCoordinatesBuffer');__cov_LiEHuJTiil3R0LHpIXWV$A.s['60']++;texture.set('webglTexture',context.createTexture());},_setClearColor:function(value){__cov_LiEHuJTiil3R0LHpIXWV$A.f['16']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['61']++;if(Lang.isString(value)){__cov_LiEHuJTiil3R0LHpIXWV$A.b['5'][0]++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['62']++;value=Y.Color.normalizedColorArray(value);}else{__cov_LiEHuJTiil3R0LHpIXWV$A.b['5'][1]++;}__cov_LiEHuJTiil3R0LHpIXWV$A.s['63']++;return value;},_setTextureAttribute:function(program,geometry){__cov_LiEHuJTiil3R0LHpIXWV$A.f['17']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['64']++;var instance=this,context=instance.context,texture=geometry.get('texture'),textureCoordinatesBuffer,image,webglTexture;__cov_LiEHuJTiil3R0LHpIXWV$A.s['65']++;if(texture===null){__cov_LiEHuJTiil3R0LHpIXWV$A.b['6'][0]++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['66']++;return;}else{__cov_LiEHuJTiil3R0LHpIXWV$A.b['6'][1]++;}__cov_LiEHuJTiil3R0LHpIXWV$A.s['67']++;textureCoordinatesBuffer=geometry.textureCoordinatesBuffer;__cov_LiEHuJTiil3R0LHpIXWV$A.s['68']++;image=texture.get('image');__cov_LiEHuJTiil3R0LHpIXWV$A.s['69']++;webglTexture=texture.get('webglTexture');__cov_LiEHuJTiil3R0LHpIXWV$A.s['70']++;context.bindTexture(context.TEXTURE_2D,webglTexture);__cov_LiEHuJTiil3R0LHpIXWV$A.s['71']++;context.pixelStorei(context.UNPACK_FLIP_Y_WEBGL,true);__cov_LiEHuJTiil3R0LHpIXWV$A.s['72']++;context.texImage2D(context.TEXTURE_2D,0,context.RGBA,context.RGBA,context.UNSIGNED_BYTE,image);__cov_LiEHuJTiil3R0LHpIXWV$A.s['73']++;context.texParameteri(context.TEXTURE_2D,context.TEXTURE_MAG_FILTER,context.NEAREST);__cov_LiEHuJTiil3R0LHpIXWV$A.s['74']++;context.texParameteri(context.TEXTURE_2D,context.TEXTURE_MIN_FILTER,context.NEAREST);__cov_LiEHuJTiil3R0LHpIXWV$A.s['75']++;instance._setVertexAttribute(textureCoordinatesBuffer,program.textureCoordinatesAttribute,2);__cov_LiEHuJTiil3R0LHpIXWV$A.s['76']++;context.activeTexture(context.TEXTURE0);__cov_LiEHuJTiil3R0LHpIXWV$A.s['77']++;context.uniform1i(program.sampler,0);},_setUniforms:function(program,geometry,projectionMatrix){__cov_LiEHuJTiil3R0LHpIXWV$A.f['18']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['78']++;var instance=this,context=instance.context,cameraMatrix=instance.get('camera').getInvertedMatrix(),geometryMatrix=geometry.get('matrix');__cov_LiEHuJTiil3R0LHpIXWV$A.s['79']++;Y.WebGLMatrix.mat4.multiply(cameraMatrix,geometryMatrix);__cov_LiEHuJTiil3R0LHpIXWV$A.s['80']++;context.uniformMatrix4fv(program.projectionMatrixUniform,false,projectionMatrix);__cov_LiEHuJTiil3R0LHpIXWV$A.s['81']++;context.uniformMatrix4fv(program.modelViewMatrixUniform,false,cameraMatrix);},_setVertexAttribute:function(buffer,programAttribute,size){__cov_LiEHuJTiil3R0LHpIXWV$A.f['19']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['82']++;var instance=this,context=instance.context;__cov_LiEHuJTiil3R0LHpIXWV$A.s['83']++;context.bindBuffer(context.ARRAY_BUFFER,buffer);__cov_LiEHuJTiil3R0LHpIXWV$A.s['84']++;context.vertexAttribPointer(programAttribute,size,context.FLOAT,false,0,0);__cov_LiEHuJTiil3R0LHpIXWV$A.s['85']++;context.bindBuffer(context.ARRAY_BUFFER,null);},_unbindBuffers:function(){__cov_LiEHuJTiil3R0LHpIXWV$A.f['20']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['86']++;var instance=this,context=instance.context;__cov_LiEHuJTiil3R0LHpIXWV$A.s['87']++;context.bindBuffer(context.ARRAY_BUFFER,null);__cov_LiEHuJTiil3R0LHpIXWV$A.s['88']++;context.bindBuffer(context.ELEMENT_ARRAY_BUFFER,null);__cov_LiEHuJTiil3R0LHpIXWV$A.s['89']++;context.bindTexture(context.TEXTURE_2D,null);}},{ATTRS:{background:{value:'black',setter:'_setClearColor'},camera:{value:new Y.Camera()},geometries:{value:{}},height:{valueFn:function(){__cov_LiEHuJTiil3R0LHpIXWV$A.f['21']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['90']++;var instance=this,srcNode=instance.get('srcNode');__cov_LiEHuJTiil3R0LHpIXWV$A.s['91']++;return srcNode.get('height');},setter:function(val){__cov_LiEHuJTiil3R0LHpIXWV$A.f['22']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['92']++;var instance=this,srcNode=instance.get('srcNode');__cov_LiEHuJTiil3R0LHpIXWV$A.s['93']++;srcNode.set('height',val);__cov_LiEHuJTiil3R0LHpIXWV$A.s['94']++;return val;}},srcNode:{value:Y.Node.one('#y3d'),setter:Y.Node.one,writeOnce:true},width:{valueFn:function(){__cov_LiEHuJTiil3R0LHpIXWV$A.f['23']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['95']++;var instance=this,srcNode=instance.get('srcNode');__cov_LiEHuJTiil3R0LHpIXWV$A.s['96']++;return srcNode.get('width');},setter:function(val){__cov_LiEHuJTiil3R0LHpIXWV$A.f['24']++;__cov_LiEHuJTiil3R0LHpIXWV$A.s['97']++;var instance=this,srcNode=instance.get('srcNode');__cov_LiEHuJTiil3R0LHpIXWV$A.s['98']++;srcNode.set('width',val);__cov_LiEHuJTiil3R0LHpIXWV$A.s['99']++;return val;}}}});},'gallery-2013.08.22-21-03',{'requires':['base-build','base-pluginhost','node-base','y3d-camera','y3d-color','y3d-matrix','y3d-shader']});
