YUI.add("gallery-zui-scrollsnapper",function(e,t){var n=function(){n.superclass.constructor.apply(this,arguments)};n.NAME="pluginScrollSnapper",n.NS="pages",n.ATTRS={snapDuration:{value:500,validator:e.Lang.isNumber},axis:{value:[]},selector:{value:null},index:{value:0,lazyAdd:!1,setter:function(e){var t=this.get("total"),n=Math.max(Math.floor(e),0);return t&&n>=t&&(n=t-1),this._pages&&this.scrollTo(n,this.get("snapDuration"),"ease-out"),n}},total:{value:0}},e.namespace("zui").ScrollSnapper=e.extend(n,e.Plugin.Base,{initializer:function(){this._host=this.get("host"),this._vertical=this._host._cAxis.y,this._snapAttr=this._vertical?"offsetTop":"offsetLeft",this._snapRange=this._vertical?"offsetHeight":"offsetWidth",this._snapSource=this._vertical?"scrollY":"scrollX",this.afterHostMethod("_uiDimensionsChange",this._updateSnap),this.afterHostEvent("render",this._updatePages),this.afterHostEvent("scrollEnd",this._scrollEnded),this._updatePages()},_updateSnap:function(){this.scrollTo(this.get("index"))},_updatePages:function(){var e=this._host.get("contentBox"),t=this.get("selector");this._pages=t?e.all(t):e.get("children"),this.set("total",this._pages.size())},_scrollEnded:function(){var t=this._host._flicking;e.later(t?this.get("snapDuration"):1,this,function(){t&&(this._host._currentVelocity=0);if(this._host.get(this._snapSource)===this._lastSnap)return;this.snapTo(this.snapIndex())})},snapTo:function(e){return this.set("index",e)},scrollTo:function(e,t,n){var r=Math.max(Math.floor(e),0),i=Math.max(t,0),s=this._pages.item(r),o=s?s.get(this._snapAttr):0,u=this._host.get(this._snapSource);if(u===o)return;return this._lastSnap=o,this._vertical?this._host.scrollTo(null,o,i,n):this._host.scrollTo(o,null,i,n),this},next:function(){var e=this.get("index");return e<this.get("total")-1&&this.set("index",e+1),this},prev:function(){var e=this.get("index");return e>0&&this.set("index",e-1),this},snapIndex:function(){var e=this._snapAttr,t=this._snapRange,n=this._host.get(this._snapSource),r,i,s=this._pages,o=s.size();for(r=0;r<o;r++){i=s.item(r);if(n<i.get(e)+i.get(t)/2)return r}return null}})},"gallery-2013.02.07-15-27",{requires:["scrollview-base","plugin"]});
