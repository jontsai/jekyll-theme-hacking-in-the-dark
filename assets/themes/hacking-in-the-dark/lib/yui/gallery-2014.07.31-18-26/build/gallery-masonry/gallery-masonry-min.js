YUI.add("gallery-masonry",function(b){function a(){a.superclass.constructor.apply(this,arguments);}a.NAME="masonry";a.ATTRS={node:{setter:function(c){var d=b.one(c);if(!d){b.fail("Masonry: Invalid Node Given: "+c);}return d;}},isResizable:{value:true},isAnimated:{value:false},animationOptions:{value:{duration:0.5}},gutterWidth:{value:0},isRTL:{value:false},isFitWidth:{value:false},containerStyle:{value:{position:"relative"}},columnWidth:{},itemSelector:{}};b.extend(a,b.Base,{initializer:function(){this._create();this._init();},destructor:function(){this.bricks.removeClass("masonry-brick").setStyles({position:"",top:"",left:""});this.get("node").detach("masonry|*").removeClass("masonry").setStyles(this.originalStyle);b.detach("masonry|*");},_outerWidth:function(c){return c?c.get("offsetWidth")+parseInt(c.getStyle("marginLeft"),10)+parseInt(c.getStyle("marginRight"),10):0;},_outerHeight:function(c){return c?c.get("offsetHeight")+parseInt(c.getStyle("marginTop"),10)+parseInt(c.getStyle("marginBottom"),10):0;},_filterFindBricks:function(e){var d=this.get("itemSelector"),c=e;if(d){c=new b.NodeList();e.each(function(f){c=c.concat(f,f.all(d));});c=c.filter(d);}return c;},_getBricks:function(c){var d=this._filterFindBricks(c).setStyle("position","absolute").addClass("masonry-brick");return d;},_create:function(){this.styleQueue=[];var e=this.get("node"),d=e.getDOMNode().style,g=this.get("containerStyle"),h,f=this.get("columnWidth"),c=this;this.originalStyle={height:d.height||""};for(h in g){if(g.hasOwnProperty(h)){this.originalStyle[h]=d[h]||"";}}e.setStyles(g);this.horizontalDirection=this.get("isRTL")?"Right":"Left";this.offset={x:parseInt(e.getStyle("padding"+this.horizontalDirection),10),y:parseInt(e.getStyle("paddingTop"),10)};this.horizontalDirection=this.horizontalDirection.toLowerCase();this.isFluid=f&&typeof f==="function";setTimeout(function(){c.get("node").addClass("masonry");},0);if(this.get("isResizable")){b.on("masonry|windowresize",function(){c.resize();});}this.reloadItems();},_init:function(c){this._getColumns();this._reLayout(c);},layout:function(e,m){var k,l,c={},h,f,g=this.get("animationOptions"),j,d;e.each(function(i){this._placeBrick(i);},this);c.height=Math.max.apply(Math,this.colYs)+"px";if(this.get("isFitWidth")){h=0;k=this.cols;while(--k){if(this.colYs[k]!==0){break;}h++;}c.width=(this.cols-h)*this.columnWidth-this.get("gutterWidth")+"px";}this.styleQueue.push({el:this.get("node"),style:c});f=!this.isLaidOut?"setStyles":(this.get("isAnimated")?"transition":"setStyles");for(k=0,l=this.styleQueue.length;k<l;k++){j=this.styleQueue[k];d=j.style;if("transition"===f){if(d.top){d.top+="px";}if(d[this.horizontalDirection]){d[this.horizontalDirection]+="px";}d=b.merge(d,g);}j.el[f](d);}this.styleQueue=[];if(m){m.call(e);}this.isLaidOut=true;},_getColumns:function(){var e=this.get("node"),c=this.get("isFitWidth")?e.get("parentNode"):e,g=parseInt(c.getStyle("width"),10)||0,f=this.get("columnWidth"),d=this.get("gutterWidth");this.columnWidth=this.isFluid?f(g):f||this._outerWidth(this.bricks.item(0))||g;this.columnWidth+=d;this.cols=Math.floor((g+d)/this.columnWidth);this.cols=Math.max(this.cols,1);},_placeBrick:function(k){var m,q,e,o,f,c,p,g,l,h,n,d;m=Math.ceil(this._outerWidth(k)/this.columnWidth);m=Math.min(m,this.cols);if(m===1){e=this.colYs;}else{q=this.cols+1-m;e=[];for(f=0;f<q;f++){o=this.colYs.slice(f,f+m);e[f]=Math.max.apply(Math,o);}}c=Math.min.apply(Math,e);p=0;for(g=0,l=e.length;g<l;g++){if(e[g]===c){p=g;break;}}h={top:c+this.offset.y};h[this.horizontalDirection]=this.columnWidth*p+this.offset.x;this.styleQueue.push({el:k,style:h});n=c+this._outerHeight(k);d=this.cols+1-l;for(g=0;g<d;g++){this.colYs[p+g]=n;}},resize:function(){var c=this.cols;this._getColumns();if(this.isFluid||this.cols!==c){this._reLayout();}},_reLayout:function(d){var c=this.cols;this.colYs=[];while(c--){this.colYs.push(0);}this.layout(this.bricks,d);},reloadItems:function(){this.bricks=this._getBricks(this.get("node").get("children"));return this;},reload:function(c){this.reloadItems();this._init(c);return this;},appended:function(d,e,f){if(e){this._filterFindBricks(d).setStyles({top:this.get("node").get("region").height});var c=this;setTimeout(function(){c._appended(d,f);},1);}else{this._appended(d,f);}return this;},_appended:function(c,e){var d=this._getBricks(c);this.bricks=this.bricks.concat(d);this.layout(d,e);},remove:function(d){var c=this;d.each(function(){c.bricks.splice(c.bricks.indexOf(this),1);this.remove(true);});return this;}});b.Masonry=a;},"gallery-2012.08.01-13-16",{requires:["base","node","event","transition"]});