YUI.add("gallery-dd-plugin-momentum",function(e,t){function n(e){n.superclass.constructor.apply(this,arguments)}n.NAME="DDMomentumPlugin",n.NS="as",n.ATTRS={},e.extend(n,e.Plugin.Base,{initializer:function(e){window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)}}()),this.publish("end"),this._maxVelocity=e.maxVelocity||3,this._minVelocity=typeof e.minVelocity!="undefined"?e.minVelocity:.2,this._drag=typeof e.drag!="undefined"?e.drag:.92,this._deltas=[],this._deltasToCount=e.deltasToCount||5,this._node=e.host.get("dragNode"),this._totalDeltaX=0,this._totalDeltaY=0,this._dragStartXY=[],this._totalDragOffset=[0,0],this._duration=0,this._velocity=0,this._delegate=e.host.name==="delegate",this._listenDrag=null,this._listenDragEnd=null,this._listenDragStart=null,this._attachListeners()},destructor:function(){this._detachListeners()},_attachListeners:function(){this._listenDragStart=this.afterHostEvent("drag:start",this._handleDragStart,this),this._listenDrag=this.afterHostEvent("drag:drag",this._handleDrag,this),this._listenDragEnd=this.afterHostEvent("drag:end",this._handleDragEnd,this)},_detachListeners:function(){e.detach(this._listenDragStart),e.detach(this._listenDrag),e.detach(this._listenDragEnd)},_handleDragStart:function(e){this._velocityXY=[0,0],this._deltas=[],this._totalDragOffset=[0,0],this._totalDeltaX=0,this._totalDeltaY=0,this._dragStartXY=[e.pageX,e.pageY],this._delegate&&(this._node=this.get("host").get("currentNode"))},_handleDrag:function(e){e.timeStamp=(new Date).getTime(),this._deltas.length<this._deltasToCount?this._deltas.push(e):(this._deltas.shift(),this._deltas.push(e))},_handleDragEnd:function(e){var t=[];this._totalDragOffset=[e.pageX-this._dragStartXY[0],e.pageY-this._dragStartXY[1]];if(this._deltas.length!==this._deltasToCount)return;if((new Date).getTime()-this._deltas[this._deltasToCount-1].timeStamp>100){this.fire("end",{deltaX:this._totalDragOffset[0],deltaY:this._totalDragOffset[1]});return}this._figureDeltaDuration(),this._figureVelocity(),this._runFrame({velocityXY:this._velocityXY,scope:this,timeStamp:new Date})},_figureDeltaDuration:function(){this._duration=this._deltas[this._deltasToCount-1].timeStamp-this._deltas[0].timeStamp},_figureVelocity:function(){var e=0,t=0,n;for(n=0;n<this._deltasToCount;n++)e+=this._deltas[n].info.delta[0],t+=this._deltas[n].info.delta[1];e=this._clampVelocity(e/this._duration),t=this._clampVelocity(t/this._duration),this._velocityXY=[e,t]},_applyDrag:function(e,t){var n=[Math.abs(e[0]*t),Math.abs(e[1]*t)];return e[0]<0&&(n[0]*=-1),e[1]<0&&(n[1]*=-1),n},_clampVelocity:function(e){var t;return t=Math.abs(e),t=Math.max(Math.min(t,this._maxVelocity),this._minVelocity),e<0&&(t*=-1),t},_runFrame:function(e){var t=e.scope,n,r=new Date,i,s;n=r-e.timeStamp,i=e.velocityXY[0]*n,s=e.velocityXY[1]*n,e.timeStamp=r,Math.abs(e.velocityXY[0])>=0&&(t._totalDeltaX+=Math.floor(i),t._node.setStyle("left",Math.floor(parseInt(t._node.getStyle("left"),10)+i)+"px")),Math.abs(e.velocityXY[1])>=0&&(t._totalDeltaY+=Math.floor(s),t._node.setStyle("top",Math.floor(parseInt(t._node.getStyle("top"),10)+s)+"px")),Math.abs(e.velocityXY[0])>=t._minVelocity||Math.abs(e.velocityXY[1])>=t._minVelocity?(e.velocityXY=t._applyDrag(e.velocityXY,t._drag),window.requestAnimationFrame(function(){t._runFrame(e)})):t.fire("end",{deltaX:t._totalDragOffset[0]+t._totalDeltaX,deltaY:t._totalDragOffset[1]+t._totalDeltaY})}}),e.DDMomentumPlugin=n},"gallery-2013.05.15-21-12",{skinnable:"false",requires:["dd","plugin"]});
