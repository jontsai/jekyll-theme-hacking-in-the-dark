YUI.add("gallery-chromahash",function(C){var B='<label for="{id}" class="{color} chroma-hash"></label>',A=function(D){this._animations=[];A.superclass.constructor.apply(this,arguments);this.renderUI();this.bindUI();};A.NAME="ChromaHash";A.NS="ChromaHash";A.ATTRS={bars:{value:3,validator:function(D){if(D<1||D>4){return false;}}},salt:{value:"7be82b35cb0199120eea35a4507c9acf",validator:C.Lang.isString},minimum:{value:6,validator:C.Lang.isNumber},animationDuration:{value:0.5,validator:C.Lang.isNumber,setter:function(D){C.Array.each(this._animations,function(E){E.set("duration",D);});}},host:{validator:function(D){if(!D.test("input[type=password]")){C.fail("ChromaHash can't be attached to this node.");}return false;},setter:function(D){this._lblQry="label[for="+D.get("name")+"].chroma-hash";return D;}}};C.extend(A,C.Plugin.Base,{renderBars:function(){var F=["primary","secondary","tertiary","quaternary"].slice(0,this.get("bars")),K=C.get("body"),J=this.get("host"),G,I,H=J.get("clientWidth"),E=J.get("clientHeight"),D=J.getXY();for(G=0;G<F.length;G+=1){I=C.Node.create(B.replace(/\{id\}/g,J.get("id")).replace(/\{color\}/g,F[G]));I.setStyles({position:"absolute",height:E+"px",width:"8px",margin:"5px",marginLeft:"0px",backgroundColor:J.getStyle("backgroundColor")});K.insert(I);I.setXY([D[0]+H-2+(-8*(G+1)),D[1]+3]);this._animations.push(new C.Anim({node:I,duration:this.get("animationDuration")}));}},renderUI:function(){if(!this._rendered){this.renderBars();this._rendered=true;}},bindUI:function(){this._keyHandler=this.get("host").after("keyup",this._handleKey,this);},hide:function(){C.all(this._lblQry).setStyle("display","none");},clear:function(){this.hide();C.all(this._lblQry).remove();this._rendered=false;},destroy:function(){this._keyHandler.detach();this._clear();},_handleKey:function(J){var K=this.get("host"),I=K.get("value"),F,E=[],D=this.get("bars"),H,G;if(I===""){for(F=0;F<D;F+=1){E.push("fff");}}else{H=C.Crypto.MD5(""+I+":"+this.get("salt"));E=H.match(/([\dABCDEF]{6})/ig);if(I.length<this.get("minimum")){for(F=0;F<D;F+=1){G=(parseInt(E[F],16)%15).toString(16);E[F]=G+G+G;}}}C.Array.each(this._animations,function(L,M){L.stop();L.set("from",{backgroundColor:K.getStyle("backgroundColor")});L.set("to",{backgroundColor:"#"+E[M]});L.run();});}});C.ChromaHash=A;},"gallery-2009.12.08-22",{requires:["plugin","node","stylesheet","collection","anim-color","gallery-crypto-md5"]});